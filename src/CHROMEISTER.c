/*********

File        CHROMEISTER.c
Author      EPW <estebanpw@uma.es>
Description Computes hits and generates a dotplot

USAGE       Usage is described by calling ./CHROMEISTER --help



**********/


#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include <ctype.h>
#include <pthread.h>
#include "structs.h"
#include "alignmentFunctions.h"
#include "commonFunctions.h"

#define MAX(x, y) (((x) > (y)) ? (x) : (y))
#define MIN(x, y) (((x) <= (y)) ? (x) : (y))
#define STARTING_SEQS 1000
#define PIECE_OF_DB_REALLOC 3200000 //half a gigabyte if divided by 8 bytes
#define RANGE 2


uint64_t custom_kmer = NHASH; // Defined as externals in structs.h
uint64_t hash_functions[6400] = {32762426, 59297031, 73285030, 98783790, 45267784,
85898841, 104737424, 25253119, 122649748, 146353124,
115307078, 87354696, 67776396, 14577577, 43104507,
70532234, 136609392, 84922572, 24230939, 135464375,
11298259, 31237351, 138162267, 20947036, 45892813,
36296018, 140018640, 34725876, 106167430, 93604162,
106307697, 128693642, 73920445, 125946271, 31097290,
83924812, 72910444, 103511992, 12179751, 91342569,
16202231, 18387931, 109832547, 76239936, 127123275,
17919652, 56681702, 65118266, 58785787, 58146779,
65101880, 36555119, 24506066, 24918607, 134597434,
21864299, 72198490, 30716726, 128876740, 87745442,
76863266, 16347041, 19469224, 31701655, 8019780,
107162450, 97558440, 32363476, 51334570, 142205677,
59233073, 123298237, 4847739, 60724922, 27102251,
95283627, 145487723, 28719830, 69318193, 54292033,
28451739, 124151151, 47558203, 119498649, 42202988,
66815226, 101005210, 132634225, 74883913, 108039940,
49664563, 132107577, 145249583, 73479342, 109829487,
27002439, 147557347, 41453836, 67974832, 30293886,
19105014, 147981711, 100579244, 102374196, 92132314,
30583389, 758191, 24667192, 84893934, 103395286,
91361287, 86498261, 118267685, 130672069, 142974907,
115672002, 84435033, 139668536, 16645275, 114940417,
113333159, 77959726, 67643813, 23167171, 73603643,
137479979, 6463078, 121114773, 37864723, 62580531,
7434160, 103856525, 42564150, 23753275, 132630827,
97597830, 109912505, 128843514, 36926393, 135854253,
19958414, 68420409, 13676642, 36243189, 65587114,
28434834, 62473882, 88685236, 1479072, 5822648,
107903631, 80808748, 16304474, 117956378, 129752178,
47830758, 33835333, 104649044, 91162481, 127478511,
20866109, 40872109, 7127107, 12699247, 61483743,
45837536, 33767334, 43811951, 48416275, 29252654,
95141114, 41443675, 131385318, 98014642, 128029104,
31083229, 69815195, 72426997, 26070836, 124336546,
95365308, 34812670, 96784708, 101239941, 60234282,
16045471, 140173296, 25931204, 144596229, 37300444,
58534440, 82003388, 139103045, 134458811, 80317567,
17562666, 36480695, 34389103, 112759793, 88114018,
146279735, 122734968, 57568833, 123341293, 2614031,
58285774, 140568730, 132010090, 12732500, 140948514,
103508403, 346025, 58268961, 4792894, 65009735,
34009951, 21156028, 41660554, 139479480, 50354790,
128938184, 102788266, 113220509, 40870625, 103367645,
134121192, 1648417, 67061497, 34739673, 137157461,
84785044, 97844003, 75390636, 15330278, 74537026,
140856974, 100439316, 63766139, 132188079, 99602951,
133213993, 133901237, 34304582, 92313553, 121109634,
65012203, 1980130, 66740409, 86866424, 40954366,
112925578, 43282556, 91639872, 142204167, 77559223,
21233404, 146134159, 49722549, 33475562, 10477180,
26960623, 48347212, 89948183, 48685201, 6685806,
28952250, 119735474, 112761179, 92321190, 16601147,
75084081, 11619159, 126437420, 143887429, 121580604,
62974064, 92667246, 41435198, 138373423, 84277777,
99924308, 17299885, 26265804, 141996558, 46804331,
7227002, 133130184, 97970871, 117795901, 120793674,
111776009, 14981006, 90396566, 34065819, 118142993,
4131753, 70864154, 22895625, 34197312, 65006028,
138479401, 137173581, 42697279, 9038380, 67799590,
10052637, 142079742, 63719040, 27674320, 149045739,
23004954, 107884071, 34397561, 19975925, 134399612,
99280823, 100244381, 94443186, 108483555, 12013846,
87672402, 141706173, 82823523, 100425976, 72442800,
78714460, 131045343, 25318125, 83512116, 4648989,
33791712, 102403682, 31718754, 53143075, 112889231,
23128839, 82665636, 112972896, 3109380, 36970685,
60938992, 107087739, 119967919, 145749435, 44404007,
80553792, 140906305, 62985703, 76291568, 117314185,
148874825, 86731878, 124065374, 72463192, 92804136,
49245495, 72988972, 114639823, 68645813, 132956833,
75944989, 83590847, 86667637, 92121431, 31057705,
25462227, 10368580, 58643755, 5001176, 113379670,
40840457, 113357632, 52783926, 99816163, 95672310,
102083387, 18398319, 105754831, 128131361, 3616799,
100457645, 95199812, 29875801, 78396663, 138639129,
37091327, 138286097, 53997015, 107239297, 38484620,
66469778, 72245922, 64495441, 101410899, 121149024,
61062720, 222691, 108752063, 68033244, 124684700,
40831172, 104792653, 30188970, 37419874, 126552817,
10068841, 67847953, 148990819, 96627930, 53261864,
142825929, 116848766, 136191188, 98457392, 92759029,
93593964, 46467600, 110694388, 112394033, 89928208,
120463731, 40914693, 69861667, 34866955, 88380929,
30274125, 34612403, 44206036, 89207158, 71091022,
91080160, 11465713, 89370397, 68392103, 73112835,
100894301, 100242557, 73870486, 124402216, 60722346,
30481942, 136617392, 13775683, 47501904, 59802174,
132743141, 33132739, 122816957, 71040781, 60390566,
47830443, 148504105, 17588031, 104540758, 52254687,
30326210, 71847600, 15232777, 120907527, 56866650,
92920696, 58728036, 17714629, 29418315, 76902470,
41064370, 103916707, 64433936, 92105662, 123387734,
138299367, 98492868, 69678780, 131694701, 538401,
121442357, 68625665, 129475635, 22128388, 10750776,
39286638, 57968747, 28567858, 99461706, 3223122,
55761551, 144630832, 80883746, 98949721, 85050350,
42121225, 73024128, 66308638, 88364881, 30478985,
51236787, 115077071, 48565831, 149604629, 106117926,
97993363, 52191504, 10151838, 18270744, 24731938,
72759263, 101476474, 16796799, 4843630, 21920107,
42231536, 58610658, 61547463, 13292713, 20711981,
145572337, 125548986, 88201866, 122582418, 78639447,
38639712, 46512055, 81859233, 56159116, 84735039,
62526407, 110954969, 141203660, 48730410, 100826797,
106682115, 90746861, 125020635, 29829974, 103877051,
108799285, 77163359, 60625127, 109590933, 47389792,
111138602, 28111532, 62137454, 81910639, 118431967,
5578607, 35322316, 132166011, 136524961, 125469370,
13068274, 108982005, 139305402, 69394044, 41294224,
138699629, 81580123, 149396439, 136794002, 141331566,
26277748, 62050162, 52270942, 17431066, 132979869,
129449147, 74879239, 108657786, 28246298, 133259256,
119228293, 58293178, 37535109, 14809368, 64637704,
112534168, 93885870, 94251871, 56469458, 98845104,
21299717, 126669060, 132916510, 21145990, 89928593,
109425617, 103799727, 74222063, 33264906, 45867354,
46589283, 77352900, 34401634, 93141749, 74046104,
27094491, 108492683, 15549946, 94121024, 61363694,
76624164, 18410008, 58542634, 59473747, 123644021,
18051290, 95455608, 79047368, 716139, 72938413,
121298563, 118872906, 134038237, 100229752, 125886671,
133336091, 5001487, 17379118, 113591686, 103346581,
62905321, 13122220, 126972204, 23819480, 60870928,
141038963, 4027500, 89469622, 68280842, 95792950,
8533804, 143846600, 140149926, 139930950, 73722337,
79935318, 1855681, 80185690, 147426832, 57063254,
72254191, 111810270, 147839094, 68140171, 79429838,
43889699, 131823090, 73734547, 74602550, 95113123,
3959171, 59397865, 131825773, 22319709, 17095097,
98413015, 70741312, 19310060, 20427432, 56127012,
79891856, 121210708, 11559645, 86017688, 140368280,
14840332, 55014765, 90653133, 17207528, 137161496,
99282851, 69622828, 38746723, 139519403, 106465845,
131655742, 106024048, 97171466, 3604501, 61187036,
30833676, 139291719, 131643603, 51465924, 137367827,
149618855, 78001606, 92693774, 141171654, 65891333,
36836545, 104790952, 2085652, 96437843, 46379886,
110604504, 143952336, 114508101, 48097195, 44232606,
143320703, 121910183, 12757034, 13511717, 128064763,
15233049, 46057863, 143131770, 70049015, 113845862,
50702518, 102170063, 145091252, 25356573, 52223605,
12110175, 32864935, 6358350, 76507942, 141189403,
54448227, 88857569, 8445840, 20028456, 55243451,
112181576, 27719211, 145260483, 103691140, 79446287,
140740602, 125302783, 2212467, 19572191, 17537572,
57952654, 143490863, 33344193, 45938286, 66896037,
133410650, 31711139, 40948779, 60127406, 71812838,
50312189, 120189584, 65076525, 81250960, 38516301,
121889363, 50470813, 83629427, 34890633, 53049525,
74303664, 140484327, 15517531, 145860615, 961858,
112306533, 109524831, 73802417, 113019970, 34921319,
70293326, 23631063, 128854760, 100553679, 136398727,
5282135, 104562955, 81312146, 139740790, 108984368,
45671811, 113855621, 124981001, 51542584, 84278,
126907211, 37124983, 51644313, 42068434, 83395796,
6579519, 66753502, 126443833, 58204864, 29440665,
100594044, 109396206, 34770082, 6799261, 132112438,
81865136, 19342771, 11488643, 34942224, 136780448,
78804178, 77195194, 5608946, 113790840, 135262977,
120504233, 139252243, 12116921, 113868676, 77799365,
56451924, 122303477, 130759949, 113639496, 120304853,
105197866, 81619625, 39938305, 46377439, 89351622,
143273486, 46939321, 46803198, 139969651, 95348912,
54692344, 6325775, 101738812, 13023357, 39493120,
116298476, 60480243, 116314113, 44832489, 117507621,
123944979, 140448614, 41257893, 63708183, 77058137,
77018490, 52582011, 35001086, 144592400, 61012470,
11917555, 11314959, 129192000, 27990204, 30973588,
117852017, 100985646, 129017831, 122249761, 3328202,
86798458, 105715618, 92837954, 4813440, 140641113,
138313722, 117095153, 132335722, 22085191, 137993654,
83945205, 51863672, 130617188, 10686536, 28001646,
134646402, 26890239, 105381032, 41255121, 13475841,
130308574, 144703011, 18454265, 127017568, 12538983,
44955308, 133877544, 33598814, 47805431, 65536345,
81830945, 35163268, 57189441, 34886365, 21056623,
48021708, 36908189, 44006246, 72900407, 4476897,
36325245, 139826617, 33072796, 108307108, 8080399,
102389932, 55903951, 66489674, 142472798, 106803543,
131786887, 11072938, 40842735, 37709749, 101443623,
86804057, 75512892, 74574625, 113380553, 58125336,
28450202, 118958999, 31748443, 71072976, 706223,
120476768, 65932820, 53111351, 12427779, 40372311,
90951443, 12560748, 22959218, 42915716, 12190447,
93536035, 23236183, 144516864, 95384065, 91677314,
101002266, 89723995, 47203177, 122897927, 67368291,
136125480, 105759001, 135746296, 99984346, 79464023,
125288952, 108529707, 142854478, 107933515, 85489218,
89570763, 98314417, 119055486, 39748726, 67282248,
15041566, 76207602, 48175397, 55400645, 81898897,
51009483, 149986461, 83493423, 139856633, 97149992,
30178483, 94746941, 92008354, 94879233, 83400243,
122340654, 106375895, 88011244, 126956632, 50975048,
33845279, 115599970, 12299463, 37199413, 4776943,
20839179, 149918455, 61055550, 38107504, 122978171,
5294241, 89152928, 35126747, 45114331, 136469056,
105500530, 106929325, 20462868, 34091189, 63554136,
84251049, 51041308, 119349709, 38740474, 113926497,
123577655, 145629764, 97271086, 12540148, 66322476,
118718816, 139017485, 125803687, 74742372, 55966246,
14971921, 46230487, 136926025, 7398446, 72358927,
134516558, 141879129, 146221338, 81137571, 44982331,
99221681, 77036961, 19694814, 41230079, 3265830,
62582914, 97334566, 128396107, 52503299, 142594371,
11417597, 117327474, 45099945, 89388165, 92284121,
94934282, 144310034, 3616939, 32373511, 100923785,
79998477, 120874237, 73250180, 38073655, 138982229,
29017466, 94655397, 143982001, 31349683, 128460644,
58559132, 72814513, 64191657, 92996079, 80027580,
26494580, 52201081, 78467799, 122235702, 43763393,
76256944, 66200146, 32127348, 1601477, 70822097,
20536485, 140582580, 71362758, 31589541, 53641860,
83184750, 82787692, 139730339, 138253444, 56612096,
130471197, 111670756, 19939298, 117356956, 7282744,
32285468, 61495069, 17874551, 123638445, 118302040,
132581630, 19613505, 55384164, 112341459, 89293468,
79510793, 144389541, 96679166, 33579665, 11007455,
132528638, 100930855, 94420153, 68536764, 149756940,
55579744, 134404435, 125716363, 5807840, 147510426,
102384682, 89145666, 82993715, 65919805, 118944595,
39943610, 69463620, 86050924, 43197065, 2628525,
50456881, 17547061, 44635147, 126661935, 47397692,
50374578, 99909925, 92085013, 84232471, 20545945,
7663478, 36253717, 33869934, 62452592, 54286553,
96796349, 5489562, 115596154, 118813558, 59900727,
21416052, 46483651, 102656415, 22044024, 83594933,
73465847, 46206524, 64136775, 82127950, 130503575,
126703973, 14023290, 3422105, 2071010, 34206913,
67310707, 149013456, 121754312, 19678290, 52724478,
87268653, 94144464, 62325037, 28982181, 32998477,
58808098, 95234028, 19370285, 56565346, 137469913,
109890320, 10611297, 125460593, 109775205, 86998268,
72402124, 135779563, 136546980, 92424985, 88624506,
136255221, 101586617, 55386768, 116800621, 47977935,
111278191, 107349073, 123881769, 135519585, 135028983,
48908399, 127450337, 115446091, 104351145, 16448787,
141335202, 16491586, 146090058, 141471899, 47085274,
59616570, 128661808, 119439547, 75934482, 75016678,
28178610, 22625191, 47829859, 104803789, 68988044,
87816365, 58369391, 93918274, 31261228, 6298259,
124104501, 932610, 53429336, 122811779, 141080071,
95080999, 88169219, 8083381, 87933031, 131865033,
135423140, 143332784, 72200837, 51392369, 29341808,
126828772, 106715587, 27792, 39175179, 138716872,
101161615, 107831786, 66802006, 47638844, 76782535,
115401434, 94499506, 117719217, 18997873, 23753406,
52603228, 129799622, 15911751, 46564916, 48413483,
123299903, 1753867, 119014032, 41042734, 15780807,
77745130, 33066268, 51939907, 134791836, 122648731,
111662100, 122158755, 124143815, 94048723, 137394168,
54292876, 31948720, 23038018, 26193807, 777977,
28399930, 105780234, 98092149, 136691849, 142172761,
127900719, 76778792, 31901254, 56034037, 84666640,
5791174, 109804735, 61431218, 105697900, 124204832,
126580397, 13634803, 95661981, 89075171, 133631835,
6851363, 3160497, 23237228, 37996024, 55905505,
94653863, 143253446, 19913067, 50901604, 46333596,
91977916, 39775663, 132002349, 82587669, 97861429,
115759619, 8984337, 71925452, 69954813, 107093616,
70827480, 55968472, 131712152, 35767520, 10258580,
123210969, 89624502, 6046115, 15085471, 112418517,
27531077, 121740643, 77946272, 44634547, 131127075,
70647734, 32360306, 59217336, 123666615, 123292453,
103818718, 138128144, 17456613, 77704220, 98412429,
27261088, 134371716, 57432015, 47854446, 58781206,
103003637, 123218967, 30363526, 42452648, 29960396,
137898112, 105136560, 5368193, 73135696, 147825861,
147476417, 78509105, 93524087, 139940830, 67665457,
9393820, 4573415, 141902893, 32811476, 57998045,
38530565, 72333575, 25239878, 37515078, 32302950,
13896875, 89680042, 83599444, 19281592, 27469428,
28587801, 60962306, 145499403, 126542235, 133227561,
3820876, 57604716, 101342351, 35545038, 146209727,
88334872, 123929586, 69528479, 52451587, 113634913,
119503455, 126885916, 120757466, 136869717, 95896221,
103392741, 69047425, 42379836, 39698085, 9477236,
18965945, 1149280, 99047738, 24439685, 27806876,
53223323, 74046594, 53905283, 123975119, 123413614,
15626591, 146534500, 35982293, 114998508, 136540064,
37661516, 70209093, 60069528, 119108567, 73515265,
71686669, 34795879, 51024243, 142286886, 93662151,
10339815, 51061094, 73711391, 70006217, 117070956,
30188573, 20912598, 60214154, 108244427, 146546315,
72554349, 15283358, 1090011, 98871907, 34639013,
102049289, 38499509, 91036761, 10712468, 124684673,
146795593, 12396794, 130656970, 149122830, 26286153,
132160036, 10487315, 69555018, 35473008, 24656806,
119041235, 35042422, 132559677, 122642012, 61785969,
10778507, 27849791, 83313526, 60940223, 14548301,
123350810, 94149028, 23071657, 67065293, 145322056,
51382153, 61078236, 60841510, 33364141, 103280253,
134736845, 141471013, 56109625, 30116385, 1506141,
75342100, 23370375, 16142188, 97808083, 126634409,
95898555, 140701811, 32458171, 23089397, 125564022,
20864010, 119767650, 92716660, 82211725, 21379102,
113419014, 104208680, 27827740, 135864775, 109604346,
64349247, 147709833, 32656147, 122257952, 139581767,
67848357, 79578900, 118313288, 115789244, 148266456,
129624336, 132587154, 54004765, 18467543, 84789783,
112529485, 141471383, 52492388, 93421347, 125822759,
51892546, 1415937, 135776285, 663648, 143173150,
64184171, 41948644, 145200701, 118132191, 77636630,
148765335, 76365291, 109936172, 121441403, 21116582,
66599198, 131904749, 23867554, 4229675, 69782543,
122053806, 139155581, 49242812, 36027851, 133948999,
46537877, 34787187, 71089072, 84276329, 60011366,
46129581, 81949623, 95383172, 54077694, 18455056,
74769442, 54065700, 37629411, 42917380, 113991013,
7582162, 92270718, 103491031, 132824974, 120823835,
121018572, 47444909, 43814045, 6980647, 18056973,
56234953, 3649942, 19396890, 119065818, 39126462,
26230554, 61138623, 93111379, 86422528, 26417133,
86798891, 69890660, 78603829, 6785261, 117554071,
989840, 62310182, 93757440, 70110814, 108064426,
103043358, 122159637, 46695676, 75209466, 81542595,
101024885, 5887957, 27026020, 4547118, 22917084,
84098704, 73062, 102407297, 41496417, 58103869,
61063605, 109673408, 53295599, 720799, 129368038,
97468614, 100556343, 26291909, 123307824, 78038177,
123726836, 83423467, 39674535, 74517402, 117839355,
54373024, 128149281, 53186693, 139837569, 66085560,
56671518, 26365947, 147290204, 96664259, 127339445,
71344986, 130407958, 113011054, 139137650, 121056080,
9847036, 140282869, 106280860, 64908984, 37094979,
97980729, 138023261, 43345325, 47365775, 65485510,
66865459, 111333930, 75619508, 60058087, 72815250,
46125041, 32677988, 48013655, 126143827, 41515763,
46736314, 110967648, 105001600, 106207767, 58596423,
89819097, 118040723, 89676243, 129742295, 132118110,
31895177, 69194568, 5093448, 978643, 115185825,
140199117, 71952824, 39461989, 50109100, 13932167,
133482799, 74236993, 21930262, 113070042, 18255250,
19589656, 107626321, 111659751, 38404228, 70609913,
135434528, 88866918, 136701126, 129951392, 34147413,
20726979, 123194853, 81535231, 92274697, 112153884,
136315555, 93975693, 12725812, 113738871, 71754029,
95974852, 59870796, 22301413, 22449130, 47064370,
43258578, 109856649, 99622800, 105547778, 135103481,
70352010, 81229748, 135157474, 114701850, 130288007,
36927061, 134238372, 36004455, 117815719, 97733850,
63505050, 751345, 96951766, 99812640, 50739398,
54550979, 91732257, 97847475, 93228305, 28534010,
91401936, 129620506, 124582090, 21161433, 91279660,
34919697, 19515283, 127037076, 115505825, 67402913,
130016984, 15423024, 68543664, 119008252, 143702136,
54635918, 65243720, 136723982, 19785875, 74523365,
4251596, 63869200, 56362753, 109842082, 128388333,
148544240, 9756576, 139489735, 27488678, 144819586,
131508271, 76183994, 61049834, 142565774, 83438688,
24738225, 58403294, 100243571, 91614628, 82950158,
58227959, 51946607, 75920630, 146397185, 755638,
88421218, 88093894, 107737225, 113381269, 64087482,
110890643, 30738390, 30956414, 140764655, 60528678,
57167352, 140987882, 99775493, 75241943, 103596789,
35763094, 88970291, 139505939, 147307207, 105251802,
148413982, 137763417, 107441299, 142963205, 85937969,
26079748, 14457474, 77614588, 101256480, 101319967,
47164215, 118260735, 48656539, 16203067, 142575341,
50985767, 135682245, 122090464, 20522941, 86595428,
21655720, 5007223, 125042999, 45150418, 77091448,
2406480, 131782240, 17405380, 39485423, 48140185,
109214062, 125210552, 25089232, 120983085, 7312604,
126744653, 63788270, 15385354, 118652197, 136914011,
54814268, 132686731, 140017456, 134886, 63046267,
30829279, 57319724, 99079217, 93413088, 140862275,
130919568, 134554048, 36802025, 92186807, 140681484,
57491268, 816614, 28095201, 20304398, 77312538,
67517826, 67418652, 17830134, 66572009, 107060439,
8482065, 149692780, 9607961, 49036257, 108498422,
133555912, 51364218, 102289365, 23108974, 43682445,
42620855, 27318746, 111114502, 54575212, 145640945,
48345864, 13581811, 99742653, 46406008, 102119751,
137484719, 70142799, 61850696, 129113207, 39671911,
38999886, 24630159, 83233004, 122604175, 68412915,
26548051, 88089286, 80915371, 14094301, 100480146,
143880409, 143043106, 16774175, 18209015, 121794602,
87576501, 74304081, 117443876, 85415825, 140402079,
118892975, 91799184, 28082923, 27747982, 49825849,
105378691, 6935497, 9276470, 149835602, 73000314,
22321860, 135819477, 117253155, 127638961, 55199225,
67251942, 100060221, 126916977, 55898018, 28968326,
69036914, 55182698, 22350297, 133686103, 60899207,
69652831, 105444104, 40875475, 7976582, 51726310,
55970957, 82005119, 76291968, 125283644, 91145235,
31480967, 21993409, 87970063, 4997190, 79054025,
83410963, 142718544, 69545949, 119372962, 22994155,
29722463, 122224787, 9105222, 44379383, 74233921,
71670290, 64738249, 12635842, 42905439, 128614071,
39392970, 28695254, 63101868, 12409053, 39030549,
143913489, 29234870, 93527452, 70538128, 97991987,
143920147, 54723383, 141746612, 118593965, 77198932,
74382066, 34240384, 36971719, 48738490, 90018895,
134843610, 119461699, 105833926, 57042025, 77150312,
107455487, 3452099, 100574309, 115004486, 138279108,
143780070, 14642268, 140804779, 20187746, 58438489,
92661536, 102512530, 113889239, 124849365, 59288803,
145141942, 109353347, 46799072, 121177248, 9576850,
145540582, 274339, 147108033, 42235262, 129340158,
21260028, 141751108, 94285148, 109136756, 120871648,
87815135, 143788905, 57947186, 47756021, 18580836,
124196465, 124789668, 425225, 83449076, 81777805,
69993095, 1392463, 60857204, 124906044, 95194760,
53677851, 14460463, 144041688, 53500550, 30449225,
18381639, 13837236, 26109378, 128689759, 18232002,
72578539, 4708071, 122134709, 31063402, 42186795,
14770942, 51425471, 49902869, 38781142, 92298396,
22493411, 87314284, 62966166, 108432222, 63070095,
58960488, 131167821, 10319075, 70564421, 117164069,
41165326, 108159734, 77234321, 100453326, 98945899,
9361660, 103507843, 130104252, 120705356, 65891971,
26854146, 63584524, 101303870, 147737174, 10082988,
59805073, 91751387, 75414365, 66281177, 103849435,
26192668, 52299718, 97523302, 34117517, 7000455,
46139659, 135461831, 82774547, 30483690, 43376710,
29097599, 132694914, 50612033, 95921240, 134996352,
38976926, 29239517, 50231807, 32176717, 56003884,
69430644, 96369227, 36394236, 12319345, 31538162,
85260518, 128174344, 80851445, 36906540, 62744694,
50681232, 133005682, 81988154, 124670865, 59458912,
31515931, 98993465, 29629877, 126302082, 52960707,
37770854, 6001159, 129713283, 25494683, 94342101,
133713475, 57728334, 124322773, 118232459, 73998624,
75289580, 127538358, 87446972, 98903371, 52141895,
117809945, 149249538, 5197953, 16476410, 79511735,
15457591, 93943985, 70753727, 3982025, 30994037,
112956755, 97455492, 108846577, 67028248, 72779560,
122363064, 64533541, 124497637, 39095904, 32845807,
48362238, 24635733, 132742347, 10540447, 21378246,
127727952, 611251, 64266862, 21941317, 47565189,
135877069, 133026428, 11697547, 115966483, 94243363,
21143637, 10822620, 87156262, 57300836, 82264507,
103015705, 68279145, 48885515, 112920874, 81071240,
121318192, 119078229, 62107511, 84376441, 90079778,
35093755, 61698680, 114536111, 114332971, 20261541,
51134913, 86346134, 85623101, 30241939, 86009026,
2561395, 5579816, 129664539, 28044216, 80803320,
107025859, 128435047, 86494060, 139963544, 148962225,
63976095, 16131525, 139604895, 80534684, 107687989,
31085769, 145233683, 65932219, 52151594, 125309936,
82406310, 89153734, 41833041, 41495449, 60710179,
117139921, 11344764, 116070888, 120358717, 70128250,
139684087, 91465710, 47866193, 62441745, 50843230,
3016816, 65169696, 8719774, 64388411, 11285806,
105602771, 49920702, 78036359, 42919567, 26476646,
40154271, 78779421, 15735312, 126448017, 48839687,
99957111, 38066887, 117682407, 57449741, 24708364,
47939825, 76761297, 147973224, 10739128, 139321457,
3512473, 96509903, 17866290, 116567248, 101411269,
87914515, 940946, 13910277, 53377732, 98535794,
130926819, 64845053, 116182954, 35550711, 109297382,
73695009, 21447240, 133012114, 139300424, 104756483,
98687565, 114522160, 142196050, 8441694, 87373913,
42392142, 13503506, 104221723, 127600073, 52904800,
74223281, 92615590, 101598194, 67780185, 120695253,
107721109, 37847028, 39579140, 44411293, 106066843,
21403565, 44950736, 38037339, 40739129, 39983243,
5089744, 14196608, 69447453, 74696444, 119300285,
52205448, 14675348, 131543822, 100437609, 147089340,
54372121, 19178962, 145137797, 56469397, 77419175,
80657549, 138614444, 83457895, 109965955, 37658997,
9169953, 48809162, 82130166, 82494531, 22620803,
96983827, 43144852, 61705946, 55454065, 30191475,
50912139, 87175123, 89047918, 135545712, 58901714,
97459796, 12824382, 25377151, 149672383, 108826888,
28376422, 62364020, 25865106, 35508894, 120209745,
113133705, 76357652, 88420397, 46886583, 31248372,
56592426, 51380126, 630182, 59865063, 58661197,
113067680, 8881914, 52305874, 33529914, 95112916,
56110148, 81489881, 59675646, 95653142, 53814472,
143267021, 81593652, 69988605, 80099657, 4445288,
34529565, 94067386, 105462447, 36924589, 3380477,
89578723, 79189710, 112820121, 146062411, 103591715,
68610313, 89164665, 6231677, 40318538, 39011638,
83209892, 148154124, 7160674, 133718929, 23024657,
25554620, 623279, 118850039, 30548249, 118529624,
103502227, 90836030, 16897530, 121853747, 113585473,
61631098, 37177091, 60427895, 121470812, 43119343,
59918802, 141046906, 70715888, 51682338, 109614399,
141881542, 53385293, 62025586, 129944388, 59425951,
149795204, 109043615, 22523406, 37150220, 83073052,
22445313, 113237388, 45982611, 63838861, 146411754,
44777184, 131804549, 128857842, 113647842, 32130401,
53684626, 129239604, 44648397, 62155757, 67663967,
26376932, 101742684, 27886094, 118378998, 36325172,
111091916, 116170870, 18524968, 142874769, 29069529,
8580353, 90717457, 144396449, 110954663, 15416043,
41493824, 4038429, 23611166, 55506438, 45502907,
46371814, 46230314, 49579803, 68811455, 95268842,
2057166, 26596178, 60823480, 68130168, 114447187,
64351852, 21960971, 149346281, 137770654, 120335861,
71018001, 91393703, 64153250, 40094346, 27023557,
35036425, 8047966, 94820175, 41839781, 73320799,
137299456, 147452837, 109106947, 3968439, 83451428,
9170528, 69619887, 51526714, 6068897, 129037460,
119448917, 121270698, 111971700, 6505674, 28807232,
134591926, 121797107, 60297184, 103785864, 50476876,
11597900, 105544203, 11884447, 2110846, 38471191,
24440301, 140295722, 131550466, 106419220, 35569941,
44638880, 24448324, 81324467, 14752793, 137633936,
58689573, 1942140, 81484278, 78879558, 25455974,
4343601, 31753670, 8727180, 127373644, 70739335,
70300844, 144418382, 70000674, 4413245, 24964455,
21603875, 13465777, 89178078, 46552359, 142823129,
126531522, 117684903, 134242623, 149809152, 14330876,
43611963, 70407964, 65142522, 10716762, 115413207,
6091932, 23373593, 107992805, 137190882, 5935768,
26946949, 111746733, 96456545, 131595798, 79656680,
109787817, 3349702, 55711479, 84899253, 26724365,
17651875, 42318945, 55440802, 14169976, 84372306,
107830871, 1111176, 42881477, 137154513, 112584938,
114939406, 58416461, 98848442, 17321712, 110996276,
113026972, 33976028, 9119817, 148025568, 141004569,
147424343, 71829327, 65360790, 88223381, 10749819,
144071257, 86534488, 8560063, 47514278, 76964234,
71878073, 99153880, 139724445, 9078338, 140131086,
73986933, 33860033, 123613790, 149191495, 88334895,
28713070, 113147852, 106275172, 20153470, 123999575,
59850742, 28913972, 76801732, 116127491, 25825387,
138753382, 95668465, 14700739, 15774980, 95592621,
97943912, 6768581, 29966021, 73707544, 35753073,
135162469, 117695040, 117113431, 121146756, 80185660,
51596411, 2280296, 134373458, 9571851, 59196511,
131197611, 78377317, 75375441, 58152954, 17795990,
131492266, 54522513, 11386930, 33341592, 19142172,
143795069, 81481209, 42402307, 87124677, 79727446,
128930774, 30038289, 11249399, 22587777, 97233707,
35852342, 128979247, 9866569, 99093554, 25239088,
138467587, 102504488, 76511739, 93519350, 136533398,
68193340, 116337266, 113569756, 53384660, 139440496,
63662645, 39864178, 14008636, 101058544, 107753028,
143308754, 110921541, 128487587, 46546396, 122698833,
108182018, 19014372, 20074165, 55128224, 81278208,
31872108, 106379565, 91637724, 35524641, 39419956,
105104925, 8753353, 19717947, 79353066, 9045223,
99307190, 74059124, 83597370, 66272509, 25425278,
131385901, 18105097, 33392022, 68748254, 4679255,
18239250, 72033377, 112965322, 5048277, 79774900,
8152577, 129675629, 3191483, 123026023, 73412840,
42458335, 117870485, 7937701, 52304836, 116230034,
123975793, 3000911, 147124703, 108789790, 140596736,
16602013, 28743309, 7771494, 7932600, 128638675,
111279611, 29352509, 11505737, 93622301, 124350244,
120507729, 6240584, 92462691, 87379941, 37024876,
44044863, 2280649, 99127796, 5279807, 116840820,
13712158, 115499325, 118455025, 124034589, 15091469,
73805540, 13600748, 42125004, 82224336, 131364029,
102695984, 93327704, 46192319, 141166076, 1513284,
126686950, 66772505, 39335686, 96103719, 146577173,
128767739, 3246957, 133477981, 85007009, 8288078,
93894696, 135533977, 31638148, 146560578, 9075659,
35936526, 87270168, 32926379, 146401711, 44176571,
15946843, 135754527, 28226714, 14682833, 53435192,
35326537, 46772827, 79961041, 146395648, 26072002,
8336989, 21333796, 58154, 65467945, 71476104,
53227261, 95053333, 111747515, 57121776, 106265219,
69716385, 25869644, 60288751, 100505881, 85768560,
116947573, 78438183, 112534783, 13437396, 42130330,
23751489, 148848364, 41874237, 18395099, 117476772,
7418659, 130136386, 86176700, 41363955, 123202214,
54671806, 81740052, 95199910, 101780587, 139787965,
88506390, 47009485, 11313585, 76115165, 76401798,
14942001, 51913664, 74604172, 30807843, 71379616,
98995026, 49786392, 144084754, 125130497, 64555833,
14204002, 32884863, 28894196, 56210065, 81824074,
112866058, 110198395, 139067680, 20452949, 84266,
115071417, 82907712, 112581395, 42557394, 148530354,
1294646, 15696686, 34620148, 48883909, 73954641,
123816088, 137816995, 72949631, 89689702, 51321713,
75891606, 35762675, 11442341, 41087474, 14540983,
29544541, 80089456, 46801572, 9965414, 56837776,
106405211, 66330676, 64629203, 142580076, 20237550,
82225112, 18166973, 107341567, 118968429, 9294288,
86163483, 66541310, 41541103, 143173607, 25766225,
55498921, 60552179, 1922071, 85736360, 91055434,
108906709, 11386553, 22330899, 35382522, 29328396,
97995169, 27172528, 63210306, 123212042, 101325072,
35654186, 94611104, 100422973, 18283586, 57050787,
69639908, 30916406, 5085585, 128073739, 67426384,
94277081, 100653454, 97802919, 66456585, 110473465,
124221039, 94117871, 137849407, 113762157, 2543186,
83235823, 94257347, 47870235, 134245968, 67264456,
49368464, 92330429, 40513651, 120717005, 130740842,
129708875, 86408618, 23261581, 135043893, 39107338,
65806865, 15428130, 5474918, 126313113, 19183576,
113566486, 66582618, 12813051, 78762214, 91338126,
66769273, 36482320, 66799150, 34938950, 31673106,
14000438, 50605579, 127681592, 133576461, 137860615,
54747628, 6634694, 100898799, 15496474, 89207585,
84126280, 138992860, 103169863, 84873642, 2124769,
107159599, 26053957, 441191, 94076762, 139375573,
56733430, 87551600, 86051918, 33261330, 91088604,
81559502, 8598532, 38798919, 22534809, 122352628,
57041082, 101173180, 126707686, 22824680, 84785175,
65242897, 19858763, 79819257, 97853797, 12254460,
62135896, 128774511, 37136608, 83880974, 20279814,
26467430, 36061938, 24435270, 97389730, 65000709,
76762378, 37190342, 38539626, 88873091, 46992455,
14908128, 117123717, 7231566, 2426569, 119909416,
8331196, 146014376, 125267980, 70069414, 1426245,
64114926, 21323821, 19533283, 67545772, 122795620,
105852920, 112609122, 138163642, 75709655, 95818167,
66751570, 9584855, 28214121, 58693671, 69354177,
53932089, 71989315, 53588913, 69974893, 34490012,
73895859, 146162411, 60236204, 1827511, 139632108,
49540071, 148110498, 50390451, 123805796, 59663606,
78686619, 118695407, 87243644, 27509738, 25143616,
108247897, 90801075, 124008691, 32299150, 82878115,
147801492, 17687150, 128349278, 21607372, 27386345,
95110499, 71048994, 19866757, 10637124, 19211863,
69369412, 149164302, 30402953, 2400642, 134326925,
128721798, 145816779, 85378541, 11547274, 14917377,
130047966, 68004386, 71456640, 3002465, 118726009,
148080313, 118178114, 98169367, 14782248, 14604178,
61080970, 139713248, 95455150, 14085186, 46456229,
148670059, 76454417, 67064047, 65316129, 47157477,
41125527, 65146663, 53583535, 102273212, 142932469,
6957522, 69552268, 57348004, 98679312, 95482890,
141116531, 116891390, 15607528, 92320226, 63778319,
90020737, 30122282, 12941902, 79293664, 94140261,
13137438, 146126335, 123784732, 6950903, 17804241,
53801139, 120754137, 30543169, 48564009, 135286634,
110813770, 129959636, 76179697, 34655475, 12544537,
124854661, 11188936, 137209018, 104838016, 55268317,
120794966, 65894610, 42384374, 138355526, 104722476,
95455786, 75629838, 35910422, 40759783, 102250297,
129763767, 13696602, 97330643, 62866979, 25978835,
93178440, 51546860, 57619040, 64604559, 52058533,
18132199, 19203642, 68722445, 15409172, 43322616,
23272578, 45814100, 28359753, 7788493, 38016723,
112400854, 126852266, 60958582, 148365471, 27306645,
11186889, 45666902, 110509931, 13084222, 120877011,
117896318, 107320864, 54536486, 15434907, 100307095,
116155830, 136779357, 149077878, 146886652, 106036136,
52772235, 96044039, 27470937, 62175335, 17871049,
73078031, 60988144, 142941246, 47859512, 8529065,
88637239, 60133599, 10130730, 79928064, 44908240,
120783375, 58822302, 64387473, 81843067, 76226690,
86360053, 20694364, 126848172, 112155208, 117457532,
18765317, 8877960, 71458389, 77482176, 93779351,
57722418, 52232359, 8233099, 135504468, 60924009,
142236477, 7817348, 118062855, 56936875, 41317827,
59862399, 56871312, 142017971, 41165303, 80890939,
36554049, 121404642, 24354300, 116574588, 55188183,
122351210, 108121877, 55366169, 33230816, 107488204,
109183779, 67439522, 126906594, 130908688, 148715473,
98651059, 78052726, 54798655, 21482723, 16943901,
9391242, 116044472, 53530864, 12755216, 97672459,
33632378, 53171358, 90794091, 30652877, 51711333,
106491655, 21242961, 36137841, 60326044, 112740558,
18905140, 146713303, 66348725, 125593087, 126058049,
106185276, 56105253, 51464389, 110132913, 12166800,
137706970, 125717513, 117538085, 65943459, 145155912,
5916434, 132783796, 112645821, 46218732, 52549102,
19731081, 18658993, 144377846, 119593264, 141617954,
140673700, 81447119, 146240112, 135373366, 26457625,
87051184, 55163715, 119302817, 11284014, 50540988,
51479400, 134138118, 59555680, 76128226, 122024891,
16867207, 129993268, 86446724, 43846358, 138335509,
69689511, 33948812, 29324174, 149117231, 59869364,
92686947, 133360261, 111977458, 93074791, 13670894,
81321650, 123376135, 79729952, 126380221, 40891817,
6666766, 131572920, 110393776, 29043762, 64432253,
17477321, 127854134, 4046064, 15742558, 143361076,
127352603, 39662279, 12967947, 96698551, 69756072,
108750429, 110542443, 70161899, 9052818, 131361781,
59650116, 110737384, 101102025, 142213228, 70376646,
132202720, 106165864, 123322529, 130017110, 131594252,
139480526, 94145456, 23855340, 107734105, 84741189,
84009217, 9912743, 74162246, 105345633, 69319718,
94182521, 144858118, 61901785, 138076747, 111493539,
143489297, 147657292, 7885688, 75253883, 21882944,
109710516, 19535895, 53256389, 43804907, 16663918,
51534673, 24708437, 26112216, 108722031, 24767125,
23819876, 30125866, 126430561, 85125457, 145064720,
54325729, 36805195, 40274163, 67485491, 139498138,
22497769, 129870925, 102735369, 107137599, 43516451,
63912995, 39935209, 74275028, 125798492, 14240799,
95920193, 77028758, 88484824, 24371209, 121459229,
149788792, 63897595, 29869237, 148948058, 85212709,
101941121, 53991957, 31969330, 136867087, 131249833,
15359379, 89932798, 45191464, 47690315, 88772905,
83672763, 109155173, 33737676, 133566430, 43524014,
130253708, 138452428, 59825528, 3751637, 26928403,
52748521, 52526616, 20498304, 127742782, 85645800,
136063847, 100475955, 139698456, 69136094, 47552892,
140224220, 56708051, 126753215, 1350646, 57520434,
120460986, 61954169, 134820911, 143993864, 60082661,
704748, 127747623, 102831731, 84612069, 74462864,
57301982, 101313515, 51194850, 11302780, 137410939,
43311041, 65559704, 97159913, 80778161, 14572771,
40667492, 42535390, 51478933, 6236719, 99023108,
145563945, 47745722, 86165986, 112048951, 83409128,
104068002, 84176998, 86275733, 138966546, 65205877,
92722722, 20671571, 65297263, 20151014, 12320333,
185241, 75225570, 8441218, 145413422, 6897028,
118255009, 125474121, 98188854, 36133577, 114314111,
66682558, 104136001, 87931080, 2675306, 69516011,
103425214, 41918719, 133827215, 22236049, 41397873,
82376691, 35984943, 121804339, 21100896, 33461594,
77575134, 116672174, 67580716, 49531104, 130828794,
8331753, 46431427, 83702534, 127632543, 118541013,
19999089, 122816539, 15769473, 123888782, 111939212,
48967048, 35514111, 54456289, 47155214, 24338241,
68792140, 68457715, 31425628, 99247424, 132263147,
99153774, 106893204, 125031790, 139051372, 27573670,
51872318, 67429002, 115260794, 31413624, 55971180,
26336152, 92061798, 129036399, 88656759, 146312649,
18100669, 29676050, 67121678, 56649552, 77123751,
20689987, 24321809, 58155426, 69199671, 102709702,
52523196, 126004400, 27079597, 83542157, 101090485,
34784107, 140007704, 80395915, 55972629, 1294492,
76737729, 87328883, 99852315, 23954948, 129832831,
54127479, 76228454, 74096024, 76506431, 136651869,
131097514, 132104283, 125049098, 140396041, 14411101,
100456588, 105398538, 40388762, 25928909, 76597156,
137895983, 82483714, 12892377, 10476220, 17371505,
45679981, 37170751, 122776000, 49198422, 74814245,
41265215, 52582314, 103622933, 49126479, 75904805,
97569699, 101748340, 47758902, 90664409, 65358331,
135371044, 55431244, 102182276, 139406629, 79510678,
113956126, 37177019, 134439412, 4620644, 70664652,
52926622, 5234962, 90558579, 55497854, 132489665,
1069636, 147618802, 33051415, 113211101, 41647937,
74892568, 118851321, 121062354, 112892822, 136054025,
124395432, 17610991, 148613878, 61983919, 147907937,
11798361, 123016549, 72289945, 5435009, 121455784,
130190491, 21697351, 6503921, 77550950, 58076344,
71442397, 59197853, 124227993, 135645065, 97737683,
23397528, 63081269, 109407625, 109243617, 121838334,
143595702, 127205600, 120016080, 119086667, 52444933,
20312236, 52774169, 53727253, 26572770, 22229295,
68932140, 76965614, 82017769, 144385767, 51916163,
99031404, 117248843, 87557280, 10723981, 99402694,
143252321, 129882515, 99738085, 91823278, 75397028,
124580979, 106752012, 131995884, 83800773, 76865940,
96404859, 120340539, 44441932, 35029620, 54832233,
73406786, 130207597, 88207575, 145087134, 3203990,
122084874, 132320520, 5618850, 40117908, 126040511,
92247479, 110925050, 47837342, 114868132, 100200910,
107874884, 103073470, 65737018, 111725571, 103622093,
5484413, 138750229, 37104924, 33748271, 122673845,
2178541, 95749930, 71090362, 63124302, 146025378,
127046595, 60414191, 115189265, 143128982, 124570467,
128777652, 61587887, 47498634, 96141607, 101796122,
122768243, 54941864, 149151169, 45730396, 122106670,
65751569, 126521927, 32261013, 131342789, 146821978,
64392549, 52028812, 19489949, 77774486, 1918392,
49153072, 145666708, 103132658, 60018794, 19897725,
70101011, 74117242, 86546169, 44903660, 109389464,
105920078, 103339783, 42346588, 78368487, 94531618,
120079809, 81325987, 122113292, 55940024, 10495221,
48326778, 14370189, 130901941, 2152242, 70538766,
46531797, 33027560, 9069383, 80632772, 74051848,
85769346, 121838699, 9566010, 148273820, 11128210,
131946674, 142990605, 122736333, 11145144, 149526643,
32689987, 114745530, 126693375, 117257353, 96639165,
78986520, 117462796, 8302840, 149443620, 96822818,
33313679, 73982104, 146922972, 17241392, 146634367,
83684190, 67853759, 108318442, 39709110, 11913426,
142924827, 77391933, 23955581, 142959357, 22178253,
53015786, 114055974, 67438361, 146590675, 114541005,
103148368, 11028087, 52515829, 122078549, 19251598,
44373985, 76671999, 81591886, 95920295, 21806197,
27979312, 9230967, 100672747, 89312111, 66629855,
4420086, 142071091, 10385721, 5098599, 83533374,
127393756, 127728019, 148359021, 87567542, 128825422,
78290505, 138275370, 33400227, 92250174, 113170111,
59205188, 52964541, 124259731, 133605362, 63288826,
95365243, 9908408, 71295163, 118763645, 112501795,
64901964, 66242955, 80242163, 17758591, 82010336,
6943975, 21230793, 110780361, 145067820, 29182812,
1419678, 130135608, 100183105, 104074913, 50788689,
53025849, 134618502, 56323033, 119595015, 146008270,
134086177, 2178615, 49125504, 105491916, 143881857,
21840250, 25286646, 141799331, 66618576, 19084423,
116600205, 76484944, 136791111, 63584312, 116042026,
87668669, 80059499, 116144693, 47593440, 101013474,
117921970, 94465989, 79081512, 25297806, 109727324,
127885545, 127527250, 90282793, 101712570, 12430004,
36545910, 131961252, 79569636, 35779446, 102898353,
55380939, 78229050, 129970562, 13026751, 13085615,
137095513, 25401021, 123602547, 131041000, 147808882,
44155745, 41709892, 939985, 26723491, 80359558,
73629490, 35085685, 32135990, 103183831, 45642246,
113328314, 50913699, 19983435, 101191919, 115803320,
98978449, 118603844, 117562844, 6711374, 51609947,
111338982, 25639768, 73403188, 48355057, 96506973,
131796808, 27133790, 104503073, 94295252, 52946320,
53728652, 48382444, 59373147, 129513100, 64702692,
22942411, 68063727, 3582079, 138617986, 88971124,
61985250, 52765485, 136208083, 145663403, 5282975,
136472431, 110789475, 117448677, 12168143, 98662397,
10674001, 149520901, 10815920, 60794132, 9007693,
123359304, 136328102, 127685208, 50610348, 132266213,
61538408, 92654712, 30092753, 132842750, 66152361,
22033531, 25133491, 56854115, 4519732, 49373072,
132631823, 13372968, 107501074, 96326486, 29789030,
20996816, 42273096, 62942294, 68378691, 61021510,
40539651, 80071505, 99433214, 136548698, 140831731,
19881489, 38386231, 48018827, 20869923, 89395551,
63032849, 40722445, 67177029, 2240609, 19329894,
97641646, 6174983, 62830133, 112728797, 51696492,
56507576, 131082846, 90868846, 138634372, 12763445,
99884127, 84527106, 26161689, 111814012, 107467948,
4491976, 52337337, 115493453, 117412901, 1145885,
149863097, 24767582, 2386369, 103606676, 149398248,
19536406, 86476720, 84833007, 38225524, 118899432,
94935618, 50229528, 89708388, 64786662, 147445812,
128594440, 106151366, 67664442, 149867776, 139736317,
98521880, 16065425, 108104862, 106887187, 139764414,
8347019, 79879432, 67287859, 116540886, 87956936,
67353105, 2108817, 137503927, 125832828, 65182514,
18307952, 137473019, 39795670, 74442841, 74152693,
129229639, 87352105, 113193866, 21713967, 36836426,
85820171, 122484496, 13726088, 98760468, 88691544,
144903647, 5042162, 66722999, 62282393, 89416327,
18314629, 55788458, 118440744, 12916050, 60620288,
95936938, 3012780, 47012108, 45107744, 46135092,
26093312, 50496327, 29653776, 47628650, 20621605,
148298243, 81418086, 127564237, 30753698, 75870791,
3041536, 102208460, 92669008, 149092736, 57475163,
121892767, 147010899, 36749015, 36855595, 31282587,
78331826, 75487494, 127430648, 40959758, 114650920,
38327408, 39352142, 114942716, 67584305, 53713739,
40424316, 92765226, 80313641, 85665262, 33915543,
145015319, 102119231, 95635838, 53676644, 29373134,
81599090, 126158970, 46436768, 143738770, 86683518,
82388664, 27671594, 53597671, 88574680, 6424923,
44818549, 10015816, 1425335, 69249805, 37024685,
4012830, 49366795, 114061337, 90868544, 64943814,
44688497, 26427432, 39908796, 140230719, 80720254,
14441966, 216810, 97850851, 76648516, 51001377,
93208549, 30419249, 107385061, 44832222, 92014263,
45218261, 127781031, 40762116, 44258953, 91589115,
19131369, 8851157, 48748292, 107222202, 29534117,
86076301, 128688826, 41314650, 50411983, 8336762,
133010126, 98200743, 104414125, 8265276, 62905383,
100886719, 30329407, 104594527, 51234346, 118748866,
5959184, 85045273, 16479183, 62901283, 106010186,
149597485, 116788267, 24775289, 8234616, 26533412,
128049796, 128543393, 130940707, 87569219, 19024163,
72319530, 108086834, 16697707, 83788636, 53729740,
61317903, 103840394, 18477413, 35976288, 12967272,
16557466, 3212186, 127284147, 15105742, 117075430,
10723603, 8334119, 12416021, 4407061, 31543405,
53039047, 104822624, 6785410, 11339779, 52553307,
25120010, 80749318, 78061969, 105418111, 86683903,
148709074, 62426126, 147392156, 134951250, 62438737,
62610879, 88762335, 95930333, 106987709, 38594188,
22331254, 92110363, 141430541, 53121413, 18180694,
149939924, 60443903, 28972386, 36381617, 26579691,
74449265, 140649973, 45261393, 59892211, 81664257,
81446169, 61915688, 126202556, 119872049, 46301131,
14956115, 51729589, 126725990, 37414090, 80800687,
35648828, 113803147, 27117700, 51027428, 80070774,
45399540, 17503344, 53651936, 4140578, 18677922,
66207230, 146741301, 42382622, 77788408, 88176391,
130673286, 75531594, 134731160, 118917586, 106541178,
46812163, 30532276, 111331010, 6253786, 46873779,
133747803, 73185364, 43124035, 108619154, 9339448,
2083944, 91591401, 134532373, 66252749, 21337107,
57438038, 52015709, 77852233, 30689432, 127066691,
71313159, 61350685, 117501036, 142855451, 58405553,
33379109, 136131618, 14760599, 44242916, 30622907,
102918400, 125323416, 61428771, 15378948, 84469972,
15458087, 58446768, 80502740, 34458748, 57082102,
63202778, 7948690, 58565815, 8114602, 51490914,
19465360, 51600672, 113934145, 95958822, 62039217,
118023741, 100473085, 77778518, 19663709, 91295686,
35191825, 127687580, 80067181, 19984058, 22671408,
142628648, 2719617, 5789561, 70634863, 43873209,
33513375, 13501858, 52523690, 149248968, 24559667,
70991236, 98586548, 54220740, 34504479, 35262057,
115652648, 35018399, 58670331, 6766551, 115936254,
58504029, 76137902, 9718965, 142860199, 71834939,
86756508, 108194139, 63800801, 128315503, 69019584,
126618619, 82320608, 57648831, 50682723, 33829833,
55910137, 72671904, 111304220, 43816002, 40730505,
144726640, 120894700, 42541207, 53002752, 55275645,
26021516, 142948049, 136606407, 112430419, 64806165,
39766320, 96016679, 105593362, 22886674, 149839764,
53377523, 12641940, 13006754, 13268517, 61036597,
60950845, 40080776, 103585926, 17821744, 99837818,
37746420, 132237802, 91275528, 149991794, 83078382,
37831155, 108255937, 82717957, 107422041, 66901964,
51611246, 53410232, 19656968, 67269608, 56442849,
71041921, 16295146, 22097911, 65245321, 1120215,
74072756, 39345707, 62146959, 134746770, 139007565,
127836879, 113518817, 115453927, 26941016, 130434354,
56781002, 132456888, 126080894, 94152178, 91384751,
86904816, 87416280, 63106178, 133999744, 66855749,
140569488, 139836903, 143812002, 51933436, 106524110,
69772462, 102558304, 123506023, 12178597, 26272070,
12258953, 15274781, 104229122, 90719248, 65560337,
21546590, 66093706, 61085689, 116061190, 138357869,
58774914, 9631091, 8967708, 106330052, 2536408,
111132364, 141705761, 78776723, 112551280, 93925020,
87270466, 4576817, 24559172, 81964311, 35799037,
82939755, 77624118, 90855371, 50783137, 12921718,
49209285, 10786372, 144959310, 65064247, 110855046,
141946867, 141632703, 14099962, 38645824, 144799725,
116610737, 106039558, 59104695, 50914787, 65099159,
138950804, 82516464, 108637170, 113338025, 37942126,
67201945, 88951207, 113588596, 103478585, 97907102,
32966164, 30052275, 97700235, 137509310, 45718303,
73680558, 133519385, 16938008, 27563144, 139162762,
1680781, 3111687, 146924204, 4504742, 6867661,
64593783, 57434848, 102927499, 46399282, 11354413,
5160549, 106174556, 141057355, 113446547, 95738554,
26776750, 66687425, 44405866, 120934037, 63413452,
123127474, 81331625, 75353737, 127821235, 57050423,
42590363, 97402785, 35571659, 31677744, 118107560,
131624028, 50465308, 73394700, 11256635, 121426161,
118292404, 127272293, 46993794, 62764918, 64416129,
26847215, 57418327, 64109350, 2473553, 37969739,
126795711, 12462462, 43401830, 22452941, 8199355,
31739891, 14731231, 138557490, 12070940, 124102808,
115786112, 42307317, 105708000, 77819676, 96892941,
37064008, 92285470, 104631774, 83108837, 84841689,
101378571, 25958436, 72526716, 13705531, 61235265,
48982084, 133327350, 91926853, 94927625, 92189407,
51339136, 46936388, 52522730, 78940123, 50002367,
53388464, 114080020, 49042270, 95667522, 43247908,
47594211, 6161938, 127837471, 114665917, 32879176,
64304140, 72478842, 78310105, 98064981, 70385251,
107303710, 136778808, 19680232, 101577670, 54484082,
86870256, 89767437, 82150807, 94473868, 124198670,
1414668, 88013281, 77647687, 16424674, 111104005,
61105970, 114895582, 2833234, 38691247, 136507281,
136181543, 129621819, 113265378, 56705549, 80251069,
66806924, 85447320, 145810842, 27084376, 117791664,
73577378, 96665646, 2619400, 63254372, 59553131,
114846067, 113559045, 64028650, 32605078, 45379448,
81694332, 14710160, 3500647, 29184604, 106193745,
39565157, 66182228, 26847247, 31227319, 69512931,
123271944, 114039919, 23501185, 140488225, 57914507,
69886423, 69924807, 63163831, 10283389, 98389980,
138604367, 60993520, 84936880, 89384850, 113638090,
4154526, 65915731, 40505584, 14296533, 131756277,
49127314, 23270892, 71271143, 81947709, 100013490,
47442412, 46068473, 74093745, 103778234, 143191425,
115257996, 124152072, 38459408, 63150455, 140267563,
146483158, 33427733, 87524478, 130086916, 93375342,
56599703, 48498120, 52113072, 56127035, 118562537,
27620139, 44126865, 7435071, 40943185, 27351824,
127364216, 19971958, 122854416, 83679884, 68353742,
117543115, 83034573, 1152058, 41130457, 33892793,
109585827, 363422, 143334546, 145434989, 115990068,
131706042, 115981410, 38757253, 144737601, 65173660,
64984369, 78354897, 16402238, 32192370, 43506170,
68380759, 20672426, 16109793, 40092719, 100835212,
110982311, 148731004, 61298710, 20752137, 76636031,
80630485, 116855437, 23227967, 63949623, 38414422,
53991262, 139722080, 80052332, 119433912, 24026889,
40386220, 14501908, 48264793, 86372455, 136492007,
146781690, 122082141, 23948139, 104723893, 83095683,
64796098, 19390250, 144745233, 51603310, 118018460,
101037888, 143953288, 143839165, 42710118, 142138254,
117913433, 145247095, 95625095, 142140011, 56757764,
16018373, 77505324, 70596856, 16450888, 142791435,
56948604, 84092596, 141423808, 91058134, 107282845,
117619448, 31154490, 42422331, 40649628, 27763002,
19015724, 80865431, 76129776, 51337261, 8887582,
76519044, 121018983, 100038915, 21135945, 64137926,
105667287, 79005252, 90727435, 131408996, 100208923,
95722835, 37773692, 75889318, 92615057, 17004830,
143493409, 123003082, 2605297, 38937668, 4750504,
10123679, 125979584, 22937549, 112768847, 81483644,
22894569, 13588580, 111531514, 128700945, 59217649,
123908332, 76574501, 62830220, 34635771, 106377477,
140064411, 137366639, 66455583, 148488552, 147948063,
31387353, 108463905, 937378, 23463683, 78267331,
82211359, 24591790, 98713983, 129153926, 114401165,
88101723, 137477024, 136029836, 5612386, 119698557,
84981926, 126246467, 108404329, 74834423, 98777754,
55704474, 56875310, 4136524, 47622172, 56459847,
137205920, 81025362, 72055243, 149122214, 130223890,
6743615, 93392102, 16322034, 78669126, 48542118,
16277745, 40634091, 87786425, 73065650, 95466561,
99089200, 30621107, 94576855, 3846897, 11339966,
135621783, 72787415, 22484573, 121563121, 2407211,
9446204, 28994718, 30279856, 129447094, 9340908,
35896834, 5977732, 141349212, 46433776, 120500576,
144185266, 93394761, 133558007, 102682914, 108839936,
66427895, 37263020, 128573713, 68486301, 40784970,
101439903, 107900878, 123286611, 127225276, 48920946,
15924025, 103115538, 70308255, 24416657, 131409367,
52050180, 74041914, 117829728, 42519709, 103682748,
80152320, 133232857, 27307587, 147013072, 139638006,
134523664, 16798119, 30523653, 90549890, 136734165,
36531434, 54188775, 42502094, 114381635, 84809121,
22757654, 35628781, 138153021, 76611809, 52443438,
58498775, 103444134, 28094176, 73318055, 21400240,
91822041, 65360235, 115058201, 29176884, 134400422,
2559920, 59417307, 26289601, 42851487, 75958401,
125480284, 73425309, 114554590, 70728967, 126890619,
106745823, 134454380, 70721645, 65351364, 110449860,
144522592, 20979344, 39092624, 108149617, 90982717,
973431, 52682118, 26828498, 119481203, 114094877,
74119492, 122830122, 53781803, 68663730, 72378744,
121362213, 90940777, 62989706, 53479496, 22771086,
61997562, 21889015, 105452639, 46876291, 146993664,
3526089, 14101797, 148298590, 45350497, 73123232,
77724180, 33114096, 10076249, 137129451, 10374077,
83556912, 85551379, 46501240, 109815751, 82580408,
60049069, 95520873, 13944133, 144845271, 51725092,
59671843, 123880499, 10974571, 29115214, 108093552,
10070866, 93135309, 134536509, 83766765, 40688003,
32331248, 64510130, 99553648, 132445697, 70719251,
18043107, 22854113, 6700787, 8585375, 69519072,
63880174, 34827240, 21224579, 100792795, 143607781,
57996197, 67135117, 105593353, 50623830, 105279721,
91669292, 1044783, 78170515, 60929158, 73968938,
115386321, 16565333, 105093287, 135472197, 118717017,
21166372, 104338297, 38015817, 65692624, 94889323,
107249741, 8511943, 89341511, 106457825, 93077027,
117397874, 22710038, 115572353, 36628682, 75219807,
65128217, 93581293, 106014126, 87952685, 96735607,
103427625, 126235938, 123679380, 125686304, 145660335,
62869123, 54179228, 119677440, 63607807, 2198808,
141000212, 138424570, 42766209, 52952720, 137480105,
43088310, 76265552, 21524910, 61608492, 15592616,
98807310, 50618210, 45868356, 81098715, 48164712,
142389104, 85246654, 6852223, 123407135, 122056553,
122888281, 144178395, 23120143, 56971590, 32513262,
136635587, 34495717, 56181585, 141944404, 52313607,
108180939, 119223329, 47835393, 93311523, 60781471,
39804620, 8698458, 27902034, 1149573, 52579763,
114158751, 104309627, 7296710, 74245463, 121877026,
135536791, 89632097, 64705093, 129472775, 43309926,
124516641, 93218122, 13486478, 78598347, 103018513,
98094815, 13537587, 147045617, 53775628, 12329066,
32507055, 106154697, 144706155, 7224578, 35496709,
6612579, 31105188, 100033813, 122877542, 39058209,
69249443, 61630271, 87324607, 42615863, 4033992,
107982488, 25068338, 119387307, 38093011, 108762346,
39736839, 26337058, 71335906, 40260728, 23458521,
66795801, 16200543, 134221775, 63504851, 141794256,
136450123, 74622783, 59823129, 63044315, 121407907,
132116001, 20300813, 58505180, 147750260, 122847555,
127629976, 146537430, 116171243, 29596083, 76557271,
130689278, 71691848, 108833746, 5086829, 42489263,
34603423, 16193470, 85661162, 36545168, 139236237,
73847085, 42082608, 25841531, 90163845, 26952201,
123175851, 121103424, 96333013, 123069688, 56933083,
37582316, 112232210, 134555063, 136269179, 96252929,
85475720, 127997216, 89529231, 93224317, 138130714,
41028603, 8205384, 146034888, 3914970, 109850937,
118412737, 50672191, 121097927, 140937936, 25805036,
63238659, 82174302, 11974939, 100695073, 94283208,
81465461, 99542539, 76270054, 84554937, 135579215,
75953819, 40785810, 69723918, 47322834, 66236612,
105300353, 146648282, 128858127, 95810995, 40284834,
68868915, 57435430, 43157013, 64455400, 17945681,
76524233, 55055053, 23061938, 76817228, 64271676,
59799141, 104318151, 86988935, 16148221, 53711050,
94335529, 30042257, 142593749, 78956488, 60982811,
37791744, 103195528, 108079171, 13153557, 14296024,
68424027, 78234455, 114933139, 31094065, 94731,
100877381, 30456078, 126820216, 61645442, 50978005,
124354684, 57344977, 99742179, 117434919, 43704465,
113320311, 140260577, 90198933, 76222602, 2978921,
139885248, 59826818, 37921813, 119650725, 11881463,
78155240, 25852043, 118181265, 63222756, 111861527,
132915411, 68657814, 73822519, 77731000, 1379944,
18927972, 126248794, 124308945, 60497241, 65285734,
51385871, 3097694, 10703761, 128069979, 115666083,
1610310, 23758412, 88068805, 48801066, 90747372,
144845864, 10681907, 137664606, 3406775, 135446021,
136892035, 38156454, 13614832, 70267903, 41041452,
18506094, 46890741, 24752789, 107137208, 89828775,
26703205, 146484586, 77819148, 18769954, 126681331,
31907358, 103977095, 39101524, 34344802, 47964887,
79150404, 106982863, 46379442, 52423980, 88345622,
24360494, 41765198, 77846024, 40421887, 81399426,
128357367, 52038640, 97335965, 90506000, 94867927,
7032820, 19192030, 24838930, 121718685, 21797367,
107831253, 119255920, 132999398, 38505121, 69430657,
25000498, 48924534, 49864775, 37550099, 43626720,
137009556, 34247373, 27010395, 103315310, 132518065,
46664201, 29898536, 18388638, 123986203, 82850737,
49486210, 49806813, 47861325, 147129163, 88570501,
44106078, 51755112, 115502136, 101031674, 83812282,
108870842, 79647967, 86083164, 88323639, 51762718,
50802915, 17754579, 52632774, 100670492, 91112599,
86510684, 95751899, 137021575, 29234589, 50783785,
129976597, 79754568, 4599435, 18299326, 104704546,
32330885, 24890190, 1123593, 44391294, 131898837,
109107614, 134255394, 54014196, 11799042, 48680989,
120652544, 147678941, 127319761, 68876950, 108093668,
25410386, 137348208, 50864761, 120521379, 136146429,
8092665, 72415699, 128312836, 86119861, 40272445,
76968569, 40312562, 72160109, 140953760, 71502498,
36747686, 24456488, 30733868, 4819674, 131840303,
62273710, 31354558, 50154006, 1152680, 132232523,
105543434, 13966427, 34574286, 86865399, 31378409,
76079040, 6108451, 32149095, 82225866, 4236536,
144881160, 8099686, 24893101, 65334102, 115430226,
146428251, 53934950, 70636858, 33608635, 64626556,
76710697, 57364617, 92512680, 95285200, 76513235,
91622457, 79783652, 85496271, 91512607, 109965812,
49875742, 119993695, 37328550, 65543078, 74315176,
26245300, 28038929, 135331738, 76657277, 21115784,
81959079, 76720509, 36152723, 130259841, 103927644,
9603669, 79846585, 85415253, 103636299, 145476363,
140306296, 82214059, 37364301, 131666535, 85473209,
74243812, 101677586, 61273016, 93160571, 105709908,
40966959, 77195008, 134407545, 134394012, 106521555,
52394899, 19404330, 55183735, 80555908, 57394254,
145908863, 54073805, 81829238, 69967290, 36363316,
3710303, 32881738, 54809788, 113095792, 34256266,
115498376, 53498275, 41560011, 133914124, 104056220,
87878488, 96388075, 138992904, 5459031, 48911321,
221206, 114170930, 23595191, 95334440, 120852393,
119053139, 95465877, 144581520, 6370560, 65157304,
10509005, 78467489, 86902515, 10862315, 140520257,
68139109, 58097456, 102871648, 125677505, 132018938,
5689474, 83296750, 45278573, 71142540, 39373656,
17140349, 100320734, 14339734, 15829597, 73419242,
89397209, 48842286, 69944702, 97619750, 54892391,
50195563, 86521155, 52545143, 132285095, 2229049,
99567336, 44276056, 46061009, 102492424, 32048379,
1851486, 21234796, 115690016, 65389118, 51468086,
67958947, 66382308, 85151212, 39550439, 135805962,
26417736, 5975014, 51010269, 138151908, 91066522,
85467100, 145014117, 6998612, 73388496, 120156215,
80588319, 79060299, 78915330, 93149065, 95420197,
106931813, 128127696, 91293431, 111253905, 145361989,
26193933, 62120821, 29558940, 120307987, 67799345,
132155590, 10889077, 119163635, 145328546, 88905151,
124781312, 143007505, 30548482, 113138887, 75978791,
131566778, 131202543, 89253366, 10898015, 122595420,
130876677, 12789809, 100506521, 69122904, 50573300,
116418707, 103101744, 73540080, 70699451, 3185543,
97465328, 11256236, 145744775, 109717983, 16626807,
137380483, 61224703, 13262978, 102683095, 51574022,
34308449, 79255903, 143641674, 60154262, 138077724,
20040570, 74108632, 140224093, 76863016, 68690148,
18592426, 18011245, 7119837, 17935961, 135129131,
9991171, 18566142, 58624578, 122772511, 36879769,
103817106, 141583373, 47117447, 92075863, 9735198,
72715351, 59602773, 60601631, 81134275, 1611450,
85826328, 4315156, 28993040, 95104327, 131884412,
49805354, 46515169, 39678372, 16601627, 86203489,
50313388, 121759457, 17971408, 104978173, 112942951,
24377384, 100908719, 96728590, 114924166, 146796324,
57377546, 144580740, 105130092, 138725820, 107015058,
146035235, 103618721, 33695753, 32567558, 13826447,
137430999, 23276458, 144421319, 110189858, 142884900,
14502908, 110824572, 86011236, 102411322, 109720946,
96407497, 34867482, 39138771, 111548180, 122241299,
133986473, 121683474, 17010490, 13021901, 128459754,
137718062, 57256716, 66410339, 431270, 7814176,
84320565, 149244533, 117286751, 63192803, 12457005,
87785481, 145331946, 60937089, 73013883, 34569762,
30029125, 12336496, 135868649, 5757693, 22478584,
146962115, 110061675, 139170351, 7281714, 117175934,
36568984, 4302514, 111381823, 51458958, 103649460,
33335542, 43701694, 58331109, 73393027, 101065699,
60747738, 145837821, 82204880, 16505096, 5246994,
143121754, 80451906, 149337088, 113670973, 128011794,
40498985, 38366767, 55529346, 127027159, 105885117,
137641709, 12056745, 67423998, 114457380, 97035183,
44401369, 40368030, 77732143, 133594747, 25667738,
91382131, 27471895, 29303533, 121467302, 43275586,
20357648, 7392439, 148146967, 77291204, 102711226,
34784530, 43883592, 118704993, 120094455, 7374562,
8556592, 50968177, 14232452, 107198828, 67935231,
122407767, 39943637, 96597205, 22767136, 80974752,
105854441, 64621796, 113018880, 69706895, 15115248,
5912508, 145270187, 94066648, 117030852, 95618764,
27095186, 72892142, 116188266, 44723338, 99174031,
89467873, 97171319, 52882317, 22330738, 79449669,
92084314, 3167104, 69724053, 136155976, 96582240,
139336983, 6656222, 128724448, 35343023, 16656478,
8851545, 70206150, 79811773, 133070412, 66653829,
135049686, 5188423, 3260697, 1755358, 58873,
90793028, 51738982, 68543288, 41938418, 46396434,
83914622, 71864978, 36765776, 24376789, 35811923,
22099141, 120550991, 16021584, 103514693, 101476151,
141351624, 24637185, 1422236, 148792795, 9035221,
17466954, 49304600, 132527512, 125304762, 149258764,
21236545, 145485889, 94601070, 4856661, 123406638,
43862351, 7216220, 12353107, 27521211, 6977422,
30031553, 134097473, 133806484, 100895694, 112855234,
121017631, 109702653, 138713234, 77584309, 120259772,
102693920, 97813521, 49444607, 54140808, 140400428,
93530019, 9889144, 121641951, 46642065, 47443598,
93295605, 141448124, 78692163, 104899850, 53753632,
86329251, 88633214, 135529246, 145548448, 83847903,
110774306, 76211465, 1575586, 83873580, 35998613,
18091053, 23957250, 130584203, 56427377, 23788293,
40389686, 30632298, 84712386, 77468357, 126478489,
28272986, 23865972, 76305770, 144463393, 106619436,
108926744, 12828642, 17979043, 54917907, 145092122,
479032, 133700807, 123261071, 22483531, 35543372,
41775727, 62840096, 112020686, 102811189, 74326267,
90827452, 93860833, 144669757, 132655969, 36140439,
35207546, 74824390, 21875808, 52841047, 143530180,
146363416, 93291028, 57448261, 118740918, 69590266,
50123636, 9006901, 126329669, 131199694, 51031200,
98099197, 30103818, 90812145, 108879580, 141089229,
54281179, 133122281, 146015838, 14565233, 72359113,
103882835, 111817542, 57565209, 130841682, 66611340,
62251064, 46242960, 143268237, 16423897, 29220219,
44633290, 67836811, 63218856, 28635425, 141677601,
79342794, 106699032, 77641557, 7386861, 42444348,
41362899, 121641579, 73276597, 51840604, 54814144,
25163418, 14360434, 143283269, 82008831, 46940105,
118707830, 37011553, 141700923, 87098643, 128968031,
52367199, 131721317, 268724, 112061953, 93440447,
69601410, 149124179, 23156800, 91708756, 72132371,
114322552, 3863272, 82491770, 16146732, 107929852,
102429230, 23636098, 139687115, 112491662, 35752462,
39055481, 136571915, 109653102, 91774432, 135885698,
146462146, 95067433, 76140362, 77789513, 42339196,
3396463, 84675089, 2688837, 141221350, 97272950,
78785966, 9199341, 128841598, 938401, 133663726,
37617926, 94470667, 79359236, 73793457, 65968024,
2921906, 37141766, 2231158, 56418855, 102274694,
14128336, 80220572, 94148542, 8579107, 79697736,
101930334, 44992592, 55960689, 57993365, 124006941,
144447773, 126433286, 76618100, 36718096, 138508754,
55282073, 49845207, 87298015, 64000228, 138580164,
8236185, 101943424, 81822424, 8381128, 23939933,
47069721, 121922594, 57822448, 21032035, 60298390,
86992235, 101921031, 45754813, 64084116, 127842081,
59936383, 117608671, 87344613, 109378108, 123652968,
41161362, 92243902, 105191785, 139439617, 47957236,
126445512, 125494132, 45222624, 96244268, 103251038,
57697248, 64576863, 112222451, 134169861, 17691981,
90808845, 6896423, 136356870, 15590041, 130178851,
125042890, 47194867, 38311670, 102899478, 52765321,
77589962, 111270928, 140406917, 117625092, 54798687,
143174619, 145895556, 34023563, 72792543, 51466606,
109576100, 51075356, 11190120, 29588421, 10322126,
53090658, 56234474, 86467457, 5545549, 26517724,
35261236, 70229137, 73676077, 77727567, 131764384,
131958933, 56561042, 120260964, 113896733, 124186509,
130456246, 132801507, 141597605, 130131328, 13377489,
104844468, 13480399, 126976832, 134717516, 143215725,
93939985, 79523213, 96250246, 143861759, 71285189,
24221046, 68519644, 128576625, 48810469, 34755976,
34493542, 117552399, 9351299, 113254560, 121330599,
119111132, 104214666, 112558321, 20312246, 144116536,
148182874, 886559, 140021303, 62381740, 54417523,
35407491, 15784533, 26538000, 55185583, 59292710,
4710938, 4644298, 97903550, 30046186, 77346848,
96822463, 83454944, 65149902, 29924319, 117095255,
24258814, 91403597, 57724016, 82755208, 102075044,
128478183, 135043880, 97272338, 78084535, 28995076,
8759024, 47085229, 144192306, 121975209, 126857461,
32358183, 11985798, 83902829, 81288779, 2994562,
7316239, 38710146, 110817738, 11546331, 72991435,
44382601, 125222273, 60183120, 98312615, 68765096,
30974366, 26529763, 4007836, 31361580, 132422783,
73149062, 59683278, 85969403, 123252386, 59683150,
74463978, 35983360, 17145673, 35891505, 63468772,
32285937, 46773800, 8369468, 136519331, 39824754,
30472634, 49352295, 117695568, 147638792, 145768011,
84661110, 4729527, 21234122, 147424406, 119829476,
110442261, 66430030, 68610485, 106443427, 28952194,
118335015, 113110358, 89754717, 47145759, 32916517,
7966164, 54066992, 139702863, 93707548, 76183999,
62551906, 37214667, 74636906, 90125134, 108676350,
57544729, 132047193, 95795080, 52418610, 133736280,
140385343, 84090209, 46711535, 74376584, 93191961,
103917360, 119527074, 120504663, 122896439, 39250115,
50595179, 57517496, 90909189, 121592708, 75444264,
131717320, 88592407, 36193884, 31657583, 146568011,
80447237, 99200790, 87790991, 96073229, 68616195,
31129754, 49340577, 88516765, 149738666, 7233914,
2340693, 80347496, 27235845, 55795282, 2093918,
29814720, 45270315, 136081787, 28755958, 97956428,
70046290, 72668620, 108105084, 84788062, 55890365,
102166116, 59947890, 42185302, 58371512, 133917092,
65424515, 91062810, 72031113, 97764336, 115257340,
48704013, 75517721, 102981857, 39737057, 135729469};

void init_args(int argc, char ** av, FILE ** query, FILE ** database, FILE ** out_database, uint64_t * custom_kmer, uint64_t * dimension, uint64_t * max_differences);

int main(int argc, char ** av){
    

    //clock_t begin, end;

    uint64_t i, j;

    //query to read kmers from, database to find seeds
    FILE * query = NULL, * database = NULL, * out_database = NULL;
    uint64_t dimension = 1000; // Default 1000 * 1000
    uint64_t max_differences = 0; // Default max number of wrong hashes
    uint64_t n_hash_functions = NHASH;
    
    
    init_args(argc, av, &query, &database, &out_database, &custom_kmer, &dimension, &max_differences);


    unsigned char char_converter[91];
    char_converter[(unsigned char)'A'] = 0;
    char_converter[(unsigned char)'C'] = 1;
    char_converter[(unsigned char)'G'] = 2;
    char_converter[(unsigned char)'T'] = 3;

    
    //Variables to account for positions
    //Print info
    fprintf(stdout, "[INFO] Loading database\n");
    //Variables to read kmers
    char c = 'N'; //Char to read character
    //Current length of array and variables for the buffer
    uint64_t idx = 0, r = 0;
    
    //Vector to read in batches
    char * temp_seq_buffer = NULL;
    if ((temp_seq_buffer = calloc(READBUF, sizeof(char))) == NULL) {
        terror("Could not allocate memory for read buffer");
    }

    //Dimensional matrix
    uint64_t ** representation = (uint64_t **) calloc(dimension+1, sizeof(uint64_t *));
    if(representation == NULL) terror("Could not allocate representation");
    for(i=0; i<dimension+1; i++){
        representation[i] = (uint64_t *) calloc(dimension+1, sizeof(uint64_t));
        if(representation[i] == NULL) terror("Could not allocate second loop representation");
    }

    unsigned char curr_kmer[custom_kmer], reverse_kmer[custom_kmer];
    curr_kmer[0] = reverse_kmer[0] = '\0';
    uint64_t word_size = 0, word_size_rev = 0;

    //To hold all information related to database
    uint64_t current_len = 0;
    
    //To force reading from the buffer
    idx = READBUF + 1;

    //Store positions of kmers
    uint64_t n_pools_used = 0;
    uint64_t n_pools_used_kmer = 0;


    //Mempool_l * mp = (Mempool_l *) malloc(MAX_MEM_POOLS*sizeof(Mempool_l));
    //if(mp == NULL) terror("Could not allocate vectors for memory pools");
    Mempool_l mp[MAX_MEM_POOLS];
    init_mem_pool_llpos(&mp[n_pools_used]);

    // mempool for first level
    Mempool_l_kmer mp_kmer[MAX_MEM_POOLS];
    init_mem_pool_llpos_kmer(&mp_kmer[n_pools_used_kmer]);

    llpos * aux, * pointer;
    llpos_kmer * aux_kmer;

    //unsigned char aux_kmer[custom_kmer+1];
    
    //Vector to store query seq
    unsigned char * seq_vector_query = (unsigned char *) malloc(READBUF*sizeof(unsigned char));
    if(seq_vector_query == NULL) terror("Could not allocate memory for query vector");

    /*
    Container * ct = (Container *) calloc(1, sizeof(Container));
    if(ct == NULL) terror("Could not allocate container");
    */
    /*
    typedef struct linked_list_kmer{
        unsigned char kmer[32];
        linked_list_kmer * next;
    } llpos_kmer;

    typedef struct static_table{
        llpos_kmer * table;
    } Static_table;
    */

    // Get file length to know aproximate kmer number
    fseek(database, 0, SEEK_END);
    uint64_t m_prime = (uint64_t) ftell(database);
    rewind(database);
    //remove this 
    //m_prime = 3999971; // Closest prime to 4,000,000
    m_prime = 2000003; // CLosets prime to 2,000,000
    uint64_t used_entries = 0;

    // Create initial level hash table
    Static_table st;
    st.table = (llpos_kmer *) calloc(m_prime, sizeof(llpos_kmer));
    st.count = (uint64_t *) calloc(m_prime, sizeof(uint64_t));
    st.picked_hash = (uint64_t *) calloc(m_prime, sizeof(uint64_t));
    if(st.table == NULL || st.count == NULL || st.picked_hash == NULL) terror("Could not allocate first level table");

    

    //begin = clock();
    uint64_t c_hash;

    c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);
    while((!feof(database) || (feof(database) && idx < r))){

        if(c == '>'){
            // data_database.n_seqs++;
            // data_database.start_pos[data_database.n_seqs++] = pos_in_database;
            
            // if(pos_in_database == READBUF*n_realloc_database){ 
            //     n_realloc_database++; data_database.sequences = (unsigned char *) realloc(data_database.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
            //     if(data_database.sequences == NULL) terror("Could not reallocate temporary database");
            // }

            // if(data_database.n_seqs == INITSEQS*n_seqs_database_realloc){
            //     n_seqs_database_realloc++; data_database.start_pos =  (uint64_t *) realloc(data_database.start_pos, INITSEQS*n_seqs_database_realloc*sizeof(uint64_t));
            // }


            while(c != '\n') c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);  //Skip ID
                

            while(c != '>' && (!feof(database) || (feof(database) && idx < r))){ //Until next id
                c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);
                c = toupper(c);
                if(c == 'A' || c == 'C' || c == 'G' || c == 'T'){
                    curr_kmer[word_size] = (unsigned char) c;
                    if(word_size < custom_kmer) ++word_size;
                    ++current_len;
                    //data_database.sequencesterror("Fatal error");[pos_in_database++] = (unsigned char) c;
            
                    // if(pos_in_database == READBUF*n_realloc_database){ 
                    //     n_realloc_database++; data_database.sequences = (unsigned char *) realloc(data_database.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                    //     if(dacountta_database.sequences == NULL) terror("Could not reallocate temporary database");
                    // }


                }else{ //It can be anything (including N, Y, X ...)

                    if(c != '\n' && c != '>'){
                        word_size = 0;
                        // data_database.sequences[pos_in_database++] = (unsigned char) 'N'; //Convert to N
                        ++current_len;
                        // if(pos_in_database == READBUF*n_realloc_database){ 
                        //     n_realloc_database++; data_database.sequences = (unsigned char *) realloc(data_database.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                        // if(data_database.sequences == NULL) terror("Could not reallocate temporary database");
                        // }
                    } 
                }
                if(word_size == custom_kmer){
                    //write to hash table
                                       
		
                    c_hash = universal_hash_function(0, curr_kmer, char_converter, m_prime);
                    
                    

                    if(st.count[c_hash] == 0){
                        
                        memcpy(st.table[c_hash].kmer, curr_kmer, custom_kmer);
                        st.table[c_hash].hash = hashOfWord(curr_kmer, custom_kmer);
                        st.table[c_hash].pos = current_len;
                        st.table[c_hash].next = NULL;
                        ++used_entries;
                    }else{

                        aux_kmer = getNewLocationllpos_kmer(mp_kmer, &n_pools_used_kmer);    
                        memcpy(aux_kmer->kmer, curr_kmer, custom_kmer);
                        aux_kmer->next = st.table[c_hash].next;
                        aux_kmer->pos = current_len;
                        aux_kmer->hash = hashOfWord(curr_kmer, custom_kmer);
                        st.table[c_hash].next = aux_kmer;
                        
                    }
                    ++st.count[c_hash];
                    
                    
                    


		
		            // memcpy(aux_kmer, &curr_kmer[1], custom_kmer-1);
                    // memcpy(curr_kmer, aux_kmer, custom_kmer-1);

                    // Non overlapping
                    word_size = 0;

                    // Overlapping
                    //memmove(&curr_kmer[0], &curr_kmer[1], custom_kmer-1);
                    //--word_size;
                }
            }
            word_size = 0;
            
        }else{
            c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);    
        }
        
    }

    //end = clock();

    fprintf(stdout, "[INFO] Used entries %"PRIu64" and a size of %"PRIu64", Load Factor = %"PRIu64"%%.\n", used_entries, m_prime, (100*used_entries) / m_prime);
    fprintf(stdout, "[INFO] Starting full rehash\n");

    st.second_level = (Def_pos **) calloc(m_prime, sizeof(Def_pos *));
    if(st.second_level == NULL) terror("Could not allocate second level table");
    for(i=0; i<m_prime; i++){
        st.second_level[i] = (Def_pos *) calloc(st.count[i]*st.count[i], sizeof(Def_pos));
        if(st.second_level[i] == NULL) terror("Could not allocate second level loop");
    }

    /*
typedef struct linked_list_pos{
    uint64_t pos;
    struct linked_list_pos * next;
} llpos;

typedef struct linked_list_kmer{
    unsigned char kmer[32];
    uint64_t hash;
    struct linked_list_kmer * next;
} llpos_kmer;

typedef struct def_pos{
    uint64_t full_hash;
    llpos * next;
} Def_pos;

typedef struct static_table{
    llpos_kmer * table;
    uint64_t * count;
    uint64_t * picked_hash;
    Def_pos ** second_level;

} Static_table;

    */
    
    uint64_t unsolved = 0;
    for(i=0; i<m_prime; i++){
        uint64_t current_picked_hash = 1; 
        uint64_t computed_for_reset = 0;
        unsigned char solved_collisions = FALSE;

        
        while(current_picked_hash <= n_hash_functions && solved_collisions == FALSE){

            solved_collisions = TRUE;
            computed_for_reset = 0;            
            st.picked_hash[i] = current_picked_hash;
            if(st.count[i] > 0){
                
                aux_kmer = &st.table[i];
                while(aux_kmer != NULL){
                    c_hash = universal_hash_function(current_picked_hash, aux_kmer->kmer, char_converter, st.count[i]*st.count[i]);
                    
                    
                    if(st.second_level[i][c_hash].next == NULL){
                        // This hash in second table did not exist yet
                        st.second_level[i][c_hash].full_hash = aux_kmer->hash;
                        aux = getNewLocationllpos(mp, &n_pools_used);
                        aux->pos = aux_kmer->pos;
                        aux->next = NULL;
                        st.second_level[i][c_hash].next = aux;
                        

                    }else{
                        // It existed, check that it is the same and hence no collision
                        // If it is the last hash function, then let it happen with errors
                        if(st.second_level[i][c_hash].full_hash != aux_kmer->hash){
                            solved_collisions = FALSE;
                        }
                        if(current_picked_hash < n_hash_functions && st.second_level[i][c_hash].full_hash != aux_kmer->hash){
                            // It already exists, try next hashing function
                            reset_llpos(mp, &n_pools_used, computed_for_reset);
                            solved_collisions = FALSE;
                            computed_for_reset = 0;
                            break;
                        }else{
                            // It is all good, add it!
                            aux = getNewLocationllpos(mp, &n_pools_used);
                            aux->pos = aux_kmer->pos;
                            aux->next = st.second_level[i][c_hash].next;
                            st.second_level[i][c_hash].next = aux;
                        }

                    }
                    
                    ++computed_for_reset;
                    aux_kmer = aux_kmer->next;
                }
                
            }
            if(solved_collisions == FALSE){ /*fprintf(stdout, "Trying %"PRIu64" with hash %"PRIu64"\n", i, current_picked_hash);*/ ++current_picked_hash; }
        }

        if(solved_collisions == FALSE){ /*fprintf(stdout, "[FATAL] Could not solve collisions at %"PRIu64"\n", i); exit(-1);*/ ++unsolved; }   
    }


    fprintf(stdout, "[INFO] Full rehash completed. Unsolved = %"PRIu64", %"PRIu64"%%.\n", unsolved, (100*unsolved)/used_entries);

    exit(-1);

    // data_database.total_len = pos_in_database;

    //fprintf(stdout, "[INFO] Database loaded and of length %"PRIu64". Hash table building took %e seconds\n", data_database.total_len, (double)(end-begin)/CLOCKS_PER_SEC);
    fprintf(stdout, "[INFO] Database loaded and of length %"PRIu64".\n", current_len);
    //close database
    fclose(database);

    
    
    //begin = clock();

    

    

    
    
    
    double pixel_size_db = (double) dimension / (double) current_len;
    double ratio_db = (double) current_len / dimension;


    // Get file length
    fseek(query, 0, SEEK_END);
    uint64_t aprox_len_query = ftell(query);
    rewind(query);

    uint64_t a_hundreth = (aprox_len_query/100);
    double pixel_size_query = (double) dimension / (double) aprox_len_query;
    double ratio_query = (double) aprox_len_query / dimension;
    

    double i_r_fix = MAX(1.0, custom_kmer * pixel_size_query);
    double j_r_fix = MAX(1.0, custom_kmer * pixel_size_db);

    
    
    fprintf(stdout, "[INFO] Ratios: Q [%e] D [%e]. Lenghts: Q [%"PRIu64"] D [%"PRIu64"]\n", ratio_query, ratio_db, aprox_len_query, current_len);
    fprintf(stdout, "[INFO] Pixel size: Q [%e] D [%e].\n", pixel_size_query, pixel_size_db);


    fprintf(stdout, "[INFO] Computing absolute hit numbers.\n");


    current_len = 0;

    llpos * the_original_hit;

    //To force reading from the buffer
    idx = READBUF + 1;
    c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
    
    while((!feof(query) || (feof(query) && idx < r))){

        if(c == '>'){
            word_size = 0;
            word_size_rev = custom_kmer-1;
            



            while(c != '\n'){ c = buffered_fgetc(temp_seq_buffer, &idx, &r, query); } //Skip ID
                

            while(c != '>' && (!feof(query) || (feof(query) && idx < r))){ //Until next id
                c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);
                c = toupper(c);
                if(c == 'A' || c == 'C' || c == 'G' || c == 'T'){
                    
                    ++current_len;
                    if(current_len % a_hundreth == 0){ 
                        fprintf(stdout, "%"PRIu64"%%..", 1+100*current_len/aprox_len_query); 
                        //printf("%"PRIu64"%%..wasted: (%e) (%e)", 1+100*pos_in_query/aprox_len_query, (double)(wasted_cycles_forward)/CLOCKS_PER_SEC, (double)(wasted_cycles_reverse)/CLOCKS_PER_SEC); 
                        fflush(stdout);
                    }
                    // if(pos_in_query % 500000 == 0){
                    //     fprintf(stdout, "[INFO] Query aprox length %"PRIu64". I have done: %"PRIu64" and time= %e seconds\n", aprox_len_query, pos_in_query, (double)(clock()-begin)/CLOCKS_PER_SEC);
                    //     begin = clock();
                    // } 
                    curr_kmer[word_size] = (unsigned char) c;
                    ++word_size;

                    switch(c){
                        case ('A'): reverse_kmer[word_size_rev] = (unsigned)'T';
                        break;
                        case ('C'): reverse_kmer[word_size_rev] = (unsigned)'G';
                        break;
                        case ('G'): reverse_kmer[word_size_rev] = (unsigned)'C';
                        break;
                        case ('T'): reverse_kmer[word_size_rev] = (unsigned)'A';
                        break;
                    }
                    if(word_size_rev != 0) --word_size_rev;



                    
                    if(word_size == custom_kmer){


                        /*
                        aux = ct->table[char_converter[curr_kmer[0]]][char_converter[curr_kmer[1]]][char_converter[curr_kmer[2]]]
                        [char_converter[curr_kmer[3]]][char_converter[curr_kmer[4]]][char_converter[curr_kmer[5]]]
                        [char_converter[curr_kmer[6]]][char_converter[curr_kmer[7]]][char_converter[curr_kmer[8]]]
                        [char_converter[curr_kmer[9]]][char_converter[curr_kmer[10]]][char_converter[curr_kmer[11]]];

                        the_original_hit = aux;
                        */


                        //uint64_t hash_forward, hash_reverse;
                        //hash_forward = hashOfWord(&curr_kmer[FIXED_K], custom_kmer - FIXED_K);
                        //hash_reverse = hashOfWord(&reverse_kmer[FIXED_K], custom_kmer - FIXED_K);
                        /*
                        unsigned char hash_forward[MAX_DECOMP_HASH], hash_reverse[MAX_DECOMP_HASH];
                        decomposed_hash_of_word(&curr_kmer[0], &hash_forward[0], custom_kmer);
                        decomposed_hash_of_word(&reverse_kmer[0], &hash_reverse[0], custom_kmer);
                        */
                        

                        /*
                        uint64_t w;
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) curr_kmer[w]);
                        }
                        printf("\n");
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) reverse_kmer[w]);
                        }
                        printf("---------------\n"); getchar();
                        */
                        /*

                        while(aux != NULL){

                            if(xor_decomposed_hash(aux->decomp_hash, hash_forward, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_forward){

                                the_original_hit->hits_count++;
                                
                            }
                            aux = aux->next;
                        }

                        

                        aux = ct->table[char_converter[reverse_kmer[0]]][char_converter[reverse_kmer[1]]][char_converter[reverse_kmer[2]]]
                        [char_converter[reverse_kmer[3]]][char_converter[reverse_kmer[4]]][char_converter[reverse_kmer[5]]]
                        [char_converter[reverse_kmer[6]]][char_converter[reverse_kmer[7]]][char_converter[reverse_kmer[8]]]
                        [char_converter[reverse_kmer[9]]][char_converter[reverse_kmer[10]]][char_converter[reverse_kmer[11]]];

                        the_original_hit = aux;

                        while(aux != NULL){                          
                            

                            if(xor_decomposed_hash(aux->decomp_hash, hash_reverse, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_reverse){

                                the_original_hit->hits_count++;                            
                                
                            }
                            
                            aux = aux->next;
                        }
                        */
                        // Overlapping
                        
                        // memmove(&curr_kmer[0], &curr_kmer[1], custom_kmer-1);
                        // memmove(&reverse_kmer[1], &reverse_kmer[0], custom_kmer-1);
                        // --word_size;

                        // Non overlapping
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                    }


            
                    // if(pos_in_query == READBUF*n_realloc_database){ 
                    //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                    //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                    // }
                }else{
                    if(c != '\n' && c != '>'){
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                        ++current_len;
                        // data_query.sequences[pos_in_query++] = (unsigned char) 'N'; //Convert to N
                        // if(pos_in_query == READBUF*n_realloc_database){ 
                        //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                        //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                        // }
                    }
                }
            }
        }else{
            c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
        }
        
    }

    

    /// Out

    fprintf(stdout, "Scanning hits table.\n");

    uint64_t total_hits = 0;
    uint64_t table_size = 0;

    

    
    double average_hit = (double) total_hits / (double) table_size;

    fprintf(stdout, "[INFO] Total hit count is %"PRIu64" on a size of %"PRIu64" Avg = %e.\n", total_hits, table_size, average_hit);

    fprintf(stdout, "[INFO] Generating hits.\n");



    current_len = 0;

    //To force reading from the buffer
    idx = READBUF + 1;
    c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
    fseek(query, 0, SEEK_SET);
    
    while((!feof(query) || (feof(query) && idx < r))){

        if(c == '>'){
            word_size = 0;
            word_size_rev = custom_kmer-1;
            



            while(c != '\n'){ c = buffered_fgetc(temp_seq_buffer, &idx, &r, query); } //Skip ID
                

            while(c != '>' && (!feof(query) || (feof(query) && idx < r))){ //Until next id
                c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);
                c = toupper(c);
                if(c == 'A' || c == 'C' || c == 'G' || c == 'T'){
                    
                    ++current_len;
                    if(current_len % a_hundreth == 0){ 
                        fprintf(stdout, "%"PRIu64"%%..", 1+100*current_len/aprox_len_query); 
                        //printf("%"PRIu64"%%..wasted: (%e) (%e)", 1+100*pos_in_query/aprox_len_query, (double)(wasted_cycles_forward)/CLOCKS_PER_SEC, (double)(wasted_cycles_reverse)/CLOCKS_PER_SEC); 
                        fflush(stdout);
                    }
                    // if(pos_in_query % 500000 == 0){
                    //     fprintf(stdout, "[INFO] Query aprox length %"PRIu64". I have done: %"PRIu64" and time= %e seconds\n", aprox_len_query, pos_in_query, (double)(clock()-begin)/CLOCKS_PER_SEC);
                    //     begin = clock();
                    // } 
                    curr_kmer[word_size] = (unsigned char) c;
                    ++word_size;

                    switch(c){
                        case ('A'): reverse_kmer[word_size_rev] = (unsigned)'T';
                        break;
                        case ('C'): reverse_kmer[word_size_rev] = (unsigned)'G';
                        break;
                        case ('G'): reverse_kmer[word_size_rev] = (unsigned)'C';
                        break;
                        case ('T'): reverse_kmer[word_size_rev] = (unsigned)'A';
                        break;
                    }
                    if(word_size_rev != 0) --word_size_rev;

                    
                    if(word_size == custom_kmer){


                        
                        /*
                        aux = ct->table[char_converter[curr_kmer[0]]][char_converter[curr_kmer[1]]][char_converter[curr_kmer[2]]]
                        [char_converter[curr_kmer[3]]][char_converter[curr_kmer[4]]][char_converter[curr_kmer[5]]]
                        [char_converter[curr_kmer[6]]][char_converter[curr_kmer[7]]][char_converter[curr_kmer[8]]]
                        [char_converter[curr_kmer[9]]][char_converter[curr_kmer[10]]][char_converter[curr_kmer[11]]];

                        the_original_hit = aux;



                        //uint64_t hash_forward, hash_reverse;
                        //hash_forward = hashOfWord(&curr_kmer[FIXED_K], custom_kmer - FIXED_K);
                        //hash_reverse = hashOfWord(&reverse_kmer[FIXED_K], custom_kmer - FIXED_K);
                        unsigned char hash_forward[MAX_DECOMP_HASH], hash_reverse[MAX_DECOMP_HASH];
                        decomposed_hash_of_word(&curr_kmer[0], &hash_forward[0], custom_kmer);
                        decomposed_hash_of_word(&reverse_kmer[0], &hash_reverse[0], custom_kmer);

                        */

                        /*
                        uint64_t w;
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) curr_kmer[w]);
                        }
                        printf("\n");
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) reverse_kmer[w]);
                        }
                        printf("---------------\n"); getchar();
                        */
                        
                        /*
                        while(aux != NULL && the_original_hit->hits_count < (uint64_t)average_hit){


                            if(xor_decomposed_hash(aux->decomp_hash, hash_forward, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_forward){


                                // begin = clock();

                                // Convert scale to representation
                                uint64_t redir_db = (uint64_t) (aux->pos / (ratio_db));
                                uint64_t redir_query = (uint64_t) (current_len / (ratio_query));

                                //representation[redir_query][redir_db] = 1;

                                // long double i_r = MAX(1.0, custom_kmer * pixel_size_query);
                                // long double j_r = MAX(1.0, custom_kmer * pixel_size_db);

                                // Simple pixel paint
                                //representation[redir_query][redir_db] = 1;

                                double i_r = i_r_fix; double j_r = j_r_fix;

                                // printf("Hit is at %"PRIu64", %"PRIu64"\n", current_len, aux->pos);
                                // printf("redir : %"PRIu64" %"PRIu64"\n", redir_query, redir_db);
                                // printf("drwaing: %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db - (int64_t) j_r);
                                // getchar();

                                while((uint64_t) i_r >= 1 && (uint64_t) j_r >= 1){
                                    
                                    
                                     if((int64_t) redir_query - (int64_t) i_r > 0 && (int64_t) redir_db - (int64_t) j_r > 0){
                                         representation[(int64_t) redir_query - (int64_t) i_r][(int64_t) redir_db - (int64_t) j_r]++;
                                         //printf("\tplus at %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db - (int64_t) j_r);
                                    }else{
                                        representation[redir_query][redir_db]++;
                                        break;
                                    }
                                    
                                    i_r -= MIN(1.0, pixel_size_query);
                                    j_r -= MIN(1.0, pixel_size_db);

                                }
                                
                            }
                            aux = aux->next;
                        }




                        aux = ct->table[char_converter[reverse_kmer[0]]][char_converter[reverse_kmer[1]]][char_converter[reverse_kmer[2]]]
                        [char_converter[reverse_kmer[3]]][char_converter[reverse_kmer[4]]][char_converter[reverse_kmer[5]]]
                        [char_converter[reverse_kmer[6]]][char_converter[reverse_kmer[7]]][char_converter[reverse_kmer[8]]]
                        [char_converter[reverse_kmer[9]]][char_converter[reverse_kmer[10]]][char_converter[reverse_kmer[11]]];


                        the_original_hit = aux;

                        while(aux != NULL && the_original_hit->hits_count < (uint64_t)average_hit){                          
                            

                            if(xor_decomposed_hash(aux->decomp_hash, hash_reverse, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_reverse){
                                // printf("enter\n");
                                // // begin = clock();
                                
                                // uint64_t w;
                                // for(w=0;w<custom_kmer;w++){
                                //     printf("%c", (char) curr_kmer[w]);
                                // }
                                // printf("\n");
                                // for(w=0;w<custom_kmer;w++){
                                //     printf("%c", (char) reverse_kmer[w]);
                                // }
                                // printf("\n---------------\n"); getchar();
				//
                                

                                // Convert scale to representation
                                uint64_t redir_db = (uint64_t) ( (aux->pos) / (ratio_db));
                                uint64_t redir_query = (uint64_t) ((current_len ) / (ratio_query));
                                
                                
                                // printf("found at %"PRIu64", %"PRIu64"\n", current_len, aux->pos);
                                // printf("original paint is %"PRIu64", %"PRIu64"\n", redir_query, (uint64_t)(aux->pos / ratio_db));
                                // printf("therefore i paint at %"PRIu64", %"PRIu64"\n", redir_query, redir_db);
                                // getchar();
                                

                                //representation[redir_query][redir_db] = 1;

                                // long double i_r = MAX(1.0, custom_kmer * pixel_size_query);
                                // long double j_r = MAX(1.0, custom_kmer * pixel_size_db);
                                

                                // Simple pixel paint
                                //representation[redir_query][redir_db] = 1;

                                double i_r = i_r_fix; double j_r = j_r_fix;

                                while((uint64_t) i_r >= 1 && (uint64_t) j_r >= 1){
                                    // printf("I have %Le %Le which is %"PRIu64" %"PRIu64"\n", i_r, j_r, (uint64_t) i_r, (uint64_t) j_r);
                                    // printf("Hit is at %"PRIu64", %"PRIu64"\n", pos_in_query, aux->pos);
                                    // printf("redir : %"PRIu64" %"PRIu64"\n", redir_query, redir_db);
                                    // printf("drwaing: %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db - (int64_t) j_r);
                                    // getchar();
                                    if((int64_t) redir_query - (int64_t) i_r > 0 && (int64_t) redir_db + (int64_t) j_r < dimension){
                                         representation[(int64_t) redir_query - (int64_t) i_r][(int64_t) redir_db + (int64_t) j_r]++;
                                         //printf("\tplus at %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db + (int64_t) j_r);
                                    }else{
                                        //printf("%"PRIu64",%"PRIu64"\n", redir_query, redir_db);
                                        representation[redir_query][redir_db]++;
                                        break;
                                    }
                                    i_r -= MIN(1.0, pixel_size_query);
                                    j_r -= MIN(1.0, pixel_size_db);

                                }
                                
                                
                            }
                            
                            aux = aux->next;
                        }
                        */
                        // Overlapping
                        
                        // memmove(&curr_kmer[0], &curr_kmer[1], custom_kmer-1);
                        // memmove(&reverse_kmer[1], &reverse_kmer[0], custom_kmer-1);
                        // --word_size;

                        // Non overlapping
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                    }


            
                    // if(pos_in_query == READBUF*n_realloc_database){ 
                    //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                    //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                    // }
                }else{
                    if(c != '\n' && c != '>'){
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                        ++current_len;
                        // data_query.sequences[pos_in_query++] = (unsigned char) 'N'; //Convert to N
                        // if(pos_in_query == READBUF*n_realloc_database){ 
                        //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                        //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                        // }
                    }
                }
            }
        }else{
            c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
        }
        
    }

    //end = clock();

    
    

    //fprintf(stdout, "\n[INFO] Query length %"PRIu64". Hits completed. Took %e seconds\n", data_query.total_len, (double)(end-begin)/CLOCKS_PER_SEC);
    fprintf(stdout, "\n[INFO] Query length %"PRIu64".\n", current_len);

    //begin = clock();


    /*
    Queue * traverse = queue_head.head;
    while(traverse != NULL){
        printf("current_piece: %"PRIu64"-%"PRIu64"\n", traverse->r1, traverse->r2);
        traverse = traverse->next;
    }
    */


    //reads_per_thread = (uint64_t) (floorl((long double) data_query.n_seqs / (long double) n_threads));
    
    fprintf(stdout, "[INFO] Writing matrix\n");

    // representation[0][0] = 1;
    // representation[1][0] = 1;
    // representation[2][0] = 1;
    // representation[3][0] = 1;
    // representation[4][0] = 1;
    // representation[5][0] = 1;


    // for(i=0; i<dimension+1; i++){
    //     for(j=0; j<dimension+1; j++){
    //         fprintf(out_database, "%d ", (int) representation[i][j]);
    //     }
    //     fprintf(out_database, "\n");
    // }

    // Simple filtering
    // Print score

    // And replace 2's with 1's 
    for(i=0; i<dimension+1; i++){
        for(j=0; j<dimension; j++){
            fprintf(out_database, "%"PRIu64" ", representation[i][j]);
        }
        fprintf(out_database, "%"PRIu64"\n",  representation[i][dimension]);
    }

    

    /*
    uint64_t z;
    for(z=0; z<POOL_SIZE; z++){
        aux = mp[0].base + z;
        fprintf(stdout, "%p\n", aux);
        fflush(stdout);
    }
    */
    

    //free(ct->table);

    for(i=0;i<=n_pools_used;i++){
        free(mp[i].base);
    }
    for(i=0;i<dimension;i++){
        free(representation[i]);
    }
    free(representation);
    if(out_database != NULL) fclose(out_database);
    
    return 0;
}

void init_args(int argc, char ** av, FILE ** query, FILE ** database, FILE ** out_database, uint64_t * custom_kmer, uint64_t * dimension, uint64_t * max_differences){

    int pNum = 0;
    while(pNum < argc){
        if(strcmp(av[pNum], "--help") == 0){
            fprintf(stdout, "USAGE:\n");
            fprintf(stdout, "           CHROMEISTER -query [query] -db [database] -out [outfile]\n");
            fprintf(stdout, "OPTIONAL:\n");
            fprintf(stdout, "           -kmer       [Integer:   k>1 (default 12)]\n");
            fprintf(stdout, "           -dimension  Size of the output [Integer:   d>0 (default 1000)]\n");
            fprintf(stdout, "           -diffs      Maximum number of different 4-mers in a hit (default 0)\n");
            fprintf(stdout, "           -out        [File path]\n");
            fprintf(stdout, "           --help      Shows help for program usage\n");
            fprintf(stdout, "\n");
            fprintf(stdout, "PLEASE NOTICE: The reverse complementary is calculated for the QUERY.\n");
            exit(1);
        }
        if(strcmp(av[pNum], "-query") == 0){
            *query = fopen64(av[pNum+1], "rt");
            if(query==NULL) terror("Could not open query file");
        }
        if(strcmp(av[pNum], "-db") == 0){
            *database = fopen64(av[pNum+1], "rt");
            if(database==NULL) terror("Could not open database file");
        }
        if(strcmp(av[pNum], "-out") == 0){
            *out_database = fopen(av[pNum+1], "wt");
            if(out_database==NULL) terror("Could not open output database file");
        }
        if(strcmp(av[pNum], "-kmer") == 0){
            *custom_kmer = (uint64_t) atoi(av[pNum+1]);
            if(*custom_kmer < BYTES_IN_MER) terror("K-mer size must be larger than 4");
            if(*custom_kmer % BYTES_IN_MER != 0) terror("K-mer size must be a multiple of 4");

        }
        if(strcmp(av[pNum], "-dimension") == 0){
            *dimension = (uint64_t) atoi(av[pNum+1]);
            if(*dimension < 1) terror("Dimension must be a positive integer");
        }
        if(strcmp(av[pNum], "-diffs") == 0){
            *max_differences = (uint64_t) atoi(av[pNum+1]);
        }
        pNum++;
    }
    
    if(*query==NULL || *database==NULL || *out_database==NULL) terror("A query, database and output file is required");
}

