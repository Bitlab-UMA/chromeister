/*********

File        CHROMEISTER.c
Author      EPW <estebanpw@uma.es>
Description Computes hits and generates a dotplot

USAGE       Usage is described by calling ./CHROMEISTER --help



**********/


#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include <ctype.h>
#include <pthread.h>
#include "structs.h"
#include "alignmentFunctions.h"
#include "commonFunctions.h"

#define MAX(x, y) (((x) > (y)) ? (x) : (y))
#define MIN(x, y) (((x) <= (y)) ? (x) : (y))
#define STARTING_SEQS 1000
#define PIECE_OF_DB_REALLOC 3200000 //half a gigabyte if divided by 8 bytes
#define RANGE 2


uint64_t custom_kmer = 32; // Defined as externals in structs.h
uint64_t hash_functions[NHASH] = {148124159, 3287402, 140975709, 69027197, 48779878, 
97192170, 10698909, 22330054, 19101916, 68508708, 
12094652, 55401984, 129201491, 46350704, 139489965, 
48306861, 36542801, 108882691, 35187727, 109300273, 
46121504, 109474213, 53074111, 65678705, 141987992, 
83192727, 117802125, 52693778, 81608425, 28060500, 
72855304, 91175349, 143686875, 19571275, 140482821, 
101103503, 18764975, 42917985, 141113854, 123095821, 
16490796, 82351844, 38230326, 14066854, 17505458, 
46973472, 85363700, 135157483, 114782962, 23809679, 
121214443, 96973643, 102047185, 60397611, 15321268, 
135300699, 85137901, 88990962, 42670835, 101857122, 
124060474, 142552418, 39623458, 50245237, 75980997, 
123918879, 5525393, 43110113, 92495096, 47894324, 
145318872, 115681081, 57030545, 34661589, 136924766, 
125192172, 51061040, 92855496, 93094662, 130943041, 
2288712, 106751837, 18503140, 90510127, 110207236, 
15226264, 60089748, 12073857, 86091673, 60161497, 
14328522, 8849937, 133253281, 9033364, 144757139, 
137428857, 94455126, 68360392, 61582555, 119304121, 
99613898, 43045660, 74977965, 6334247, 143608273, 
8137301, 144917923, 66505645, 89295777, 49777768, 
145918597, 134097070, 127952877, 132270476, 89344806, 
147867736, 63075689, 109708705, 46986836, 92526560, 
142169644, 66878660, 75397162, 143705080, 42928902, 
28507547, 48523016, 144670737, 45656676, 38308879, 
2639485, 79481752, 13164568, 135893397, 52663064, 
44331328, 87446297, 18102079, 125717391, 77878121, 
87131618, 34918034, 23661658, 127883774, 69284052, 
9815703, 74746847, 80040410, 88970246, 110888419, 
63659387, 42046460, 77401368, 14122837, 145316549, 
33859398, 30935146, 28314290, 53117583, 85043284, 
47275135, 141671019, 145546796, 101272348, 81868455, 
35843267, 71037183, 12695318, 61563517, 81725039, 
58830703, 118091037, 32781926, 75042525, 13656282, 
106641334, 103648255, 120800880, 59330118, 83852411, 
61323186, 22314014, 141075411, 139540256, 116980338, 
1536764, 2094051, 1235864, 104296899, 25953131, 
126921660, 130427981, 109875255, 139652001, 129504263, 
43893565, 88844086, 62946690, 127592506, 97195402, 
86062866, 64486260, 146738510, 98603351, 68207075, 
16254730, 63414746, 76347312, 96951158, 85720570, 
57620330, 139852169, 40116562, 59857322, 40702761, 
101479551, 127593233, 145472951, 4179161, 121485653, 
38030745, 24664722, 16235166, 27170953, 31803169, 
75326968, 63567307, 117848546, 42534880, 80252169, 
59215706, 16949246, 143139409, 110997979, 8832190, 
125862591, 132985130, 140886196, 120779289, 138292775, 
43776417, 123237438, 23623036, 88839715, 123760454, 
97010978, 99156326, 147740365, 106304574, 70877595, 
14089202, 20544219, 39711820, 102838841, 23762695, 
104014886, 13867114, 50064052, 64041741, 1690591, 
62600891, 13422574, 119925544, 129496556, 3353683, 
15921362, 22660702, 35185479, 132240803, 99159684, 
1088866, 102277241, 123914825, 96872463, 77625275, 
82950684, 139229676, 17943100, 104211137, 84021572, 
81066714, 29075577, 16626605, 58286946, 105863792, 
136485618, 7817791, 136898853, 140365131, 129815390, 
10739783, 112167875, 114321578, 128067131, 88850044, 
75462536, 28594531, 73264300, 43208654, 49721821, 
122934415, 147698962, 11341932, 92448893, 138800055, 
26208922, 1710981, 21514548, 112375417, 118786653, 
90346979, 81018837, 2310303, 90360617, 24241319, 
119071455, 43235540, 120947174, 147916948, 91572980, 
74523327, 39975525, 21198770, 1635496, 130374516, 
107977143, 3775304, 114451659, 7062382, 22116674, 
25457428, 148730492, 98005661, 14848801, 83150775, 
114018473, 121434458, 58375222, 98542632, 88739764, 
26090976, 10940310, 37952526, 14455217, 51185629, 
10994840, 145820852, 12299521, 62289363, 119787092, 
62978080, 96294612, 102018156, 20805934, 131908974, 
90536283, 77446993, 7186472, 4705935, 63591854, 
102772232, 49192027, 48024724, 51357344, 35254724, 
9346089, 123222241, 42927948, 124437905, 60102719, 
130226140, 5199554, 102920531, 137999986, 84295525, 
97118709, 79455902, 138219605, 134459675, 148413011, 
77032924, 57290354, 108084207, 93325227, 43154801, 
48001626, 105317000, 54750390, 84857146, 127329820, 
37934316, 83467996, 65403339, 83901444, 56864970, 
83565356, 52920731, 29742614, 42946247, 101177848, 
79802922, 105431712, 1870326, 90950596, 119731157, 
86920306, 102218542, 129866362, 54579803, 80402024, 
94600398, 35507382, 91876681, 143356434, 116216382, 
18604292, 1252812, 91948825, 22119296, 35263477, 
139609640, 88493549, 119697379, 43079021, 35631605, 
114397090, 125746512, 55107121, 95781412, 37805197, 
36328187, 15572224, 58524641, 142375544, 7198213, 
148479388, 57762141, 135372358, 134576609, 85897009, 
145133677, 147559630, 140881048, 60061543, 76915628, 
12882549, 91908739, 144137046, 30024402, 29814128, 
26027284, 57426548, 14011889, 66617026, 41816731, 
109221032, 21989156, 140769760, 69010972, 112123622, 
81242453, 33192811, 36391869, 143714335, 65154491, 
124979800, 131465659, 61598319, 113667407, 118628949, 
35864522, 126608858, 108855456, 147798645, 138763247, 
71472236, 5624489, 131550031, 50387249, 76403585, 
67777615, 144113012, 72757508, 129662546, 32037516, 
10976703, 58049639, 24164037, 128118993, 45462428, 
2237110, 130445165, 140478077, 82374814, 106728107, 
74090464, 82733447, 95628378, 88194841, 7270730, 
52010546, 141514448, 65320916, 77090812, 56906250, 
48065492, 67250688, 72241607, 5023189, 95231134, 
117748968, 223748, 62730752, 86291716, 12494486, 
105615228, 47747946, 125024762, 132567550, 86743185, 
35447128, 11420426, 67554267, 100961934, 8603538, 
91691597, 39149755, 86810797, 124909549, 67830022, 
71566832, 74655270, 134796363, 7784019, 16194557, 
64583034, 48708587, 17606905, 61566935, 142020827, 
68793679, 143430251, 138435817, 124839704, 105556954, 
136562820, 86403508, 35216493, 124202963, 103329080, 
141543012, 63947989, 126693578, 121265646, 118800302, 
31653458, 119395716, 140205174, 99580543, 79807883, 
80331924, 125662873, 403838, 147640783, 38488091, 
60809739, 105128051, 114324153, 140418047, 17488117, 
4376455, 141762328, 81844480, 42140940, 33833137, 
108586742, 5281645, 84751356, 4653364, 55476625, 
86516124, 139052124, 106269766, 145437090, 25575626, 
108846653, 91289685, 32577369, 13037641, 65945303, 
133886681, 99674676, 33629923, 76328956, 103157821, 
89576729, 45948083, 148382941, 85915158, 30574630, 
108841796, 24319552, 123781727, 92271228, 61404438, 
84408524, 24530968, 82328127, 39010824, 36768078, 
97834092, 82836112, 69369061, 94458238, 131087157, 
66806886, 39515554, 101313221, 89133845, 30847474, 
126193990, 103119806, 19742132, 134991378, 134758826, 
89000880, 75084438, 24871082, 17177348, 15178584, 
87965838, 141625593, 108219103, 135146707, 17743601, 
13268549, 99925589, 34603304, 60204011, 113571496, 
12540457, 82747064, 140037248, 74017469, 4730203, 
134422040, 45710013, 46334353, 50112812, 142272152, 
83378489, 38177313, 44017431, 51624121, 110863487, 
87279146, 98571360, 22793935, 75908242, 54170503, 
29949806, 87997892, 103020241, 29480004, 7298442, 
98271387, 83980952, 39070980, 60127896, 133159277, 
67273143, 121831709, 100799062, 68882093, 16951296, 
65036293, 3712479, 2818508, 94986864, 47930292, 
8895335, 114216208, 132452413, 105129467, 100606338, 
77199986, 62375457, 95284592, 17534189, 80470057, 
45928314, 141805873, 116139990, 45946277, 88339286, 
143576118, 53398353, 21042259, 69883740, 114783590, 
130392537, 22850029, 6750209, 118822061, 138050963, 
48454272, 147940924, 42682317, 110475115, 106085582, 
58359613, 7782411, 15396240, 79400256, 92817570, 
74163729, 36977723, 131232313, 97254652, 142384541, 
31543725, 93594790, 78101385, 24847030, 23161137, 
10063391, 41201008, 43699925, 63093623, 56987599, 
22280939, 37108090, 84771995, 72998959, 97478488, 
13532402, 419978, 25815105, 36399047, 100825739, 
27413899, 46348614, 54512151, 67187148, 23838081, 
38980327, 20831736, 146503704, 129147074, 28408364, 
2227538, 148999250, 67281170, 144337889, 134235719, 
69427001, 137352865, 32500103, 5652917, 98990345, 
13036770, 145432615, 87400724, 16203965, 39087679, 
48488911, 34854662, 11372379, 100469295, 134966878, 
44813899, 107661344, 41407835, 47580138, 149501988, 
134444444, 36037472, 132898722, 76503606, 40687277, 
44243215, 137836298, 123322694, 51100801, 99081900, 
81192217, 47037882, 6691040, 44028619, 108734278, 
74246725, 139655913, 51057266, 143006499, 63174830, 
107817528, 22703351, 142300956, 43877057, 145831477, 
53608089, 7707479, 63493508, 40402357, 126689950, 
147540259, 63610097, 138705860, 127166658, 78793046, 
104176802, 117201412, 73418213, 53160671, 149011497, 
77758636, 66583323, 116960595, 110520213, 98431564, 
138014344, 146051308, 36840270, 21321642, 59162694, 
46197518, 73489973, 18140994, 112241798, 20612119, 
63381480, 20855293, 139243054, 68139750, 67140090, 
91624372, 76102502, 17650007, 113489136, 105111632, 
3104158, 107795169, 141417650, 135024544, 97734807, 
93076417, 109168331, 116228942, 89621224, 66292634, 
55514477, 70352294, 44097529, 114267470, 134116449, 
120109272, 114366091, 54661906, 101335264, 111835657, 
97145129, 11020349, 79034477, 78581304, 123003500, 
109494079, 23255622, 97653523, 52861423, 112843550, 
40833987, 145325307, 80940701, 78508653, 64447237, 
97664860, 127979421, 55379587, 147174654, 103430895, 
86942984, 31422552, 50225968, 128206752, 92991232, 
10411529, 108155700, 17255691, 110014198, 118722224, 
119606184, 143192444, 63952146, 145545459, 56515762, 
65613934, 135057163, 90097615, 21417096, 367860, 
73327724, 6634642, 32588610, 100406783, 48652090, 
44942169, 77234342, 53277898, 2865748, 25854077, 
8316407, 65695221, 74291789, 63179808, 107484553, 
5201237, 78894077, 132684677, 106750806, 16748157, 
102426200, 66408946, 2973992, 65189680, 135803599, 
148911500, 73310321, 47446758, 55022676, 4075127, 
69648461, 2360151, 136931570, 127267628, 60073870, 
69444612, 80242968, 98108303, 84946466, 21843952, 
82438733, 32489778, 98317718, 67581322, 12308661, 
10176950, 37680928, 63069488, 89364674, 97319993, 
8289689, 19968150, 31275104, 142706643, 77626945, 
69163663, 70082661, 85735273, 48620021, 23857278, 
69749883, 78240862, 114062409, 120558957, 96305301, 
108814302, 32447638, 39816876, 58785649, 123462431, 
97341261, 131267310, 48536091, 94255318, 91262777, 
32937495, 124533851, 52016918, 78520598, 19614071, 
39306553, 96677867, 64311384, 1214189, 120445546, 
90956891, 64063527, 65141287, 117426767, 117277533, 
38735453, 73803183, 60518130, 126278193, 101659614, 
88153037, 92854608, 66058439, 91865680, 112775538, 
100422591, 88478563, 48947484, 3628013, 59796651, 
106755805, 133696435, 90314090, 17165606, 75346462, 
50807277, 116909709, 148960520, 14314446, 107684121, 
144867999, 78894472, 90833689, 45535260, 145196035, 
71989835, 9653313, 82923993, 18774824, 28282204, 
106741466, 127706447, 147573726, 122060235, 103633802, 
60002936, 61501834, 51019113, 47722745, 92186753, 
148196901, 109666852, 118663559, 136471727, 19787808, 
50946546, 129803365, 124185150, 52003384, 1681745, 
16966653, 43322139, 97227806, 55712947, 38182071, 
81317830, 62619768, 95106123, 14272661, 126781783, 
30354699, 20177474, 122594263, 137309828, 25665162, 
140197145, 50824828, 29625863, 130978194, 30934916, 
7504634, 125172024, 49161960, 136498761, 2572125, 
37671786, 22329764, 16177701, 6968154, 103372031, 
108752501, 8231760, 63150869, 101594142, 39320469, 
53344595, 145717402, 44865480, 75127984, 95210070, 
87871835, 103289382, 64573805, 24928617, 35484346, 
217996, 16627293, 67274949, 67314722, 70589655, 
4335330, 2636069, 31043298, 11612196, 7307075, 
45358180, 43122576, 25406672, 65163769, 57059717, 
139925072, 128081800, 83530129, 63132104, 138841758, 
67669017, 26597191, 43060703, 12268218, 86216539, 
116031631, 120060173, 34793831, 132049642, 24294046, 
132560642, 148967655, 100978980, 61419884, 84395916, 
65760963, 74237196, 29950252, 58382317, 52869192, 
80734757, 102399246, 141392809, 6657282, 89267078, 
26917480, 123368834, 121037473, 26034392, 89113307, 
139840096, 42887439, 1770254, 13966240, 137263938, 
55283496, 119488815, 45660857, 133190639, 125334365, 
119050698, 109227545, 147320221, 27320673, 121300366, 
139690440, 117311727, 72738745, 7647620, 111229417, 
116388589, 5041008, 54007479, 112725425, 147088909, 
16661614, 135632246, 129871902, 95025076, 140356592, 
49857202, 30148184, 142365387, 63561534, 100269735, 
131907739, 75844019, 10492170, 78377872, 85437179, 
149775138, 46150995, 41912177, 139460770, 11641487, 
43387596, 78808142, 23688684, 63248806, 100529631, 
16847079, 146199208, 26120274, 133799107, 120304852, 
30910471, 71312224, 147768663, 16437960, 21130085, 
56422722, 95977312, 8495396, 40922084, 60645159, 
43216988, 49822260, 109712816, 26178464, 56579668, 
141088507, 40702025, 32097301, 53435121, 5085462, 
9439174, 28355149, 53875950, 98601278, 132024644, 
117439309, 131133772, 33080260, 35896319, 105654232, 
35266365, 109433139, 146590385, 48197605, 8464859, 
67753739, 53510386, 104100682, 38014927, 41204702, 
107641501, 37502843, 20003644, 2287220, 82442778, 
9908089, 10385889, 62132746, 100641617, 39899250, 
26926977, 3103819, 97341133, 29673415, 130872449, 
14170033, 63183529, 111227075, 92115326, 6907935, 
97491891, 144143337, 111840589, 141514875, 27857001, 
103518745, 85168289, 39489343, 52697025, 74482912, 
19048507, 5999918, 702728, 24825190, 90221845, 
60016285, 109726006, 30499263, 117585062, 119717841, 
137757650, 115541561, 78093980, 887433, 124607732, 
36690979, 109739652, 136295281, 92444075, 11756304, 
76227121, 134610231, 5161739, 149647635, 144437319, 
112763564, 25224167, 58869413, 122110848, 63437653, 
107904018, 29029425, 36353811, 56726421, 140758038, 
87330462, 8753488, 62631396, 121702742, 141101061, 
136602201, 86603086, 87154102, 135316346, 55138527, 
16599997, 11880757, 40749965, 73908817, 72281769, 
137847710, 100177016, 63834918, 47177411, 71168405, 
64627301, 120631341, 25631790, 144548893, 145507740, 
33992141, 75771135, 46276578, 125977460, 137796894, 
68023421, 33736171, 8318633, 48420581, 67357752, 
37262592, 71397424, 88637855, 114307637, 52075983, 
105015524, 81414091, 15195745, 34176639, 120434752, 
72518249, 72420695, 14067, 20701702, 59983065, 
119047217, 7648321, 133018253, 107488793, 73753939, 
64647233, 77896993, 65548701, 130945987, 54398226, 
108660979, 110588803, 84022645, 147637518, 97216638, 
74556943, 84114193, 144497424, 10223746, 45833904, 
24823984, 12580489, 135432185, 19078557, 124414227, 
116437202, 114161159, 141995568, 121091437, 58887552, 
70880301, 30238054, 13533743, 87926671, 15304263, 
44339570, 149314956, 73607085, 108670798, 132240273, 
82142327, 87916646, 135972214, 149273274, 131564002, 
3254615, 128943797, 20940378, 79514636, 79738492, 
65223426, 73182393, 24059576, 131266044, 46354631, 
82798582, 130286541, 21247147, 67384524, 72872734, 
108739583, 131559136, 79502444, 136993641, 22909441, 
68886127, 68585233, 30769686, 138108858, 35596714, 
143894511, 60617432, 92771117, 77514723, 44345360, 
62286569, 90807210, 74303235, 26767649, 124341309, 
117489779, 138013061, 78157294, 10796097, 96500926, 
68734461, 91518853, 141806009, 6144421, 20375246, 
90821329, 81356565, 51198070, 104967249, 94995203, 
16872136, 21979235, 149372119, 45023831, 107549202, 
54229142, 147070311, 25851531, 141861570, 9375350, 
120499213, 140204567, 5907260, 12878545, 127684130, 
22761255, 91864826, 11142828, 66163482, 137747638, 
116541714, 92211375, 16625881, 34273672, 124763146, 
106382409, 129241521, 59880119, 68552459, 14841630, 
59616258, 5463739, 84430217, 19937535, 104047094, 
68672513, 49470548, 53558577, 140671694, 44872527, 
7178796, 48616894, 122837242, 110030826, 50096473, 
125985037, 114467615, 138710415, 86293256, 54622675, 
147717119, 120114081, 40665077, 119768825, 77337625, 
128234256, 33635335, 53915967, 119348212, 75047492, 
78572000, 113787279, 57710348, 56576659, 28564179, 
6296619, 82823414, 139543076, 6232218, 81444618, 
141965178, 103500936, 143016666, 95404316, 140200522, 
2299039, 31419607, 89165784, 149989289, 4205147, 
78548572, 35886156, 12137386, 86746178, 117277512, 
27918714, 91405337, 44342230, 59782766, 40693709, 
107434482, 102803574, 20564766, 113479011, 35116139, 
128041678, 62092057, 77397202, 56727398, 14537323, 
121153211, 53957731, 108313293, 2411825, 128272069, 
446929, 116141841, 7042965, 66843947, 84735208, 
130558472, 86111690, 74346618, 71284301, 112780355, 
24165095, 115889850, 88008816, 64424217, 135838340, 
31915682, 89143149, 93073621, 81757157, 90993173, 
52320882, 111618381, 57793884, 6361733, 45831116, 
76118883, 117355921, 33462980, 51095718, 11336961, 
108303733, 40182766, 146125142, 34646236, 49933346, 
134627050, 56401932, 146102478, 121662289, 102755743, 
114352184, 76503700, 55123181, 79041144, 136003885, 
103589047, 27590231, 61163665, 2073555, 58458515, 
41582156, 6130827, 136383892, 74562134, 31827960, 
7355734, 12471526, 113245529, 89831105, 35543587, 
68666248, 124511816, 84594050, 125816182, 111951650, 
135369251, 64691729, 11810429, 53691352, 53085681, 
90340435, 51570782, 57279986, 99620225, 53866423, 
67910134, 131988654, 95105064, 103694964, 77560549, 
140102921, 80010397, 3815819, 67267171, 103773965, 
78217755, 89370059, 148867441, 29653989, 127740620, 
72853512, 118752233, 44833709, 115555612, 63303968, 
21192953, 45858705, 135013402, 62568305, 34927849, 
76887434, 118114879, 10157640, 81007194, 149763325, 
97112206, 23456187, 28724160, 60919390, 61707125, 
138650584, 124573557, 104027593, 81833561, 37945472, 
1038595, 50497113, 41582165, 27251187, 120803652, 
69228337, 43719383, 44504990, 105722874, 29468934, 
142471795, 88323640, 10555430, 142242643, 65718882, 
33737456, 31389140, 73872569, 11959904, 143372547, 
8111288, 94080350, 51631307, 96335825, 40311375, 
85259285, 114658602, 26030106, 138295626, 68628380, 
135409613, 12304529, 47913325, 43889184, 103892382, 
59216223, 119045428, 49685287, 119892333, 131773479, 
148501101, 120322833, 137713096, 102286481, 58085016, 
38031999, 120527224, 138428169, 20801561, 24377479, 
100539108, 37722055, 33116359, 72494906, 70370762, 
128920513, 72959400, 111972376, 77452670, 2477574, 
94452223, 8037511, 140368792, 92963304, 114455750, 
92512119, 100480071, 11524762, 63438110, 67990490, 
68358330, 53172930, 31276796, 146224559, 33278488, 
581965, 65829241, 37520036, 127721429, 82567295, 
37807159, 10448430, 147449391, 132371261, 31244531, 
113748044, 7018799, 144759642, 14008903, 41339239, 
130037334, 145803194, 29409213, 91804456, 33203130, 
108861599, 122940467, 144148940, 114134180, 77859814, 
97574825, 134036874, 1402598, 104148509, 66474971, 
118571475, 140282975, 76569801, 1957264, 9021788, 
142964892, 80221106, 46079424, 38378868, 11407722, 
63937015, 138065318, 103606791, 80093827, 21233743, 
126824410, 12993433, 13957465, 74036498, 135174938, 
113147293, 112877505, 103711235, 101892202, 36301545, 
109616870, 54730654, 55488890, 31715826, 45219346, 
72725238, 96165011, 85840298, 47407347, 28890559, 
47073872, 6122672, 12634785, 22536320, 40771093, 
58821229, 71353158, 73675080, 47159816, 115883301, 
101746963, 111709589, 135529423, 52489376, 129624818, 
103598801, 96789233, 129890614, 99344280, 7067369, 
68375544, 120487884, 3762228, 10646381, 98977402, 
112735200, 148239468, 2772581, 56524382, 90446769, 
8866387, 76258356, 21582070, 66004390, 24526770, 
149711350, 21908600, 6574401, 83740878, 15900019, 
13995099, 56769629, 76049126, 51137511, 25894981, 
24754719, 85169588, 31187188, 68487513, 69076870, 
74782596, 1892908, 76797055, 25744418, 149399406, 
116633638, 15910502, 92056299, 51739491, 133641170, 
113606044, 30570356, 47841704, 72170165, 84675772, 
11457378, 37282960, 36314246, 127085633, 57474396, 
87809024, 118136288, 114632271, 96461968, 68350058, 
28674095, 7981221, 127378058, 29803749, 115125603, 
52970130, 51435204, 36756043, 59670779, 119698172, 
5062384, 25028816, 74378864, 138646587, 103637460, 
134827526, 48473253, 26695194, 147595911, 100545045, 
73844993, 113087539, 26449553, 13343819, 130549201, 
108982636, 75690864, 97812834, 130005201, 31447933, 
1745965, 132963499, 121597236, 18143519, 84016711, 
30310736, 102064237, 88557060, 70557394, 12625588, 
100229815, 56368172, 14446508, 113429583, 71394528, 
60770810, 57660428, 94715901, 24008645, 14804849, 
40074258, 85616242, 54850073, 143956549, 79724357, 
107002222, 34359741, 97697444, 48749377, 103194753, 
137964901, 71925063, 56434901, 2850423, 108089858, 
22934065, 93065014, 49613252, 8009013, 107776905, 
76912226, 5913424, 66182863, 136322725, 140907948, 
87162186, 115568769, 94981668, 74146348, 118114851, 
10642471, 71358576, 80003455, 130749401, 30944991, 
127468077, 403953, 65699012, 64953439, 15348399, 
127000468, 104412824, 128446616, 132467363, 138697062, 
68708764, 85354497, 55586185, 35443860, 25985600, 
78650482, 16470994, 31928716, 62968762, 18570586, 
114687798, 80627226, 24767800, 116482167, 2589833, 
48211452, 85668298, 38632854, 72768209, 38671466, 
76336159, 125621240, 116847284, 147132578, 52163313, 
16687437, 4833498, 81347356, 62806165, 132871352, 
64418995, 42909785, 102199112, 66075015, 38406626, 
107335508, 132570097, 30388680, 146097564, 78096581, 
108485778, 145843171, 37925615, 128221154, 67539220, 
92673096, 149947674, 87738902, 8591441, 7023178, 
71725007, 137969375, 95828121, 79258495, 81276585, 
125186784, 63246242, 50781037, 40844239, 48981566, 
91945924, 65668861, 30308579, 76454453, 102955189, 
37222256, 109996241, 129475797, 74836991, 21899832, 
105932424, 69954805, 50525394, 73016300, 40215655, 
94988593, 5368860, 35860547, 100243097, 100436245, 
11086055, 26884858, 23597789, 102838838, 63841648, 
5492462, 2840908, 41089448, 10082942, 90390488, 
106015035, 142370348, 83945712, 71604858, 61530608, 
66053288, 39296064, 100234286, 22099143, 86699472, 
142537871, 90726429, 146522780, 46218760, 49496342, 
101941745, 4691772, 60064071, 96726187, 67483028, 
36738028, 96292852, 112667257, 676967, 42412437, 
120674272, 42868539, 28645396, 99369453, 89876374, 
28166675, 141354945, 41914224, 93594277, 26680448, 
62194976, 36224231, 20736320, 63363284, 8572413, 
21838742, 134488059, 33666406, 132605566, 107989359, 
90981123, 7127459, 110171311, 64915029, 111700855, 
23019589, 62415422, 112265862, 33580783, 20957037, 
70014350, 35955642, 40350005, 18970265, 50268199, 
112064933, 140269730, 65240041, 2657769, 65772043, 
68362209, 11292002, 138351594, 135048175, 82780241, 
48942545, 22028809, 36413696, 31869992, 97130852, 
23800514, 114860804, 148255005, 92454667, 139291247, 
1132109, 8408160, 125985189, 25622851, 87037254, 
123556809, 13008975, 23880823, 73446816, 94763505, 
4460434, 51818639, 21359962, 72928699, 125212169, 
36794864, 71313655, 50215759, 137782340, 77538182, 
91338506, 74620769, 120852397, 31612421, 42153143, 
127873013, 91451927, 74907565, 70892661, 24855517, 
15870437, 115084255, 176372, 74168982, 8197764, 
2648648, 24022776, 59015411, 57227826, 104753755, 
96826826, 55064428, 60994145, 102832764, 116649748, 
135268800, 41849741, 4382874, 81398759, 97106878, 
19280883, 93375527, 126455986, 147203681, 72468481, 
80315875, 83472576, 110848966, 47280001, 141246953, 
132542297, 71954500, 145901088, 70383508, 26418010, 
34411385, 20014596, 114866329, 90924871, 57944660, 
30511162, 130894588, 141479876, 102973630, 100688126, 
68448383, 57037360, 143960523, 107415361, 110811003, 
53478784, 37611306, 128511504, 68298154, 90793254, 
130274105, 1613590, 8851435, 69486398, 73175706, 
42653725, 117353162, 94807948, 39038197, 134379844, 
135749805, 28309462, 64595716, 19393626, 137541149, 
49491753, 127983004, 49568243, 40976746, 145441145, 
37036324, 18490283, 31686286, 129356076, 138803215, 
12677955, 77776359, 146621207, 105661666, 69520730, 
133953668, 114600168, 127342614, 103142653, 133578236, 
72366143, 133752138, 77426227, 141309812, 16804370, 
11277180, 67698348, 110405128, 109967110, 126629935, 
13764061, 68948962, 72775521, 55491151, 21249593, 
115824817, 118483483, 124701724, 57996676, 129516778, 
124030480, 118715044, 79978415, 143441233, 15317925, 
122077411, 50803893, 143500924, 121359070, 44302644, 
96274500, 52451053, 31867612, 138373348, 3910107, 
25292107, 70636039, 92030735, 29276621, 84611194, 
117006660, 22243307, 28495662, 85863464, 96909609, 
54632712, 140830520, 12677953, 40166744, 102516021, 
146990337, 83332647, 57368020, 19958695, 67105881, 
113139884, 13388242, 114968570, 47270850, 119146681, 
8927498, 71872580, 27970112, 43408399, 38463502, 
126185221, 144051956, 94248607, 50123187, 95660465, 
95002820, 19208590, 143943909, 98740884, 48398097, 
29004358, 112905864, 57442481, 54020173, 91859907, 
120364205, 69151964, 63705268, 84082541, 137614508, 
131487416, 13722282, 109894819, 15893334, 116523932, 
106640551, 121750604, 118212074, 15008332, 100617685, 
125007594, 93152687, 96566312, 67643986, 105659943, 
146012202, 15058580, 108145916, 46970966, 46021155, 
81605009, 53296003, 27981884, 139340734, 115576404, 
117190300, 28291741, 5435518, 20479945, 67753319, 
61564059, 99495213, 68059139, 55843655, 147520271, 
73744020, 84760412, 20401791, 54407927, 29765640, 
56392485, 2765224, 81587650, 46659271, 51969419, 
101123628, 132289916, 90903579, 147070717, 77602928, 
142816892, 64462580, 20358155, 49527216, 24522553, 
140369364, 138542168, 10662641, 86699413, 138181144, 
119978744, 40718819, 98560121, 120419742, 7389210, 
123157501, 40201978, 101678865, 52995980, 61299102, 
94894200, 36241899, 78866096, 74373403, 120535255, 
62523318, 126668122, 71906042, 120975514, 72348415, 
52383576, 80575453, 48211150, 116509130, 56584365, 
8137131, 142073793, 36654030, 127870200, 52707319, 
51669704, 123699539, 59850294, 88874867, 75073590, 
104323898, 103468379, 37651328, 93156102, 110595476, 
20686430, 119515009, 148266450, 128561386, 102109680, 
7806598, 144944174, 81830011, 27850486, 52482142, 
36356907, 55738382, 5411169, 13569376, 3282434, 
45464458, 77950161, 141751036, 34322588, 78514565, 
41692236, 64263895, 65982715, 119300912, 79759346, 
103972879, 111257055, 53215929, 11852887, 135437546, 
56594978, 91187648, 148952443, 74674287, 60924219, 
99172359, 134502290, 31542147, 3091896, 32577382, 
91100319, 21928521, 62685922, 104029489, 38036926, 
105594855, 60124101, 44398530, 105962303, 139460636, 
26198362, 51507220, 75567606, 124911310, 73635524, 
77908506, 16696065, 71434535, 122623112, 143515627, 
26159363, 147992814, 106693826, 66976577, 130645847, 
149502641, 39953214, 106795911, 96465294, 86916298, 
94525775, 7194906, 54529321, 55973247, 31174562, 
19257318, 128314462, 71685109, 99415984, 117147248, 
104137032, 7513791, 50793978, 109994727, 13638790, 
133328520, 92461708, 49031835, 29009587, 132902622, 
88752769, 59470025, 85658503, 1084491, 22304738, 
142764695, 39566506, 13508124, 65351386, 116355933, 
64054540, 30501230, 94337354, 137645988, 5751376, 
55897855, 57220898, 71666805, 108344578, 116731209, 
81128221, 57690102, 12431204, 7685443, 74080846, 
60943746, 135108510, 25595604, 22746143, 30003913, 
103273369, 87865716, 61101452, 10260607, 149610272, 
142360001, 98407123, 21748126, 47015795, 131005551, 
76138672, 66576208, 11332760, 39311913, 116291484, 
60637309, 82124770, 121091319, 75992056, 91037480, 
4599686, 90161263, 19033524, 77152479, 56643497, 
104856754, 27801442, 73444119, 45058847, 122390290, 
6935112, 54288163, 11688530, 111171432, 61171938, 
89333069, 144701986, 115862981, 97422435, 52832158, 
3647473, 132819572, 25299086, 74820581, 149177083, 
130582022, 79850840, 110213498, 123271425, 140102735, 
28984472, 2722716, 6580686, 49764711, 108393796, 
106294626, 111219971, 10700688, 55500951, 92665764, 
44549632, 80412497, 104576372, 61443386, 6124660, 
7098154, 34369516, 22415453, 89777692, 129030656, 
146074570, 135683219, 101066101, 38704425, 79434065, 
74927900, 98980705, 68692030, 86141537, 76557320, 
85961200, 47255018, 109490355, 66813671, 80630043, 
113152362, 142368437, 51541006, 80149626, 5608009, 
90127683, 28924763, 68290082, 19170141, 12395542, 
90525092, 144278499, 123248211, 49154345, 143323566, 
14689453, 95330609, 11093047, 22652512, 88503779, 
36814629, 146527058, 42136277, 31940123, 99741704, 
53819266, 86307054, 4913654, 58147969, 51457211, 
23431976, 47564859, 116375370, 88287833, 24679772, 
92185033, 121085246, 72352920, 38814901, 137642356, 
115264661, 146572620, 55697580, 15078340, 105106596, 
129438891, 39231427, 45398524, 142535441, 111072771, 
7857298, 6146065, 145123941, 149792292, 40388548, 
66027455, 78595390, 98025079, 33085159, 33383560, 
133000676, 403754, 136827646, 82144304, 96536332, 
80632227, 106420283, 145208569, 21086067, 14858630, 
100001028, 131526836, 101248919, 38670101, 126988025, 
106030832, 110158996, 36620739, 56754883, 27755868, 
148467911, 5225576, 103669980, 94474104, 17715772, 
93608358, 43993531, 47936881, 28419754, 101312153, 
35681626, 105124629, 83912217, 45010290, 104390468, 
100250371, 12197762, 67702428, 137750100, 63659810, 
103441190, 8307837, 29069765, 127280339, 142214987, 
136312882, 101499862, 126646940, 103116619, 6701342, 
95651714, 46725260, 80437377, 107741698, 89163043, 
91043455, 28755604, 47581724, 65383904, 6785384, 
46631870, 62299783, 4174984, 32540242, 145448758, 
73653021, 24245453, 78553005, 56353152, 66301825, 
31189936, 47541083, 62162503, 18949602, 53394958, 
87139183, 25088463, 43460808, 106324432, 44311317, 
36079543, 8234307, 111848303, 92188333, 61413668, 
25697203, 89948167, 52123597, 45758497, 22543303, 
102758391, 139187020, 73964974, 71185859, 143012828, 
39471324, 99382680, 19425635, 32469021, 10796590, 
103609317, 31577802, 68321763, 94131620, 1289873, 
106124191, 85323619, 94841614, 28017710, 141893587, 
84917646, 146907174, 104836665, 124624506, 59306175, 
58290847, 17791835, 23106681, 69298452, 131996905, 
5135189, 113761251, 146550001, 133957526, 17761657, 
90308725, 73608480, 105919122, 86936761, 3536201, 
72052895, 146621658, 12579079, 89893762, 74474597, 
43026635, 118611428, 148722695, 145403703, 73376611, 
122335305, 1746954, 6637842, 123243851, 67815530, 
16961973, 36419198, 32090732, 148307832, 145983998, 
119568356, 109790268, 109724526, 40726144, 31815214, 
76406661, 80348736, 7816413, 86739575, 120201180, 
19615897, 120780696, 51575950, 20562429, 91008220, 
74920603, 66330213, 6116662, 75700425, 134219146, 
63095460, 80989954, 31462475, 135186020, 119313428, 
75755643, 11674025, 11686816, 143534570, 62583099, 
2099101, 127650911, 79674522, 58870864, 90094185, 
82058602, 131256766, 4964275, 47222814, 11227752, 
149390507, 75357836, 102005061, 137272697, 137675926, 
148624123, 94635342, 7060210, 127499281, 148593483, 
50580635, 41860474, 9851514, 1834819, 40591312, 
55556048, 57895207, 19184720, 42082622, 126046046, 
107898114, 52447886, 57377962, 112236205, 140731361, 
114429699, 3915442, 80346886, 8630831, 144063162, 
148018200, 42115941, 2902262, 91654154, 113896969, 
502892, 125549959, 13371877, 126726093, 20142772, 
100073003, 31654836, 7204372, 30134052, 77504433, 
97581057, 52990462, 33140620, 126139450, 129268609, 
10893105, 23586465, 13373471, 106063755, 138714607, 
45188887, 22509636, 97817895, 148690221, 96350892, 
71154984, 53846643, 24111681, 120593940, 149433503, 
54961252, 14064663, 100170582, 25263650, 37855899, 
77625550, 144736217, 69992981, 113461956, 72630177, 
85533983, 46539257, 57577791, 23812708, 21488305, 
144985001, 145976871, 59725386, 64649249, 10684995, 
110573612, 148784440, 77059017, 146829477, 80299448, 
131410797, 29717789, 80675205, 64397084, 14631554, 
17184120, 59387709, 45135997, 77411947, 131204417, 
36939106, 143947278, 138378729, 63764560, 120169489, 
283538, 46942467, 500357, 69941796, 100925670, 
48792101, 136772912, 74075673, 96089057, 124123054, 
1621707, 99690475, 19618247, 112202556, 117524444, 
138451483, 106354523, 36929976, 105020906, 74522757, 
126325931, 107672852, 90922085, 140919929, 55925575, 
36529116, 5030318, 46457802, 115258600, 88128204, 
55511581, 21873351, 47304939, 133668862, 139861344, 
21976548, 62061398, 121576430, 75936244, 28082834, 
125400252, 26121612, 78177713, 140943243, 77481043, 
8260948, 149968659, 123366087, 48483857, 132470340, 
104426490, 21757519, 92591783, 11916373, 133527749, 
9139590, 69211715, 39284452, 15471952, 108730133, 
147633564, 149034989, 76699430, 56520063, 57993739, 
31392067, 119818456, 6544971, 5050880, 103070995, 
14032858, 61581060, 30736369, 44859586, 138891553, 
55425263, 146149245, 101970058, 110078034, 62339369, 
97002953, 3707509, 122565924, 135667010, 111237749, 
42831539, 132467805, 20413456, 146163769, 135016922, 
51351843, 36135150, 10009830, 37484542, 95512400, 
37720453, 75898069, 8971447, 39820748, 51754865, 
126366700, 119019731, 82841392, 44385862, 129995888, 
8876732, 68942463, 94389414, 64560547, 1047259, 
24103777, 72706268, 62647686, 95141295, 40543823, 
50577666, 147781305, 132109260, 9196738, 98750719, 
120141948, 25279132, 82568187, 41201314, 71572946, 
67400540, 135896067, 82399486, 81755649, 55053092, 
32074144, 143634122, 33271257, 119345568, 145691401, 
129163479, 81220364, 14316321, 7993980, 63271324, 
117161623, 79195107, 112455556, 82170282, 117947640, 
114642581, 28668549, 33503457, 87411930, 49819878, 
58963644, 71577552, 96885770, 40866397, 128621928, 
57053681, 15423779, 121000674, 144326412, 60982162, 
78170192, 87097947, 8517256, 118454055, 71382327, 
107575107, 81620910, 139436461, 17799232, 41985160, 
53279974, 149913729, 21025211, 105953854, 84020230, 
88840042, 74112394, 46096639, 30186610, 38366122, 
51488739, 127144498, 44142673, 70051508, 75246124, 
41674671, 112234145, 42273247, 28200380, 65833064, 
88833137, 139661085, 22857954, 132112816, 97622637, 
101447407, 138653789, 6409997, 2915896, 43882848, 
72233785, 9410097, 53612315, 139548010, 29879745, 
77471358, 68102162, 37035108, 61036756, 67692452, 
63099700, 106123933, 84722516, 72131709, 104922899, 
144751832, 95650927, 127401958, 66353061, 25155177, 
102151117, 70280838, 25446322, 65531022, 12727508, 
24824133, 9155513, 50694874, 133874998, 94511317, 
27776543, 134879348, 46802204, 25994908, 35814321, 
75371645, 83283686, 123105855, 16214853, 130818155, 
68145334, 68821320, 69000359, 36526162, 32623053, 
38307423, 76004147, 148810404, 106963884, 138956814, 
122154213, 8662059, 100607393, 126800689, 26810917, 
2127609, 112345057, 105230760, 119984608, 12598576, 
91352481, 52437329, 98788133, 23815118, 60111715, 
131409695, 132571316, 116136667, 113895431, 87106418, 
66053388, 147767059, 135397854, 13856565, 85149339, 
138543937, 101023469, 149875065, 143636020, 75741619, 
123133083, 85369414, 84136976, 24833466, 128878874, 
113879426, 145872167, 127469472, 138377748, 140581264, 
98459000, 133361223, 90497883, 19295707, 42970429, 
37232813, 126742420, 40626756, 49614568, 132359429, 
18518003, 100707178, 126407472, 13186746, 124392966, 
143686059, 111150629, 119472319, 16126748, 49694157, 
13762951, 60933560, 14917675, 114696601, 27794959, 
72992110, 69975983, 28579383, 32474431, 93529240, 
112936716, 59995930, 135953470, 38216663, 145327964, 
90597332, 74459502, 131811988, 69500630, 24382254, 
116360260, 125802667, 116235082, 147399558, 91175571, 
70954220, 60829254, 67498819, 7546020, 95620939, 
35241800, 146552666, 43047169, 112188272, 60098443, 
115806344, 41820076, 101904566, 96577648, 111920230, 
79181224, 48122587, 88406697, 1521274, 66132671, 
76198912, 7833694, 17294308, 98053309, 24209504, 
122335160, 92111019, 36272203, 83408932, 74111107, 
69147288, 140943828, 104189599, 72990327, 137131109, 
3693545, 30814010, 70794597, 17644163, 48466438, 
66933091, 123213584, 135811523, 102418236, 95512021, 
129840897, 96534613, 68305879, 46349348, 134124914, 
102978039, 27319308, 144035119, 124447541, 21476275, 
28250659, 50516106, 56002634, 32533853, 68221649, 
59988020, 119463054, 136302428, 86782492, 16593735, 
7950540, 82491438, 23427015, 22937952, 80648949, 
104352909, 101740746, 56884562, 136725725, 25884793, 
113334992, 62663504, 138461845, 149855171, 13756603, 
80629708, 74398921, 66840548, 148952802, 3735517, 
110409971, 37138321, 102781641, 66429305, 15587138, 
149378963, 134736641, 126447243, 131265649, 131100858, 
75373104, 77102128, 55698275, 11589690, 31076067, 
127380223, 102856928, 122192253, 93782267, 84602257, 
149232499, 107015012, 26123594, 139851601, 51522847, 
141644490, 3369120, 118310874, 35234761, 123944322, 
28899603, 25811985, 111690652, 124293408, 50477079, 
32661931, 7902000, 49695684, 83883210, 43579442, 
98269485, 137989471, 50071319, 52572304, 12365041, 
102014338, 72258259, 39996845, 134158431, 116906663, 
17760429, 61771031, 127999914, 25893673, 10532516, 
123869596, 146992989, 66741450, 59115952, 147228942, 
142258983, 76664631, 94031587, 96235965, 120544138, 
51435347, 64974372, 91857976, 3094866, 88066906, 
21831980, 130723528, 144169225, 118544206, 70687881, 
87739615, 42069744, 98344520, 126890158, 129675033, 
103557889, 50046272, 145766813, 3723513, 148675918, 
69793748, 21952533, 11938750, 18547576, 57521516, 
131755447, 11375648, 96473208, 70617867, 44178771, 
20163903, 58088772, 100096461, 117506519, 11745116, 
139814815, 50946990, 127084878, 44588429, 30211374, 
51370402, 32277313, 95081897, 136138155, 138705788, 
67756584, 121082740, 70381410, 140134449, 52079208, 
56423851, 96764093, 58681541, 72648205, 91699038, 
149602800, 91113158, 22944624, 138748541, 83878148, 
68146830, 95926504, 136214597, 53171555, 146506049, 
28239426, 118907699, 136348333, 112400620, 117404791, 
4691912, 13048609, 128195785, 45123637, 128814379, 
22458413, 33833681, 83798612, 32891483, 131864859, 
84625276, 85172717, 105051180, 108808035, 105929138, 
149952379, 28939853, 113720510, 127963393, 66763141, 
8281483, 72994938, 64182442, 90965241, 105723481, 
106784857, 89456288, 12551729, 82374692, 32819991, 
58983429, 73228198, 19274685, 36857815, 100937266, 
94904313, 8734712, 20154781, 43110820, 67534481, 
35672718, 146738875, 48415888, 16622733, 137196826, 
134214509, 6116447, 59895516, 82617620, 77393111, 
14982794, 99000651, 73351666, 34232738, 67863401, 
48765138, 54388368, 138146086, 7521269, 1545985, 
73854518, 133032628, 122774374, 78314965, 135357663, 
62632212, 2930494, 40766138, 135464701, 31035282, 
66340267, 119782885, 128173118, 113397533, 20087094, 
115682676, 85666579, 6246421, 105605415, 133934143, 
97556321, 82525696, 148639607, 89011953, 62437992, 
26600269, 13044529, 115578297, 69460059, 111758538, 
78566017, 36201773, 49394333, 34582644, 123197763, 
80828659, 16376561, 124357483, 54168733, 86860751, 
83002648, 140701442, 30441969, 82801579, 26428107, 
78522487, 98683488, 1865680, 21802731, 101693371, 
42281317, 49599880, 131512774, 96528592, 68056328, 
123477610, 90375826, 142655895, 148806614, 1594867, 
63734464, 93927421, 51299637, 137466202, 9505889, 
92573465, 105947357, 54511601, 36857736, 147634610, 
34325763, 113359993, 21267613, 21566047, 124335937, 
33207423, 114162521, 19540275, 17050247, 60722361, 
3841210, 128171351, 138875443, 68959396, 78304282, 
128870662, 136486623, 65672495, 26136274, 134662672, 
112326987, 113475274, 119354433, 149684721, 17314446, 
87032185, 86301719, 6760586, 65296859, 2262229, 
89369405, 51423141, 33617584, 137021493, 4183992, 
62038184, 93360671, 105764924, 130723748, 13924271, 
13930112, 4080157, 119871503, 20333009, 26600276, 
101049424, 96694911, 134520400, 138576426, 33701356, 
139727573, 29003453, 101392339, 78560939, 138084811, 
616122, 45656605, 4018427, 61100416, 32306716, 
48291746, 34513783, 41365527, 80797102, 6703977, 
19980305, 71862978, 107234146, 81965916, 56526095, 
99912345, 67792741, 1814692, 15188155, 236682, 
144387393, 5472067, 8527663, 146877047, 97766731, 
113872614, 133896416, 50114987, 52524584, 145837766, 
24441150, 7944193, 143691084, 14593225, 127140897, 
94714297, 70762930, 123071219, 97146855, 60516039, 
136061567, 145021651, 32133629, 6493312, 52555941, 
82438131, 124407913, 85001302, 27289921, 81692630, 
123479395, 35245444, 149138306, 110631462, 26809240, 
70041038, 93319481, 117123027, 40557957, 64052877, 
70930583, 99135262, 124303397, 134513804, 86663555, 
55135129, 18364449, 66585868, 9290719, 21936578, 
113787408, 124312407, 22390770, 63103232, 126690231, 
41655477, 75421898, 138699306, 50768599, 56019081, 
90942513, 66444071, 133545478, 142112015, 107636455, 
69940989, 142121088, 17138421, 149156022, 136206047, 
28330986, 89891308, 22820426, 27476399, 90849307, 
107631846, 100646770, 110748720, 123298489, 43987983, 
59226406, 142844708, 9965940, 81966352, 88366905, 
47330330, 99656208, 121256096, 98844687, 9395226, 
143882948, 66539517, 136534012, 25016534, 106925601, 
118788381, 137946521, 40912828, 15017003, 44816592, 
68536378, 38352451, 25816978, 72046003, 109723675, 
22681401, 90069813, 76160155, 46050193, 147641127, 
72345226, 119094020, 67342812, 56003099, 12531015, 
90962600, 69742574, 5557531, 107638896, 90195007, 
112652246, 10449541, 108721493, 148064235, 5296678, 
98772721, 34271363, 36067425, 11571564, 45564140, 
116509216, 65747872, 37660817, 60043121, 106182450, 
138548608, 75636337, 78025944, 48964076, 111008925, 
143041717, 24021304, 67960311, 121288079, 12058209, 
125203421, 126164284, 146335696, 49054481, 111187357, 
63691710, 111067896, 14393450, 89013149, 136818770, 
75825372, 72771885, 126783184, 35297964, 19579092, 
74521034, 93261344, 71319846, 73560172, 135253847, 
101553139, 25374096, 115260646, 74706745, 35780765, 
61094116, 82701216, 101953579, 61719233, 137888864, 
128440565, 40856968, 123275446, 65306825, 97941752, 
60116799, 92917399, 42098150, 132227348, 121333345, 
69674994, 103715162, 116232646, 137020088, 30317842, 
117717978, 102364057, 76688454, 34386540, 90575776, 
99222585, 365159, 93161546, 74503785, 122414746, 
109343021, 39127597, 43546149, 137662484, 43355276, 
54378386, 124252324, 142959587, 49239046, 22729400, 
19245959, 78872650, 59574904, 30653295, 96491432, 
48297997, 99851795, 27414039, 43606242, 87614084, 
3258985, 53152391, 31219996, 43007631, 19699597, 
75887300, 106429843, 72293946, 40570408, 127105243, 
88646259, 112632477, 146699183, 27612710, 145178971, 
76351011, 141471739, 52440633, 7377780, 141195610, 
110510673, 38274136, 44929345, 37307247, 20235328, 
1048024, 2250270, 28309600, 4281479, 6903728, 
106503273, 130581106, 80114392, 13327583, 96627188, 
141648080, 35216023, 72076327, 82616770, 23470285, 
35770634, 97222518, 57316638, 64968372, 118519118, 
91464029, 12732550, 15265833, 57937399, 25061998, 
61376319, 112506587, 99179779, 149543090, 130396793, 
115164198, 60423722, 89987667, 23994535, 92503432, 
118353582, 63966079, 51111607, 74895147, 79222379, 
75596053, 58090389, 30356406, 148139908, 15837904, 
12269272, 114314922, 33458800, 39535749, 20822698, 
4011448, 74850300, 129722314, 138429527, 67329726, 
119367695, 108689359, 135283407, 100260734, 59185375, 
13978609, 148874377, 125447671, 105216141, 28714613, 
73517999, 38341244, 100610051, 118326540, 125160712, 
147190848, 34114555, 111721232, 66067841, 11529391, 
144108690, 74124773, 86682499, 125762618, 146066861, 
91810178, 108820017, 52297296, 82613093, 56736508, 
88974244, 562426, 22789120, 56877274, 24729790, 
25209392, 62281844, 99652793, 47657043, 75985813, 
97950389, 89947185, 104217774, 97983718, 143419135, 
58285388, 124236967, 5126754, 49887844, 30525517, 
149352563, 104281299, 66485784, 23245182, 23534397, 
41258873, 127041596, 96738593, 27931531, 3443863, 
67902488, 31375436, 38137447, 3362856, 34841850, 
85547722, 34112634, 71862789, 56727236, 93906127, 
39439016, 26384744, 116390125, 76911094, 966716, 
105595866, 22163068, 124817120, 46911119, 89810981, 
116297800, 127348636, 56338899, 135365076, 22782837, 
1743010, 69978312, 91709919, 27373944, 54999827, 
148934722, 36297108, 61112087, 27682548, 11180026, 
70626815, 3938060, 89536529, 34804489, 148607058, 
127163158, 124825947, 96013244, 6702051, 13408567, 
84074854, 113156903, 27890651, 120310136, 112726434, 
33176854, 81893895, 28660612, 352719, 95065561, 
25251615, 13950453, 26527767, 19808273, 133755780, 
72830037, 50245672, 132788974, 115334406, 86035787, 
18112441, 20758784, 125369493, 19647245, 61014419, 
136023021, 15489987, 113005789, 46753700, 82653429, 
110953407, 70322612, 97510523, 142422895, 72392710, 
35702912, 143698557, 22575495, 92983359, 76875069, 
3817876, 81114233, 21742032, 15836660, 127219089, 
19146259, 80620428, 147649662, 5668247, 139928736, 
89603640, 143956326, 10320183, 113080998, 116140635, 
53969206, 8856487, 2531335, 109211102, 52917171, 
144810340, 148275099, 46411934, 132147875, 90691294, 
32020110, 26412167, 67487814, 63378921, 129280000, 
2093865, 4268318, 132750058, 100662259, 75983261, 
67649860, 96481346, 6564239, 133702324, 10284391, 
61179592, 7947333, 140818107, 22612835, 47887705, 
1201940, 1747561, 145960629, 106016958, 134378980, 
39820956, 35368016, 27233049, 87220551, 31862480, 
101680442, 135311787, 74333004, 131685004, 102788831, 
97569350, 34140770, 130644924, 123165469, 61435079, 
109252167, 103563125, 22967613, 72123733, 108147475, 
53607473, 103800542, 125702896, 27734759, 89595606, 
89602021, 140360231, 146126869, 126748689, 95631097, 
8132630, 4171616, 107061694, 5768525, 116179951, 
97593747, 3590998, 113545480, 2234519, 16401548, 
104041880, 15716750, 16761672, 142856159, 7287334, 
128660130, 93023844, 30239206, 6219577, 26781059, 
35717370, 65171160, 31316204, 141788502, 78401830, 
102022404, 116591030, 69682910, 53403518, 63485725, 
135810180, 66063605, 39471193, 56017477, 148089850, 
92419654, 31459154, 139383984, 115651294, 116023353, 
119478086, 38260110, 119478064, 129656055, 85571442, 
141274344, 101287906, 74469511, 4090647, 94053182, 
33760885, 102243451, 35252660, 92922970, 19318558, 
89251263, 125880342, 30917843, 97277037, 109139053, 
48353747, 124631579, 137240211, 4683826, 77481556, 
29407466, 70808171, 1978642, 860334, 108274902, 
7769446, 5403331, 79486570, 121715424, 103226885, 
103271091, 64450310, 50156410, 19746129, 66127191, 
34651381, 67832221, 63886994, 5575341, 107407693, 
31003345, 101602171, 104675944, 53845380, 56194948, 
4120828, 29638091, 47905551, 136572625, 133231612, 
105132423, 75717181, 83055028, 126379772, 130272061, 
58761959, 87056390, 74384512, 125269155, 148629744, 
93786809, 140919060, 687437, 136067162, 136987845, 
100539777, 141881345, 36583857, 112018268, 60856767, 
40535608, 64377745, 8459748, 96826037, 131306269, 
56757792, 127543711, 37006905, 16060169, 872657, 
89690746, 96881628, 86272488, 24159151, 146235116, 
7292921, 81951446, 95693587, 132800765, 139757361, 
92193624, 92515614, 2644439, 63279861, 71415699, 
114875910, 74403350, 10867374, 105596459, 36946791, 
94702294, 116302230, 120116223, 19806695, 111419998, 
77724536, 122627505, 130661164, 58257620, 9286639, 
84713586, 100294814, 76071408, 123409743, 135725987, 
144263270, 120296374, 45291382, 17947013, 26103306, 
23561052, 90856699, 21369806, 31122258, 88412069, 
59815132, 94422157, 20856507, 36087941, 75778278, 
134545495, 32340194, 34155494, 145497532, 102920445, 
72735650, 46549247, 17047082, 46968654, 50378888, 
66195920, 122323135, 65327781, 22897350, 15224110, 
32903039, 116042935, 49863628, 119271275, 57012093, 
72881780, 68064958, 58514596, 41937277, 55970865, 
23823840, 64443009, 3931623, 65189736, 115253593, 
104198740, 19009902, 66559883, 113790452, 110250325, 
48321541, 78689403, 116249163, 8376629, 34184512, 
56099930, 148804824, 99929547, 119462856, 57149785, 
37844089, 72327472, 31542383, 137587675, 57893278, 
146310498, 110738166, 105816671, 71607560, 23288150, 
129398590, 48900299, 57541209, 29635500, 134364679, 
31910151, 39774414, 113111177, 90754370, 93657029, 
106800408, 126922418, 103852616, 23301058, 36063506, 
4379701, 83000425, 75635276, 31562264, 20080066, 
145859797, 3989857, 137300434, 543503, 67727364, 
44850932, 82524433, 57317401, 44925470, 50171275, 
73199652, 70418111, 11309325, 111603385, 133054695, 
138876684, 42309827, 24192191, 147195046, 80353521, 
52551222, 145477205, 16787889, 42134383, 128171606, 
42961266, 16174376, 17360830, 35450163, 126205081, 
70889799, 4691749, 38007472, 20578083, 30139854, 
38748791, 48078746, 92445643, 122251222, 36584651, 
18943210, 133266762, 14285608, 66593410, 7728707, 
865197, 111105107, 82747734, 124135691, 107905, 
65084500, 146660876, 16251926, 97727887, 129949914, 
9165017, 109222801, 134657221, 23523992, 119403600, 
71138331, 1226571, 126059479, 42937433, 146698148, 
125266920, 143267467, 109914528, 80640250, 140668054, 
7029888, 138923300, 61008276, 83073913, 5660618, 
9120210, 138026452, 142355020, 66479697, 131760090, 
47384135, 119388396, 103593385, 27176266, 37152917, 
92019108, 63434944, 16530408, 44763917, 69575390, 
120042540, 65731726, 55768075, 140681843, 109442030, 
113352851, 4653173, 136346596, 54471930, 133542755, 
17224179, 85621761, 84191408, 81942648, 87232992, 
98359671, 58341411, 71414616, 132963810, 118178821, 
134531843, 38724558, 62911008, 67790312, 133486414, 
15893876, 134126230, 112301487, 6576115, 36008944, 
118741744, 103863948, 45519458, 141176536, 18186145, 
96410276, 9209875, 77611504, 53273984, 42258343, 
120937074, 125847221, 100476276, 6133316, 63487932, 
143123687, 117132987, 34102639, 116905996, 59930607, 
14085117, 47408674, 124997943, 109898571, 21066534, 
130305429, 111940874, 93693625, 775124, 120989308, 
31855063, 28602060, 35233392, 113142442, 118314818, 
87882531, 69905661, 42474902, 57060108, 101013791, 
145725154, 65743553, 142961327, 115163027, 145320882, 
100234743, 36396858, 140235293, 19860726, 114090239, 
39807796, 146061490, 27325925, 101237870, 35298535, 
66795772, 45765257, 37295044, 15127909, 66932967, 
51848119, 146939390, 120040010, 88700641, 81565054, 
133837155, 101884579, 132864752, 18650945, 25055435, 
5997869, 95241711, 100084808, 75317976, 16553493, 
58241180, 19500612, 91705462, 13212456, 28129889, 
8603460, 91585035, 42723644, 96139297, 79948141, 
92503815, 21984944, 122941132, 86669663, 26952427, 
7656961, 61726356, 124603344, 116613050, 108257, 
96016906, 4876044, 38125740, 126035463, 17242136, 
98115615, 85334183, 47884342, 77377418, 66727398, 
133442669, 12071241, 99013224, 24705850, 15119780, 
85311330, 106681661, 97040325, 147053097, 38401959, 
52454296, 44402899, 88655062, 74643687, 30341915, 
17258651, 6035742, 93462310, 109804356, 66028639, 
66027553, 146343675, 85400771, 53641072, 128944348, 
107868453, 147449850, 28011680, 62051903, 56117613, 
66689558, 66274324, 30454767, 69150952, 102715921, 
138497399, 92197442, 115391346, 38959898, 109657800, 
70465993, 66636651, 75711100, 96904042, 20746179, 
59661986, 16386274, 143249935, 16350677, 3525275, 
78324582, 70639544, 64625097, 79432030, 140093339, 
108611485, 119296156, 104719021, 78710559, 31335311, 
59004768, 57219274, 97761373, 44464673, 84177043, 
77976825, 65360673, 111351956, 147087698, 111478181, 
6176145, 110502143, 71789422, 135110299, 129390128, 
103092583, 3743669, 127119021, 55811912, 18509400, 
29745830, 87087039, 64939239, 80252809, 123578698, 
93444922, 23309742, 87014729, 74583985, 135483862, 
10832773, 123302067, 138067286, 141511384, 133470955, 
111972811, 92722559, 88320862, 133911743, 126553462, 
53336590, 61249880, 111705508, 26389859, 19132238, 
48516958, 63867776, 83740534, 24956488, 95126330, 
140423030, 62830799, 4336008, 138766478, 125491345, 
106369150, 31601408, 23866757, 35085771, 101898164, 
16571795, 99957641, 123837163, 46947975, 117652269, 
12814470, 55538057, 42477290, 19115133, 40671316, 
72115244, 140279556, 134619337, 24736270, 51700927, 
90003044, 26826704, 83777740, 24700725, 9860722, 
104166244, 130065469, 120084095, 34971822, 63396273, 
116194083, 36797475, 114397859, 116359048, 23784618, 
3197970, 20183449, 16276962, 91195905, 113704052, 
83375087, 69541949, 60263367, 145034145, 86189853, 
60225438, 134254094, 70877920, 56880872, 10998750, 
57893980, 38462736, 109880109, 145848548, 146276846, 
55769368, 109084289, 50115569, 41568609, 138591974, 
88363700, 61445328, 68141472, 149972843, 88519786, 
102645647, 86321528, 145318766, 55249400, 60828836, 
38292574, 118410260, 96753301, 107526103, 82490937, 
29499946, 149707621, 142554549, 32413563, 51629012, 
139692833, 80558746, 58813118, 20449261, 37518562, 
115719591, 12935104, 122777353, 107603847, 84351398, 
118363501, 99066709, 5273142, 23304407, 141017838, 
142575597, 118548442, 13001999, 108209592, 112112247, 
107629590, 138719035, 133167633, 92670115, 46645626, 
28047549, 64151482, 57108937, 119145929, 135957016, 
19320773, 98725974, 47985064, 11885005, 51373637, 
79961083, 62907736, 113614112, 72913593, 108409709, 
95214426, 2259884, 24429256, 132116039, 120533703, 
134203625, 28462805, 46351374, 43522085, 125056322, 
96020724, 61127202, 140802987, 55323096, 83634638, 
120808081, 57553009, 76481498, 77388304, 119370541, 
147100292, 29150765, 149119785, 63416719, 143439784, 
12483423, 114093317, 80651120, 58669501, 128962120, 
132443593, 78917022, 119868727, 123592020, 59258798, 
27232810, 24338356, 145727160, 140086972, 98020173, 
107691548, 15155111, 17547395, 144324765, 3090439, 
99396932, 122225025, 77322850, 17525418, 118872416, 
96230065, 139268976, 78845788, 95696270, 46622918, 
12453932, 51146796, 3506413, 51826405, 68508025, 
63609010, 95137708, 87159242, 122071834, 66461670, 
114166914, 26905275, 115229910, 83521934, 112490235, 
12715828, 89628913, 93569037, 21756900, 55459065, 
29247133, 36132579, 68332762, 80378521, 143873284, 
57524876, 67080968, 118490921, 89960230, 62595488, 
126146085, 32644281, 90987767, 51183474, 123873897, 
132652101, 75168067, 65905889, 36422574, 28861012, 
115611806, 82596015, 10492864, 128087593, 132064112, 
9516054, 5423438, 121486198, 85048706, 40875927, 
130010169, 35373882, 130941817, 37079016, 111657795, 
64308911, 40999715, 92631564, 62626135, 63956766, 
869347, 62733168, 89310163, 93572600, 146867561, 
34777995, 132685679, 71511618, 131629958, 17991171, 
132275743, 32049843, 133035395, 11819770, 106068223, 
102378846, 144851376, 97476419, 114755248, 77140564, 
69920664, 11389321, 52359379, 127577244, 43141345, 
80980165, 109354031, 107063540, 99550377, 100076553, 
87726779, 32706899, 40860134, 29857696, 143502189, 
37692334, 34287935, 78866864, 63466369, 107851057, 
99387354, 74554555, 63551406, 130168337, 56162116, 
90413327, 144321206, 98050609, 36872266, 89637840, 
92363001, 15274217, 98581108, 147443569, 114080633, 
58306638, 10196919, 94065774, 110493799, 120825460, 
44529389, 49160067, 66213375, 40098837, 63205621, 
115096313, 88287643, 111467702, 48389685, 45095012, 
75331174, 60809179, 122283549, 144460337, 148344400, 
82220307, 92821677, 94561172, 47546884, 96029610, 
43157566, 89972926, 147559737, 8151976, 137593663, 
139039024, 12918110, 27800369, 104478354, 1500842, 
77814595, 8488095, 34363648, 54561281, 134466981, 
4761161, 42926254, 24248906, 149865101, 113412862, 
128336556, 123906404, 1418001, 128195009, 10894027, 
123597586, 5041200, 7298934, 64782333, 127739580, 
68879015, 101314302, 113322801, 149289224, 53945783, 
110744875, 102807961, 77335753, 45722776, 143886666, 
133432231, 28489245, 130459388, 124534843, 73468073, 
114693793, 132060243, 130747643, 48111126, 134323105, 
26762393, 123318976, 116825024, 119405538, 94916265, 
86252399, 2961741, 130294065, 61031654, 105548356, 
27265088, 142512094, 49569932, 114738625, 115249185, 
83994056, 86472013, 92456324, 83858924, 146456497, 
122143776, 33400244, 149331284, 105665300, 4027817, 
78769452, 48830474, 88525540, 31656037, 7839178, 
122862327, 135287462, 75473371, 69624589, 21597228, 
16143202, 51488680, 108990383, 36498513, 86472913, 
61049167, 135179362, 63589262, 88298949, 21672928, 
73106319, 29913250, 31020742, 142184926, 169133, 
121408521, 12502686, 12146301, 71060342, 33609167, 
136003880, 132374919, 111598994, 73466399, 76885100, 
145106071, 125277762, 147235689, 126146861, 95803457, 
148139654, 23848725, 32801908, 108205404, 76221404, 
100504836, 10466104, 129426536, 25965307, 137841779, 
63668528, 54842186, 16288537, 84399696, 10531508, 
13026935, 110360990, 38792430, 74727878, 15943460, 
109704909, 21922441, 36763767, 91021063, 101965228, 
88885908, 134688943, 73453742, 79633319, 25055461, 
137234744, 94586051, 21042806, 67844134, 43159709, 
147022739, 139765951, 1742707, 135504721, 2393473, 
10630701, 127055251, 103737027, 134443410, 47932568, 
70094336, 128874944, 7779788, 33062709, 117707290, 
9604662, 33930681, 55973384, 82867053, 59310157, 
96966245, 44503010, 66447382, 22899851, 117886636, 
115244706, 15970261, 9423962, 74194766, 132558489, 
114612061, 124774022, 49924778, 96194877, 13598389, 
35853580, 47132809, 22684442, 114697838, 86007466, 
16980593, 4500189, 141124522, 48134232, 5078098, 
57788301, 103887191, 82268841, 28781123, 11544730, 
77650601, 88524834, 142961331, 74964406, 64662858, 
140780725, 92360134, 81855187, 63481208, 115710213, 
134538267, 84534889, 61249817, 112978809, 18131185, 
144004374, 131442073, 110193413, 33445049, 115083983, 
26628234, 6785781, 149517993, 66935671, 103213809, 
128487668, 97580417, 35632496, 145030264, 14575982, 
134468435, 116024741, 74697093, 118969615, 98526337, 
13120456, 112706409, 24719292, 76039105, 143105912, 
12694180, 120723974, 143256205, 3505100, 117027529, 
66860929, 602801, 2030316, 82642155, 115739715, 
31234169, 148179033, 85616333, 48670717, 124267348, 
89676048, 4620367, 79733007, 89336542, 12519672, 
20544264, 37305049, 21484366, 51086442, 53303184, 
113772134, 37083560, 136766326, 126040632, 92951427, 
72286341, 82833198, 123092474, 29712797, 40113431, 
92163, 73953827, 58002018, 98241638, 33155639, 
89646389, 84393485, 79872747, 74250939, 82311885, 
38052967, 149693669, 71967988, 19163521, 72572979, 
63610271, 126382684, 43972742, 54394244, 75083615, 
103570057, 19473240, 81323774, 8071505, 136546422, 
110902884, 25642720, 13342045, 31729081, 128779351, 
140956310, 45929061, 105961268, 56614891, 117774464, 
135046312, 33636926, 87088061, 127494952, 44929615, 
130639198, 7973401, 74276936, 116329607, 116561615, 
37492202, 48519780, 23013600, 8727794, 118195020, 
105839128, 105106767, 53567055, 146076322, 57773355, 
69601701, 72225708, 18258031, 18844840, 108632003, 
105513065, 64056695, 132225416, 66405682, 3603494, 
87223787, 121784506, 11750421, 44921841, 123202035, 
59829776, 149568744, 149854318, 89631585, 68050952, 
12829670, 118463649, 25215349, 69155188, 72567887, 
35696772, 57802509, 123079875, 90652663, 2472971, 
133759806, 88679319, 80422744, 94427969, 61624818, 
99648679, 69426671, 143628764, 62028638, 85139366, 
140854011, 95103599, 26515033, 113802769, 138985758, 
76432302, 80199290, 123579903, 49000900, 123561877, 
72662439, 18810683, 22079618, 141053269, 41442011, 
16037363, 69976336, 76813455, 71968529, 84902348, 
61546624, 147766682, 111701065, 138169694, 4026528, 
15489311, 146208590, 101961777, 128777298, 131759244, 
102716458, 89672830, 83901289, 101410816, 63814287, 
54122656, 34507922, 74760608, 44765577, 12456810, 
60621412, 115721067, 123683877, 57264814, 2584271, 
35242022, 6710916, 106083602, 36032536, 146928568, 
45835621, 26989463, 55685530, 119769522, 74485851, 
96778287, 34058358, 4819152, 109707489, 120554031, 
76584831, 3856503, 118047624, 49361312, 97123950, 
118843485, 139197330, 121794489, 118232128, 23528405, 
31897442, 93810866, 69816310, 17684366, 81977218, 
15889685, 101128213, 43811260, 125748845, 99794419, 
84868413, 61887258, 61599654, 72497092, 147581730, 
102494007, 11790641, 44874059, 121174143, 86365633, 
62253800, 51387880, 129606971, 98171378, 32532469, 
116489192, 105996335, 62314110, 148502481, 89926639, 
97017720, 140687763, 146827119, 20419017, 75479451, 
99215920, 45822973, 47961168, 20601722, 13507504, 
32865323, 133786738, 50070628, 100827775, 8160994, 
67266276, 102412754, 19509028, 131917106, 130532938, 
38983075, 146541463, 132628442, 110727908, 108870173, 
25244329, 132864424, 34815323, 28157959, 1747164, 
144356519, 124938422, 146875439, 42017515, 29349579, 
106567655, 117604742, 124839778, 146943688, 135350856, 
48305637, 126333223, 119867409, 133964317, 121825164, 
146228425, 127918394, 114432920, 146177481, 146604678, 
43488626, 10243281, 99717693, 45763463, 149240660, 
120445858, 119101110, 53850135, 37955779, 8101891, 
8078250, 23730878, 111854371, 85005808, 128701030, 
58404992, 31837931, 57877191, 22040980, 55285006, 
68388719, 49758343, 5943147, 37719534, 139523709, 
133039897, 60823645, 51693760, 115777587, 133172822, 
2107299, 146386026, 14345293, 85219522, 86742377, 
91815721, 120948043, 20673539, 124026997, 130335687, 
35547457, 8914863, 121738056, 116476631, 134854680, 
59220295, 109963227, 65653380, 121147057, 43955586, 
45128962, 143245782, 125682146, 44639605, 32712075, 
39490197, 52954442, 58165354, 142373138, 56295821, 
105373377, 51906838, 20592498, 64169893, 35227506, 
44415439, 47980028, 6343309, 102328532, 13618042, 
14129811, 118165808, 54377933, 32663326, 38214658, 
72721316, 41991196, 94772663, 107650098, 114212394, 
41793037, 58086051, 117314207, 91617856, 15345913, 
59482116, 53847534, 103791571, 106883972, 130957719, 
96212066, 124358419, 50796219, 81920259, 121733774, 
64897585, 76401291, 35290148, 117539426, 126987901, 
125592016, 104853921, 58485051, 87922443, 81081784, 
11489109, 11052232, 142092554, 12197282, 138570948, 
145962681, 58365990, 148100958, 46709576, 30476249, 
57481648, 2214905, 93341987, 44026750, 32946183, 
109696651, 107259233, 111268820, 149365913, 19894654, 
93150855, 115162035, 107147530, 12762944, 56939796, 
49542337, 28887789, 37332115, 143837913, 149380149, 
113119356, 148803984, 100963313, 39170492, 86471391, 
70761059, 12449098, 145991783, 94237951, 85862050, 
109108349, 136447412, 139882628, 8857984, 18658467, 
3200901, 32448539, 112759600, 115061989, 2398813, 
65479036, 15484679, 945500, 5179625, 119439117, 
94741309, 43532185, 132527180, 52874993, 64728987, 
25846733, 140603295, 4303153, 94027625, 140147203, 
145830246, 29528370, 1383482, 116324313, 46992957, 
17614541, 13026130, 40152739, 77965286, 109962841, 
107939572, 1296017, 131031215, 105942132, 143148062, 
40965118, 838506, 62149986, 47511745, 50988202, 
18930818, 36731771, 29161605, 140615663, 34559376, 
24915935, 111555125, 133167462, 146022382, 16386019, 
98436154, 123257634, 18024114, 77650101, 76697182, 
134490031, 79933729, 43600924, 136465213, 126832243, 
53954346, 81441417, 45163347, 109643387, 135822433, 
41408276, 20521610, 95717701, 31757941, 50465706, 
112858346, 56921157, 6494996, 24958679, 7184796, 
122069416, 109813136, 102906751, 46519094, 124057714, 
44339862, 41878656, 83840116, 147866175, 71566827, 
149905754, 148163623, 141758118, 21550557, 40748580, 
134360181, 12646064, 35468065, 142929341, 86019551, 
108017114, 41764224, 78150092, 53591800, 144483669, 
103551253, 79972725, 148811949, 86799787, 141602918, 
62079091, 112989342, 79031744, 83071146, 45295555, 
42671146, 84140967, 114223266, 95332098, 11674247, 
123629409, 116320514, 55400978, 36399522, 116114662, 
144406929, 94339138, 145579189, 120347117, 52885106, 
34612962, 60758047, 74391901, 111140298, 138469154, 
51263653, 6285499, 149107660, 102871141, 68015833, 
58572947, 13595404, 77847874, 1221547, 82504575, 
15370356, 116650183, 56981310, 77162847, 1526989, 
74553647, 12095808, 134796002, 137398460, 78081779, 
78405974, 9338704, 140130174, 39191252, 101882810, 
115724840, 142901214, 28887173, 47797119, 125928425, 
33235369, 133590662, 50597482, 115150445, 75964714, 
69335089, 58302235, 59909995, 86904590, 84573718, 
41186214, 129254427, 100298717, 30928113, 21610166, 
136884985, 43650778, 140497866, 78741686, 77822862, 
83451388, 87137033, 67147971, 121679459, 141493618, 
65178363, 30421694, 43175461, 7803699, 72061279, 
24244200, 66662142, 12247492, 33298953, 93484491, 
89902680, 126158372, 18038279, 55737946, 5263891, 
102878817, 113231623, 24276249, 32342152, 38122732, 
126511799, 138151190, 122614558, 124677349, 112643024, 
43469761, 63498879, 3953408, 63930461, 6539505, 
49071785, 129991555, 28040594, 97668481, 122131246, 
19726408, 69150878, 37167661, 64225685, 61185149, 
128188409, 26355081, 35315427, 114532184, 126778535, 
40734856, 33501299, 28527929, 141982185, 117771300, 
75450716, 95217271, 11287693, 74534379, 98509895, 
98079918, 20388014, 113557877, 114022735, 18404185, 
133353718, 68705928, 69554778, 6673217, 44758607, 
14997632, 11674221, 68568907, 102518102, 120915638, 
102226498, 31233312, 24405501, 121812720, 49057588, 
115907507, 22895230, 109198687, 21916859, 7499510, 
96112367, 144559144, 82672101, 45413933, 52772355, 
62330612, 72651752, 74425296, 106463402, 27975958, 
117781187, 97400251, 45954649, 52738474, 23183804, 
5857577, 67974664, 39928485, 87374413, 135920816, 
37019485, 52411855, 66989909, 72627956, 26807695, 
125085331, 79164065, 58579233, 120595026, 103380678, 
109932826, 145310533, 40547081, 109923834, 72234130, 
99249705, 85879318, 19970944, 38654934, 59551107, 
131826537, 10658462, 144008329, 87844726, 49273108, 
118424922, 145331335, 53330590, 78567079, 34322186, 
94036528, 111350571, 112242263, 31244801, 41069366, 
116292715, 742499, 48586987, 63204516, 108383797, 
8318669, 39922833, 120404768, 17419837, 101605060, 
87022043, 87036865, 102859724, 60300516, 102628420, 
68073500, 24930848, 42826102, 100284715, 103785586, 
132350973, 3375418, 98573250, 82273414, 64556712, 
90029910, 48159558, 71418650, 79498314, 115019537, 
47683343, 11858234, 116664948, 144861855, 38976574, 
120571356, 1361916, 38769941, 30983848, 130756265, 
17934564, 22836222, 102627508, 144165029, 41695161, 
45061643, 81286262, 124815472, 52254626, 84265695, 
106859716, 138201888, 96061720, 4452482, 94715916, 
10575450, 18073384, 138933776, 72334530, 78463858, 
36433009, 58939653, 11135617, 15224060, 108130126, 
63486995, 98911983, 129539632, 74023249, 38830131, 
73032255, 12998998, 61661556, 75634495, 33170205, 
136805332, 48624337, 64677829, 134767831, 49296225, 
98545777, 26965570, 67161089, 54551170, 105601890, 
92610587, 44841016, 135096415, 134838498, 80721204, 
43354934, 22834343, 121208752, 112565807, 97961734, 
77448614, 88020913, 26979744, 76175367, 112583611, 
19119050, 142276536, 104135001, 101745012, 57274678, 
32917014, 136912764, 126251379, 52561801, 36081151, 
73304347, 47423464, 135166429, 78107126, 68050178, 
21926995, 82900601, 118342140, 119700033, 55301444, 
42709568, 44140357, 84787706, 62175201, 88059480, 
88753611, 51550900, 7070025, 60385177, 133993548, 
2924746, 45894642, 1494941, 66112780, 89878311, 
106552255, 147698801, 26592967, 117964495, 130427740, 
149682363, 31229396, 1987955, 8159544, 125349587, 
99041900, 101304227, 109523251, 111980614, 42241208, 
48309191, 85909173, 812852, 66738829, 68327373, 
55048470, 142298422, 135114400, 86829490, 22519596, 
146057973, 71383402, 136523219, 128392688, 38698889, 
29622881, 71585437, 123274833, 39328413, 66623595, 
54842817, 137246738, 109801977, 68714379, 139294136, 
119578132, 53768414, 85481127, 85606903, 107712691, 
94312062, 99380429, 73404019, 52778759, 147036507, 
125903940, 51977968, 56870722, 61461462, 78763948, 
106076408, 76835405, 128119930, 54430877, 145582151, 
4066042, 84755142, 33155074, 81735024, 85427452, 
24498953, 2746485, 27795231, 132937682, 78951698, 
138404278, 31131850, 115014248, 142845400, 112158187};

void init_args(int argc, char ** av, FILE ** query, FILE ** database, FILE ** out_database, uint64_t * custom_kmer, uint64_t * dimension, uint64_t * max_differences);

int main(int argc, char ** av){
    

    //clock_t begin, end;

    uint64_t i, j;

    //query to read kmers from, database to find seeds
    FILE * query = NULL, * database = NULL, * out_database = NULL;
    uint64_t dimension = 1000; // Default 1000 * 1000
    uint64_t max_differences = 0; // Default max number of wrong hashes
    uint64_t n_hash_functions = NHASH/custom_kmer;
    
    
    init_args(argc, av, &query, &database, &out_database, &custom_kmer, &dimension, &max_differences);


    unsigned char char_converter[91];
    char_converter[(unsigned char)'A'] = 0;
    char_converter[(unsigned char)'C'] = 1;
    char_converter[(unsigned char)'G'] = 2;
    char_converter[(unsigned char)'T'] = 3;

    
    //Variables to account for positions
    //Print info
    fprintf(stdout, "[INFO] Loading database\n");
    //Variables to read kmers
    char c = 'N'; //Char to read character
    //Current length of array and variables for the buffer
    uint64_t idx = 0, r = 0;
    
    //Vector to read in batches
    char * temp_seq_buffer = NULL;
    if ((temp_seq_buffer = calloc(READBUF, sizeof(char))) == NULL) {
        terror("Could not allocate memory for read buffer");
    }

    //Dimensional matrix
    uint64_t ** representation = (uint64_t **) calloc(dimension+1, sizeof(uint64_t *));
    if(representation == NULL) terror("Could not allocate representation");
    for(i=0; i<dimension+1; i++){
        representation[i] = (uint64_t *) calloc(dimension+1, sizeof(uint64_t));
        if(representation[i] == NULL) terror("Could not allocate second loop representation");
    }

    unsigned char curr_kmer[custom_kmer], reverse_kmer[custom_kmer];
    curr_kmer[0] = reverse_kmer[0] = '\0';
    uint64_t word_size = 0, word_size_rev = 0;

    //To hold all information related to database
    uint64_t current_len = 0;
    
    //To force reading from the buffer
    idx = READBUF + 1;

    //Store positions of kmers
    uint64_t n_pools_used = 0;
    uint64_t n_pools_used_kmer = 0;


    //Mempool_l * mp = (Mempool_l *) malloc(MAX_MEM_POOLS*sizeof(Mempool_l));
    //if(mp == NULL) terror("Could not allocate vectors for memory pools");
    Mempool_l mp[MAX_MEM_POOLS];
    init_mem_pool_llpos(&mp[n_pools_used]);

    // mempool for first level
    Mempool_l_kmer mp_kmer[MAX_MEM_POOLS];
    init_mem_pool_llpos_kmer(&mp_kmer[n_pools_used_kmer]);

    llpos * aux, * pointer;
    llpos_kmer * aux_kmer;

    //unsigned char aux_kmer[custom_kmer+1];
    
    //Vector to store query seq
    unsigned char * seq_vector_query = (unsigned char *) malloc(READBUF*sizeof(unsigned char));
    if(seq_vector_query == NULL) terror("Could not allocate memory for query vector");

    /*
    Container * ct = (Container *) calloc(1, sizeof(Container));
    if(ct == NULL) terror("Could not allocate container");
    */
    /*
    typedef struct linked_list_kmer{
        unsigned char kmer[32];
        linked_list_kmer * next;
    } llpos_kmer;

    typedef struct static_table{
        llpos_kmer * table;
    } Static_table;
    */

    // Get file length to know aproximate kmer number
    fseek(database, 0, SEEK_END);
    uint64_t m_prime = (uint64_t) ftell(database);
    rewind(database);
    //remove this 
    //m_prime = 15000017; // CLosest prime to 15 M
    m_prime = 9999991; // Closest prime to 10 M
    //m_prime = 3999971; // Closest prime to 4,000,000
    //m_prime = 2000003; // CLosets prime to 2,000,000
    uint64_t used_entries = 0;

    // Create initial level hash table
    Static_table st;
    st.table = (llpos_kmer *) calloc(m_prime, sizeof(llpos_kmer));
    st.count = (uint64_t *) calloc(m_prime, sizeof(uint64_t));
    st.picked_hash = (uint64_t *) calloc(m_prime, sizeof(uint64_t));
    if(st.table == NULL || st.count == NULL || st.picked_hash == NULL) terror("Could not allocate first level table");

    

    //begin = clock();
    uint64_t c_hash;

    c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);
    while((!feof(database) || (feof(database) && idx < r))){

        if(c == '>'){
            // data_database.n_seqs++;
            // data_database.start_pos[data_database.n_seqs++] = pos_in_database;
            
            // if(pos_in_database == READBUF*n_realloc_database){ 
            //     n_realloc_database++; data_database.sequences = (unsigned char *) realloc(data_database.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
            //     if(data_database.sequences == NULL) terror("Could not reallocate temporary database");
            // }

            // if(data_database.n_seqs == INITSEQS*n_seqs_database_realloc){
            //     n_seqs_database_realloc++; data_database.start_pos =  (uint64_t *) realloc(data_database.start_pos, INITSEQS*n_seqs_database_realloc*sizeof(uint64_t));
            // }


            while(c != '\n') c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);  //Skip ID
                

            while(c != '>' && (!feof(database) || (feof(database) && idx < r))){ //Until next id
                c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);
                c = toupper(c);
                if(c == 'A' || c == 'C' || c == 'G' || c == 'T'){
                    curr_kmer[word_size] = (unsigned char) c;
                    if(word_size < custom_kmer) ++word_size;
                    ++current_len;
                    //data_database.sequencesterror("Fatal error");[pos_in_database++] = (unsigned char) c;
            
                    // if(pos_in_database == READBUF*n_realloc_database){ 
                    //     n_realloc_database++; data_database.sequences = (unsigned char *) realloc(data_database.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                    //     if(dacountta_database.sequences == NULL) terror("Could not reallocate temporary database");
                    // }


                }else{ //It can be anything (including N, Y, X ...)

                    if(c != '\n' && c != '>'){
                        word_size = 0;
                        // data_database.sequences[pos_in_database++] = (unsigned char) 'N'; //Convert to N
                        ++current_len;
                        // if(pos_in_database == READBUF*n_realloc_database){ 
                        //     n_realloc_database++; data_database.sequences = (unsigned char *) realloc(data_database.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                        // if(data_database.sequences == NULL) terror("Could not reallocate temporary database");
                        // }
                    } 
                }
                if(word_size == custom_kmer){
                    //write to hash table
                                       
		
                    c_hash = universal_hash_function(0, curr_kmer, char_converter, m_prime);
                    
                    

                    if(st.count[c_hash] == 0){
                        
                        memcpy(st.table[c_hash].kmer, curr_kmer, custom_kmer);
                        st.table[c_hash].hash = hashOfWord(curr_kmer, custom_kmer);
                        st.table[c_hash].pos = current_len;
                        st.table[c_hash].next = NULL;
                        ++used_entries;
                    }else{

                        aux_kmer = getNewLocationllpos_kmer(mp_kmer, &n_pools_used_kmer);    
                        memcpy(aux_kmer->kmer, curr_kmer, custom_kmer);
                        aux_kmer->next = st.table[c_hash].next;
                        aux_kmer->pos = current_len;
                        aux_kmer->hash = hashOfWord(curr_kmer, custom_kmer);
                        st.table[c_hash].next = aux_kmer;
                        
                    }
                    ++st.count[c_hash];
                    
                    
                    


		
		            // memcpy(aux_kmer, &curr_kmer[1], custom_kmer-1);
                    // memcpy(curr_kmer, aux_kmer, custom_kmer-1);

                    // Non overlapping
                    word_size = 0;

                    // Overlapping
                    //memmove(&curr_kmer[0], &curr_kmer[1], custom_kmer-1);
                    //--word_size;
                }
            }
            word_size = 0;
            
        }else{
            c = buffered_fgetc(temp_seq_buffer, &idx, &r, database);    
        }
        
    }

    //end = clock();

    fprintf(stdout, "[INFO] Used entries %"PRIu64" and a size of %"PRIu64", Load Factor = %"PRIu64"%%.\n", used_entries, m_prime, (100*used_entries) / m_prime);
    fprintf(stdout, "[INFO] Starting full rehash\n");

    st.second_level = (Def_pos **) calloc(m_prime, sizeof(Def_pos *));
    if(st.second_level == NULL) terror("Could not allocate second level table");
    for(i=0; i<m_prime; i++){
        st.second_level[i] = (Def_pos *) calloc(st.count[i]*st.count[i], sizeof(Def_pos));
        if(st.second_level[i] == NULL) terror("Could not allocate second level loop");
    }

    /*
typedef struct linked_list_pos{
    uint64_t pos;
    struct linked_list_pos * next;
} llpos;

typedef struct linked_list_kmer{
    unsigned char kmer[32];
    uint64_t hash;
    struct linked_list_kmer * next;
} llpos_kmer;

typedef struct def_pos{
    uint64_t full_hash;
    llpos * next;
} Def_pos;

typedef struct static_table{
    llpos_kmer * table;
    uint64_t * count;
    uint64_t * picked_hash;
    Def_pos ** second_level;

} Static_table;

    */
    
    uint64_t unsolved = 0;
    for(i=0; i<m_prime; i++){
        uint64_t current_picked_hash = 1; 
        uint64_t computed_for_reset = 0;
        unsigned char solved_collisions = FALSE;

        
        while(current_picked_hash <= n_hash_functions && solved_collisions == FALSE){

            solved_collisions = TRUE;
            computed_for_reset = 0;            
            st.picked_hash[i] = current_picked_hash;
            if(st.count[i] > 0){
                
                aux_kmer = &st.table[i];
                while(aux_kmer != NULL){
                    c_hash = universal_hash_function(current_picked_hash, aux_kmer->kmer, char_converter, st.count[i]*st.count[i]);
                    
                    
                    if(st.second_level[i][c_hash].next == NULL){
                        // This hash in second table did not exist yet
                        st.second_level[i][c_hash].full_hash = aux_kmer->hash;
                        aux = getNewLocationllpos(mp, &n_pools_used);
                        aux->pos = aux_kmer->pos;
                        aux->next = NULL;
                        st.second_level[i][c_hash].next = aux;
                        

                    }else{
                        // It existed, check that it is the same and hence no collision
                        // If it is the last hash function, then let it happen with errors
                        if(st.second_level[i][c_hash].full_hash != aux_kmer->hash){
                            solved_collisions = FALSE;
                        }
                        if(current_picked_hash < n_hash_functions && st.second_level[i][c_hash].full_hash != aux_kmer->hash){
                            // It already exists, try next hashing function
                            reset_llpos(mp, &n_pools_used, computed_for_reset);
                            solved_collisions = FALSE;
                            computed_for_reset = 0;
                            break;
                        }else{
                            // It is all good, add it!
                            aux = getNewLocationllpos(mp, &n_pools_used);
                            aux->pos = aux_kmer->pos;
                            aux->next = st.second_level[i][c_hash].next;
                            st.second_level[i][c_hash].next = aux;
                        }

                    }
                    
                    ++computed_for_reset;
                    aux_kmer = aux_kmer->next;
                }
                
            }
            if(solved_collisions == FALSE){ /*fprintf(stdout, "Trying %"PRIu64" with hash %"PRIu64"\n", i, current_picked_hash);*/ ++current_picked_hash; }
        }

        if(solved_collisions == FALSE){ /*fprintf(stdout, "[FATAL] Could not solve collisions at %"PRIu64"\n", i); exit(-1);*/ ++unsolved; }   
    }

    // Deallocate memory pool for aux kmers
    for(i=0;i<=n_pools_used_kmer;i++){
        free(mp_kmer[i].base);
    }    

    fprintf(stdout, "[INFO] Full rehash completed. Unsolved = %"PRIu64", %"PRIu64"%%.\n", unsolved, (100*unsolved)/used_entries);

    exit(-1);

    // data_database.total_len = pos_in_database;

    //fprintf(stdout, "[INFO] Database loaded and of length %"PRIu64". Hash table building took %e seconds\n", data_database.total_len, (double)(end-begin)/CLOCKS_PER_SEC);
    fprintf(stdout, "[INFO] Database loaded and of length %"PRIu64".\n", current_len);
    //close database
    fclose(database);

    
    
    //begin = clock();

    

    

    
    
    
    double pixel_size_db = (double) dimension / (double) current_len;
    double ratio_db = (double) current_len / dimension;


    // Get file length
    fseek(query, 0, SEEK_END);
    uint64_t aprox_len_query = ftell(query);
    rewind(query);

    uint64_t a_hundreth = (aprox_len_query/100);
    double pixel_size_query = (double) dimension / (double) aprox_len_query;
    double ratio_query = (double) aprox_len_query / dimension;
    

    double i_r_fix = MAX(1.0, custom_kmer * pixel_size_query);
    double j_r_fix = MAX(1.0, custom_kmer * pixel_size_db);

    
    
    fprintf(stdout, "[INFO] Ratios: Q [%e] D [%e]. Lenghts: Q [%"PRIu64"] D [%"PRIu64"]\n", ratio_query, ratio_db, aprox_len_query, current_len);
    fprintf(stdout, "[INFO] Pixel size: Q [%e] D [%e].\n", pixel_size_query, pixel_size_db);


    fprintf(stdout, "[INFO] Computing absolute hit numbers.\n");


    current_len = 0;

    llpos * the_original_hit;

    //To force reading from the buffer
    idx = READBUF + 1;
    c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
    
    while((!feof(query) || (feof(query) && idx < r))){

        if(c == '>'){
            word_size = 0;
            word_size_rev = custom_kmer-1;
            



            while(c != '\n'){ c = buffered_fgetc(temp_seq_buffer, &idx, &r, query); } //Skip ID
                

            while(c != '>' && (!feof(query) || (feof(query) && idx < r))){ //Until next id
                c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);
                c = toupper(c);
                if(c == 'A' || c == 'C' || c == 'G' || c == 'T'){
                    
                    ++current_len;
                    if(current_len % a_hundreth == 0){ 
                        fprintf(stdout, "%"PRIu64"%%..", 1+100*current_len/aprox_len_query); 
                        //printf("%"PRIu64"%%..wasted: (%e) (%e)", 1+100*pos_in_query/aprox_len_query, (double)(wasted_cycles_forward)/CLOCKS_PER_SEC, (double)(wasted_cycles_reverse)/CLOCKS_PER_SEC); 
                        fflush(stdout);
                    }
                    // if(pos_in_query % 500000 == 0){
                    //     fprintf(stdout, "[INFO] Query aprox length %"PRIu64". I have done: %"PRIu64" and time= %e seconds\n", aprox_len_query, pos_in_query, (double)(clock()-begin)/CLOCKS_PER_SEC);
                    //     begin = clock();
                    // } 
                    curr_kmer[word_size] = (unsigned char) c;
                    ++word_size;

                    switch(c){
                        case ('A'): reverse_kmer[word_size_rev] = (unsigned)'T';
                        break;
                        case ('C'): reverse_kmer[word_size_rev] = (unsigned)'G';
                        break;
                        case ('G'): reverse_kmer[word_size_rev] = (unsigned)'C';
                        break;
                        case ('T'): reverse_kmer[word_size_rev] = (unsigned)'A';
                        break;
                    }
                    if(word_size_rev != 0) --word_size_rev;



                    
                    if(word_size == custom_kmer){


                        /*
                        aux = ct->table[char_converter[curr_kmer[0]]][char_converter[curr_kmer[1]]][char_converter[curr_kmer[2]]]
                        [char_converter[curr_kmer[3]]][char_converter[curr_kmer[4]]][char_converter[curr_kmer[5]]]
                        [char_converter[curr_kmer[6]]][char_converter[curr_kmer[7]]][char_converter[curr_kmer[8]]]
                        [char_converter[curr_kmer[9]]][char_converter[curr_kmer[10]]][char_converter[curr_kmer[11]]];

                        the_original_hit = aux;
                        */


                        //uint64_t hash_forward, hash_reverse;
                        //hash_forward = hashOfWord(&curr_kmer[FIXED_K], custom_kmer - FIXED_K);
                        //hash_reverse = hashOfWord(&reverse_kmer[FIXED_K], custom_kmer - FIXED_K);
                        /*
                        unsigned char hash_forward[MAX_DECOMP_HASH], hash_reverse[MAX_DECOMP_HASH];
                        decomposed_hash_of_word(&curr_kmer[0], &hash_forward[0], custom_kmer);
                        decomposed_hash_of_word(&reverse_kmer[0], &hash_reverse[0], custom_kmer);
                        */
                        

                        /*
                        uint64_t w;
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) curr_kmer[w]);
                        }
                        printf("\n");
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) reverse_kmer[w]);
                        }
                        printf("---------------\n"); getchar();
                        */
                        /*

                        while(aux != NULL){

                            if(xor_decomposed_hash(aux->decomp_hash, hash_forward, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_forward){

                                the_original_hit->hits_count++;
                                
                            }
                            aux = aux->next;
                        }

                        

                        aux = ct->table[char_converter[reverse_kmer[0]]][char_converter[reverse_kmer[1]]][char_converter[reverse_kmer[2]]]
                        [char_converter[reverse_kmer[3]]][char_converter[reverse_kmer[4]]][char_converter[reverse_kmer[5]]]
                        [char_converter[reverse_kmer[6]]][char_converter[reverse_kmer[7]]][char_converter[reverse_kmer[8]]]
                        [char_converter[reverse_kmer[9]]][char_converter[reverse_kmer[10]]][char_converter[reverse_kmer[11]]];

                        the_original_hit = aux;

                        while(aux != NULL){                          
                            

                            if(xor_decomposed_hash(aux->decomp_hash, hash_reverse, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_reverse){

                                the_original_hit->hits_count++;                            
                                
                            }
                            
                            aux = aux->next;
                        }
                        */
                        // Overlapping
                        
                        // memmove(&curr_kmer[0], &curr_kmer[1], custom_kmer-1);
                        // memmove(&reverse_kmer[1], &reverse_kmer[0], custom_kmer-1);
                        // --word_size;

                        // Non overlapping
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                    }


            
                    // if(pos_in_query == READBUF*n_realloc_database){ 
                    //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                    //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                    // }
                }else{
                    if(c != '\n' && c != '>'){
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                        ++current_len;
                        // data_query.sequences[pos_in_query++] = (unsigned char) 'N'; //Convert to N
                        // if(pos_in_query == READBUF*n_realloc_database){ 
                        //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                        //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                        // }
                    }
                }
            }
        }else{
            c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
        }
        
    }

    

    /// Out

    fprintf(stdout, "Scanning hits table.\n");

    uint64_t total_hits = 0;
    uint64_t table_size = 0;

    

    
    double average_hit = (double) total_hits / (double) table_size;

    fprintf(stdout, "[INFO] Total hit count is %"PRIu64" on a size of %"PRIu64" Avg = %e.\n", total_hits, table_size, average_hit);

    fprintf(stdout, "[INFO] Generating hits.\n");



    current_len = 0;

    //To force reading from the buffer
    idx = READBUF + 1;
    c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
    fseek(query, 0, SEEK_SET);
    
    while((!feof(query) || (feof(query) && idx < r))){

        if(c == '>'){
            word_size = 0;
            word_size_rev = custom_kmer-1;
            



            while(c != '\n'){ c = buffered_fgetc(temp_seq_buffer, &idx, &r, query); } //Skip ID
                

            while(c != '>' && (!feof(query) || (feof(query) && idx < r))){ //Until next id
                c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);
                c = toupper(c);
                if(c == 'A' || c == 'C' || c == 'G' || c == 'T'){
                    
                    ++current_len;
                    if(current_len % a_hundreth == 0){ 
                        fprintf(stdout, "%"PRIu64"%%..", 1+100*current_len/aprox_len_query); 
                        //printf("%"PRIu64"%%..wasted: (%e) (%e)", 1+100*pos_in_query/aprox_len_query, (double)(wasted_cycles_forward)/CLOCKS_PER_SEC, (double)(wasted_cycles_reverse)/CLOCKS_PER_SEC); 
                        fflush(stdout);
                    }
                    // if(pos_in_query % 500000 == 0){
                    //     fprintf(stdout, "[INFO] Query aprox length %"PRIu64". I have done: %"PRIu64" and time= %e seconds\n", aprox_len_query, pos_in_query, (double)(clock()-begin)/CLOCKS_PER_SEC);
                    //     begin = clock();
                    // } 
                    curr_kmer[word_size] = (unsigned char) c;
                    ++word_size;

                    switch(c){
                        case ('A'): reverse_kmer[word_size_rev] = (unsigned)'T';
                        break;
                        case ('C'): reverse_kmer[word_size_rev] = (unsigned)'G';
                        break;
                        case ('G'): reverse_kmer[word_size_rev] = (unsigned)'C';
                        break;
                        case ('T'): reverse_kmer[word_size_rev] = (unsigned)'A';
                        break;
                    }
                    if(word_size_rev != 0) --word_size_rev;

                    
                    if(word_size == custom_kmer){


                        
                        /*
                        aux = ct->table[char_converter[curr_kmer[0]]][char_converter[curr_kmer[1]]][char_converter[curr_kmer[2]]]
                        [char_converter[curr_kmer[3]]][char_converter[curr_kmer[4]]][char_converter[curr_kmer[5]]]
                        [char_converter[curr_kmer[6]]][char_converter[curr_kmer[7]]][char_converter[curr_kmer[8]]]
                        [char_converter[curr_kmer[9]]][char_converter[curr_kmer[10]]][char_converter[curr_kmer[11]]];

                        the_original_hit = aux;



                        //uint64_t hash_forward, hash_reverse;
                        //hash_forward = hashOfWord(&curr_kmer[FIXED_K], custom_kmer - FIXED_K);
                        //hash_reverse = hashOfWord(&reverse_kmer[FIXED_K], custom_kmer - FIXED_K);
                        unsigned char hash_forward[MAX_DECOMP_HASH], hash_reverse[MAX_DECOMP_HASH];
                        decomposed_hash_of_word(&curr_kmer[0], &hash_forward[0], custom_kmer);
                        decomposed_hash_of_word(&reverse_kmer[0], &hash_reverse[0], custom_kmer);

                        */

                        /*
                        uint64_t w;
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) curr_kmer[w]);
                        }
                        printf("\n");
                        for(w=0;w<custom_kmer;w++){
                            printf("%c", (char) reverse_kmer[w]);
                        }
                        printf("---------------\n"); getchar();
                        */
                        
                        /*
                        while(aux != NULL && the_original_hit->hits_count < (uint64_t)average_hit){


                            if(xor_decomposed_hash(aux->decomp_hash, hash_forward, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_forward){


                                // begin = clock();

                                // Convert scale to representation
                                uint64_t redir_db = (uint64_t) (aux->pos / (ratio_db));
                                uint64_t redir_query = (uint64_t) (current_len / (ratio_query));

                                //representation[redir_query][redir_db] = 1;

                                // long double i_r = MAX(1.0, custom_kmer * pixel_size_query);
                                // long double j_r = MAX(1.0, custom_kmer * pixel_size_db);

                                // Simple pixel paint
                                //representation[redir_query][redir_db] = 1;

                                double i_r = i_r_fix; double j_r = j_r_fix;

                                // printf("Hit is at %"PRIu64", %"PRIu64"\n", current_len, aux->pos);
                                // printf("redir : %"PRIu64" %"PRIu64"\n", redir_query, redir_db);
                                // printf("drwaing: %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db - (int64_t) j_r);
                                // getchar();

                                while((uint64_t) i_r >= 1 && (uint64_t) j_r >= 1){
                                    
                                    
                                     if((int64_t) redir_query - (int64_t) i_r > 0 && (int64_t) redir_db - (int64_t) j_r > 0){
                                         representation[(int64_t) redir_query - (int64_t) i_r][(int64_t) redir_db - (int64_t) j_r]++;
                                         //printf("\tplus at %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db - (int64_t) j_r);
                                    }else{
                                        representation[redir_query][redir_db]++;
                                        break;
                                    }
                                    
                                    i_r -= MIN(1.0, pixel_size_query);
                                    j_r -= MIN(1.0, pixel_size_db);

                                }
                                
                            }
                            aux = aux->next;
                        }




                        aux = ct->table[char_converter[reverse_kmer[0]]][char_converter[reverse_kmer[1]]][char_converter[reverse_kmer[2]]]
                        [char_converter[reverse_kmer[3]]][char_converter[reverse_kmer[4]]][char_converter[reverse_kmer[5]]]
                        [char_converter[reverse_kmer[6]]][char_converter[reverse_kmer[7]]][char_converter[reverse_kmer[8]]]
                        [char_converter[reverse_kmer[9]]][char_converter[reverse_kmer[10]]][char_converter[reverse_kmer[11]]];


                        the_original_hit = aux;

                        while(aux != NULL && the_original_hit->hits_count < (uint64_t)average_hit){                          
                            

                            if(xor_decomposed_hash(aux->decomp_hash, hash_reverse, custom_kmer) <= max_differences){
                            //if(aux->extended_hash == hash_reverse){
                                // printf("enter\n");
                                // // begin = clock();
                                
                                // uint64_t w;
                                // for(w=0;w<custom_kmer;w++){
                                //     printf("%c", (char) curr_kmer[w]);
                                // }
                                // printf("\n");
                                // for(w=0;w<custom_kmer;w++){
                                //     printf("%c", (char) reverse_kmer[w]);
                                // }
                                // printf("\n---------------\n"); getchar();
				//
                                

                                // Convert scale to representation
                                uint64_t redir_db = (uint64_t) ( (aux->pos) / (ratio_db));
                                uint64_t redir_query = (uint64_t) ((current_len ) / (ratio_query));
                                
                                
                                // printf("found at %"PRIu64", %"PRIu64"\n", current_len, aux->pos);
                                // printf("original paint is %"PRIu64", %"PRIu64"\n", redir_query, (uint64_t)(aux->pos / ratio_db));
                                // printf("therefore i paint at %"PRIu64", %"PRIu64"\n", redir_query, redir_db);
                                // getchar();
                                

                                //representation[redir_query][redir_db] = 1;

                                // long double i_r = MAX(1.0, custom_kmer * pixel_size_query);
                                // long double j_r = MAX(1.0, custom_kmer * pixel_size_db);
                                

                                // Simple pixel paint
                                //representation[redir_query][redir_db] = 1;

                                double i_r = i_r_fix; double j_r = j_r_fix;

                                while((uint64_t) i_r >= 1 && (uint64_t) j_r >= 1){
                                    // printf("I have %Le %Le which is %"PRIu64" %"PRIu64"\n", i_r, j_r, (uint64_t) i_r, (uint64_t) j_r);
                                    // printf("Hit is at %"PRIu64", %"PRIu64"\n", pos_in_query, aux->pos);
                                    // printf("redir : %"PRIu64" %"PRIu64"\n", redir_query, redir_db);
                                    // printf("drwaing: %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db - (int64_t) j_r);
                                    // getchar();
                                    if((int64_t) redir_query - (int64_t) i_r > 0 && (int64_t) redir_db + (int64_t) j_r < dimension){
                                         representation[(int64_t) redir_query - (int64_t) i_r][(int64_t) redir_db + (int64_t) j_r]++;
                                         //printf("\tplus at %"PRId64", %"PRId64"\n", (int64_t) redir_query - (int64_t) i_r, (int64_t) redir_db + (int64_t) j_r);
                                    }else{
                                        //printf("%"PRIu64",%"PRIu64"\n", redir_query, redir_db);
                                        representation[redir_query][redir_db]++;
                                        break;
                                    }
                                    i_r -= MIN(1.0, pixel_size_query);
                                    j_r -= MIN(1.0, pixel_size_db);

                                }
                                
                                
                            }
                            
                            aux = aux->next;
                        }
                        */
                        // Overlapping
                        
                        // memmove(&curr_kmer[0], &curr_kmer[1], custom_kmer-1);
                        // memmove(&reverse_kmer[1], &reverse_kmer[0], custom_kmer-1);
                        // --word_size;

                        // Non overlapping
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                    }


            
                    // if(pos_in_query == READBUF*n_realloc_database){ 
                    //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                    //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                    // }
                }else{
                    if(c != '\n' && c != '>'){
                        word_size = 0;
                        word_size_rev = custom_kmer-1;
                        ++current_len;
                        // data_query.sequences[pos_in_query++] = (unsigned char) 'N'; //Convert to N
                        // if(pos_in_query == READBUF*n_realloc_database){ 
                        //     n_realloc_database++; data_query.sequences = (unsigned char *) realloc(data_query.sequences, READBUF*n_realloc_database*sizeof(unsigned char));
                        //     if(data_query.sequences == NULL) terror("Could not reallocate temporary query");
                        // }
                    }
                }
            }
        }else{
            c = buffered_fgetc(temp_seq_buffer, &idx, &r, query);    
        }
        
    }

    //end = clock();

    
    

    //fprintf(stdout, "\n[INFO] Query length %"PRIu64". Hits completed. Took %e seconds\n", data_query.total_len, (double)(end-begin)/CLOCKS_PER_SEC);
    fprintf(stdout, "\n[INFO] Query length %"PRIu64".\n", current_len);

    //begin = clock();


    /*
    Queue * traverse = queue_head.head;
    while(traverse != NULL){
        printf("current_piece: %"PRIu64"-%"PRIu64"\n", traverse->r1, traverse->r2);
        traverse = traverse->next;
    }
    */


    //reads_per_thread = (uint64_t) (floorl((long double) data_query.n_seqs / (long double) n_threads));
    
    fprintf(stdout, "[INFO] Writing matrix\n");

    // representation[0][0] = 1;
    // representation[1][0] = 1;
    // representation[2][0] = 1;
    // representation[3][0] = 1;
    // representation[4][0] = 1;
    // representation[5][0] = 1;


    // for(i=0; i<dimension+1; i++){
    //     for(j=0; j<dimension+1; j++){
    //         fprintf(out_database, "%d ", (int) representation[i][j]);
    //     }
    //     fprintf(out_database, "\n");
    // }

    // Simple filtering
    // Print score

    // And replace 2's with 1's 
    for(i=0; i<dimension+1; i++){
        for(j=0; j<dimension; j++){
            fprintf(out_database, "%"PRIu64" ", representation[i][j]);
        }
        fprintf(out_database, "%"PRIu64"\n",  representation[i][dimension]);
    }

    

    /*
    uint64_t z;
    for(z=0; z<POOL_SIZE; z++){
        aux = mp[0].base + z;
        fprintf(stdout, "%p\n", aux);
        fflush(stdout);
    }
    */
    

    //free(ct->table);

    for(i=0;i<dimension;i++){
        free(representation[i]);
    }
    free(representation);
    if(out_database != NULL) fclose(out_database);
    
    return 0;
}

void init_args(int argc, char ** av, FILE ** query, FILE ** database, FILE ** out_database, uint64_t * custom_kmer, uint64_t * dimension, uint64_t * max_differences){

    int pNum = 0;
    while(pNum < argc){
        if(strcmp(av[pNum], "--help") == 0){
            fprintf(stdout, "USAGE:\n");
            fprintf(stdout, "           CHROMEISTER -query [query] -db [database] -out [outfile]\n");
            fprintf(stdout, "OPTIONAL:\n");
            fprintf(stdout, "           -kmer       [Integer:   k>1 (default 12)]\n");
            fprintf(stdout, "           -dimension  Size of the output [Integer:   d>0 (default 1000)]\n");
            fprintf(stdout, "           -diffs      Maximum number of different 4-mers in a hit (default 0)\n");
            fprintf(stdout, "           -out        [File path]\n");
            fprintf(stdout, "           --help      Shows help for program usage\n");
            fprintf(stdout, "\n");
            fprintf(stdout, "PLEASE NOTICE: The reverse complementary is calculated for the QUERY.\n");
            exit(1);
        }
        if(strcmp(av[pNum], "-query") == 0){
            *query = fopen64(av[pNum+1], "rt");
            if(query==NULL) terror("Could not open query file");
        }
        if(strcmp(av[pNum], "-db") == 0){
            *database = fopen64(av[pNum+1], "rt");
            if(database==NULL) terror("Could not open database file");
        }
        if(strcmp(av[pNum], "-out") == 0){
            *out_database = fopen(av[pNum+1], "wt");
            if(out_database==NULL) terror("Could not open output database file");
        }
        if(strcmp(av[pNum], "-kmer") == 0){
            *custom_kmer = (uint64_t) atoi(av[pNum+1]);
            if(*custom_kmer < BYTES_IN_MER) terror("K-mer size must be larger than 4");
            if(*custom_kmer % BYTES_IN_MER != 0) terror("K-mer size must be a multiple of 4");

        }
        if(strcmp(av[pNum], "-dimension") == 0){
            *dimension = (uint64_t) atoi(av[pNum+1]);
            if(*dimension < 1) terror("Dimension must be a positive integer");
        }
        if(strcmp(av[pNum], "-diffs") == 0){
            *max_differences = (uint64_t) atoi(av[pNum+1]);
        }
        pNum++;
    }
    
    if(*query==NULL || *database==NULL || *out_database==NULL) terror("A query, database and output file is required");
}

